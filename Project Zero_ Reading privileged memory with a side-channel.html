<!DOCTYPE html>
<!-- saved from url=(0086)https://googleprojectzero.blogspot.ca/2018/01/reading-privileged-memory-with-side.html -->
<html class="v2" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link href="./Project Zero_ Reading privileged memory with a side-channel_files/2437439463-css_bundle_v2.css" rel="stylesheet" type="text/css">
<meta content="width=1100" name="viewport">

<meta content="blogger" name="generator">
<link href="https://googleprojectzero.blogspot.ca/favicon.ico" rel="icon" type="image/x-icon">
<link href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html" rel="canonical">
<link rel="alternate" type="application/atom+xml" title="Project Zero - Atom" href="https://googleprojectzero.blogspot.com/feeds/posts/default">
<link rel="alternate" type="application/rss+xml" title="Project Zero - RSS" href="https://googleprojectzero.blogspot.com/feeds/posts/default?alt=rss">
<link rel="service.post" type="application/atom+xml" title="Project Zero - Atom" href="https://www.blogger.com/feeds/4838136820032157985/posts/default">

<link rel="alternate" type="application/atom+xml" title="Project Zero - Atom" href="https://googleprojectzero.blogspot.com/feeds/6227737444967092885/comments/default">
<!--[if IE]><script type="text/javascript" src="https://www.blogger.com/static/v1/jsbin/3061962209-ieretrofit.js"></script>
<![endif]-->
<link href="./Project Zero_ Reading privileged memory with a side-channel_files/image3.png" rel="image_src">
<meta content="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html" property="og:url">
<meta content="Reading privileged memory with a side-channel" property="og:title">
<meta content=" Posted by Jann Horn, Project Zero     We have discovered that CPU data cache timing can be abused to efficiently leak information out of mi..." property="og:description">
<meta content="https://3.bp.blogspot.com/-64YRnkgMujY/Wk064WtrSRI/AAAAAAAACPg/O4ZxlUiWerACL61P490xrVMWSmHTwQflQCEwYBhgL/w1200-h630-p-k-no-nu/image3.png" property="og:image">
<!--[if IE]> <script> (function() { var html5 = ("abbr,article,aside,audio,canvas,datalist,details," + "figure,footer,header,hgroup,mark,menu,meter,nav,output," + "progress,section,time,video").split(','); for (var i = 0; i < html5.length; i++) { document.createElement(html5[i]); } try { document.execCommand('BackgroundImageCache', false, true); } catch(e) {} })(); </script> <![endif]-->
<title>Project Zero: Reading privileged memory with a side-channel</title>
<style type="text/css">@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;src:local('Open Sans Regular'),local('OpenSans-Regular'),url(//fonts.gstatic.com/s/opensans/v15/cJZKeOuBrn4kERxqtaUH3aCWcynf_cDxXwCLxiixG1c.ttf)format('truetype');}</style>
<style id="page-skin-1" type="text/css"><!--
/*
-----------------------------------------------
Blogger Template Style
Name:     Simple
Designer: Blogger
URL:      www.blogger.com
----------------------------------------------- */

/* Content
----------------------------------------------- */
body {
font: normal normal 12px Open Sans;
color: #666666;
background: #eeeeee none repeat scroll top left;
padding: 0 0 0 0;
}
html body .region-inner {
min-width: 0;
max-width: 100%;
width: auto;
}
h2 {
font-size: 22px;
}
a:link {
text-decoration:none;
color: #2288bb;
}
a:visited {
text-decoration:none;
color: #888888;
}
a:hover {
text-decoration:underline;
color: #33aaff;
}
.body-fauxcolumn-outer .fauxcolumn-inner {
background: transparent none repeat scroll top left;
_background-image: none;
}
.body-fauxcolumn-outer .cap-top {
position: absolute;
z-index: 1;
height: 400px;
width: 100%;
}
.body-fauxcolumn-outer .cap-top .cap-left {
width: 100%;
background: transparent none repeat-x scroll top left;
_background-image: none;
}
.content-outer {
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .15);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .15);
-goog-ms-box-shadow: 0 0 0 #333333;
box-shadow: 0 0 0 rgba(0, 0, 0, .15);
margin-bottom: 1px;
}
.content-inner {
padding: 10px 40px;
}
.content-inner {
background-color: #ffffff;
}
/* Header
----------------------------------------------- */
.header-outer {
background: transparent none repeat-x scroll 0 -400px;
_background-image: none;
}
.Header h1 {
font: normal normal 40px Open Sans;
color: #000000;
text-shadow: 0 0 0 rgba(0, 0, 0, .2);
}
.Header h1 a {
color: #000000;
}
.Header .description {
font-size: 18px;
color: #000000;
}
.header-inner .Header .titlewrapper {
padding: 22px 0;
}
.header-inner .Header .descriptionwrapper {
padding: 0 0;
}
/* Tabs
----------------------------------------------- */
.tabs-inner .section:first-child {
border-top: 0 solid #dddddd;
}
.tabs-inner .section:first-child ul {
margin-top: -1px;
border-top: 1px solid #dddddd;
border-left: 1px solid #dddddd;
border-right: 1px solid #dddddd;
}
.tabs-inner .widget ul {
background: transparent none repeat-x scroll 0 -800px;
_background-image: none;
border-bottom: 1px solid #dddddd;
margin-top: 0;
margin-left: -30px;
margin-right: -30px;
}
.tabs-inner .widget li a {
display: inline-block;
padding: .6em 1em;
font: normal normal 12px Open Sans;
color: #000000;
border-left: 1px solid #ffffff;
border-right: 1px solid #dddddd;
}
.tabs-inner .widget li:first-child a {
border-left: none;
}
.tabs-inner .widget li.selected a, .tabs-inner .widget li a:hover {
color: #000000;
background-color: #eeeeee;
text-decoration: none;
}
/* Columns
----------------------------------------------- */
.main-outer {
border-top: 0 solid transparent;
}
.fauxcolumn-left-outer .fauxcolumn-inner {
border-right: 1px solid transparent;
}
.fauxcolumn-right-outer .fauxcolumn-inner {
border-left: 1px solid transparent;
}
/* Headings
----------------------------------------------- */
div.widget > h2,
div.widget h2.title {
margin: 0 0 1em 0;
font: normal bold 11px 'Trebuchet MS',Trebuchet,Verdana,sans-serif;
color: #000000;
}
/* Widgets
----------------------------------------------- */
.widget .zippy {
color: #999999;
text-shadow: 2px 2px 1px rgba(0, 0, 0, .1);
}
.widget .popular-posts ul {
list-style: none;
}
/* Posts
----------------------------------------------- */
h2.date-header {
font: normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
}
.date-header span {
background-color: #bbbbbb;
color: #ffffff;
padding: 0.4em;
letter-spacing: 3px;
margin: inherit;
}
.main-inner {
padding-top: 35px;
padding-bottom: 65px;
}
.main-inner .column-center-inner {
padding: 0 0;
}
.main-inner .column-center-inner .section {
margin: 0 1em;
}
.post {
margin: 0 0 45px 0;
}
h3.post-title, .comments h4 {
font: normal normal 22px Open Sans;
margin: .75em 0 0;
}
.post-body {
font-size: 110%;
line-height: 1.4;
position: relative;
}
.post-body img, .post-body .tr-caption-container, .Profile img, .Image img,
.BlogList .item-thumbnail img {
padding: 2px;
background: #ffffff;
border: 1px solid #eeeeee;
-moz-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
-webkit-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
}
.post-body img, .post-body .tr-caption-container {
padding: 5px;
}
.post-body .tr-caption-container {
color: #666666;
}
.post-body .tr-caption-container img {
padding: 0;
background: transparent;
border: none;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
box-shadow: 0 0 0 rgba(0, 0, 0, .1);
}
.post-header {
margin: 0 0 1.5em;
line-height: 1.6;
font-size: 90%;
}
.post-footer {
margin: 20px -2px 0;
padding: 5px 10px;
color: #666666;
background-color: #eeeeee;
border-bottom: 1px solid #eeeeee;
line-height: 1.6;
font-size: 90%;
}
#comments .comment-author {
padding-top: 1.5em;
border-top: 1px solid transparent;
background-position: 0 1.5em;
}
#comments .comment-author:first-child {
padding-top: 0;
border-top: none;
}
.avatar-image-container {
margin: .2em 0 0;
}
#comments .avatar-image-container img {
border: 1px solid #eeeeee;
}
/* Comments
----------------------------------------------- */
.comments .comments-content .icon.blog-author {
background-repeat: no-repeat;
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEgAACxIB0t1+/AAAAAd0SU1FB9sLFwMeCjjhcOMAAAD+SURBVDjLtZSvTgNBEIe/WRRnm3U8RC1neQdsm1zSBIU9VVF1FkUguQQsD9ITmD7ECZIJSE4OZo9stoVjC/zc7ky+zH9hXwVwDpTAWWLrgS3QAe8AZgaAJI5zYAmc8r0G4AHYHQKVwII8PZrZFsBFkeRCABYiMh9BRUhnSkPTNCtVXYXURi1FpBDgArj8QU1eVXUzfnjv7yP7kwu1mYrkWlU33vs1QNu2qU8pwN0UpKoqokjWwCztrMuBhEhmh8bD5UDqur75asbcX0BGUB9/HAMB+r32hznJgXy2v0sGLBcyAJ1EK3LFcbo1s91JeLwAbwGYu7TP/3ZGfnXYPgAVNngtqatUNgAAAABJRU5ErkJggg==);
}
.comments .comments-content .loadmore a {
border-top: 1px solid #999999;
border-bottom: 1px solid #999999;
}
.comments .comment-thread.inline-thread {
background-color: #eeeeee;
}
.comments .continue {
border-top: 2px solid #999999;
}
/* Accents
---------------------------------------------- */
.section-columns td.columns-cell {
border-left: 1px solid transparent;
}
.blog-pager {
background: transparent url(//www.blogblog.com/1kt/simple/paging_dot.png) repeat-x scroll top center;
}
.blog-pager-older-link, .home-link,
.blog-pager-newer-link {
background-color: #ffffff;
padding: 5px;
}
.footer-outer {
border-top: 1px dashed #bbbbbb;
}
/* Mobile
----------------------------------------------- */
body.mobile  {
background-size: auto;
}
.mobile .body-fauxcolumn-outer {
background: transparent none repeat scroll top left;
}
.mobile .body-fauxcolumn-outer .cap-top {
background-size: 100% auto;
}
.mobile .content-outer {
-webkit-box-shadow: 0 0 3px rgba(0, 0, 0, .15);
box-shadow: 0 0 3px rgba(0, 0, 0, .15);
}
.mobile .tabs-inner .widget ul {
margin-left: 0;
margin-right: 0;
}
.mobile .post {
margin: 0;
}
.mobile .main-inner .column-center-inner .section {
margin: 0;
}
.mobile .date-header span {
padding: 0.1em 10px;
margin: 0 -10px;
}
.mobile h3.post-title {
margin: 0;
}
.mobile .blog-pager {
background: transparent none no-repeat scroll top center;
}
.mobile .footer-outer {
border-top: none;
}
.mobile .main-inner, .mobile .footer-inner {
background-color: #ffffff;
}
.mobile-index-contents {
color: #666666;
}
.mobile-link-button {
background-color: #2288bb;
}
.mobile-link-button a:link, .mobile-link-button a:visited {
color: #ffffff;
}
.mobile .tabs-inner .section:first-child {
border-top: none;
}
.mobile .tabs-inner .PageList .widget-content {
background-color: #eeeeee;
color: #000000;
border-top: 1px solid #dddddd;
border-bottom: 1px solid #dddddd;
}
.mobile .tabs-inner .PageList .widget-content .pagelist-arrow {
border-left: 1px solid #dddddd;
}

--></style>
<style id="template-skin-1" type="text/css"><!--
body {
min-width: 1120px;
}
.content-outer, .content-fauxcolumn-outer, .region-inner {
min-width: 1120px;
max-width: 1120px;
_width: 1120px;
}
.main-inner .columns {
padding-left: 0;
padding-right: 310px;
}
.main-inner .fauxcolumn-center-outer {
left: 0;
right: 310px;
/* IE6 does not respect left and right together */
_width: expression(this.parentNode.offsetWidth -
parseInt("0") -
parseInt("310px") + 'px');
}
.main-inner .fauxcolumn-left-outer {
width: 0;
}
.main-inner .fauxcolumn-right-outer {
width: 310px;
}
.main-inner .column-left-outer {
width: 0;
right: 100%;
margin-left: -0;
}
.main-inner .column-right-outer {
width: 310px;
margin-right: -310px;
}
#layout {
min-width: 0;
}
#layout .content-outer {
min-width: 0;
width: 800px;
}
#layout .region-inner {
min-width: 0;
width: auto;
}
body#layout div.add_widget {
padding: 8px;
}
body#layout div.add_widget a {
margin-left: 32px;
}
--></style>
<link href="./Project Zero_ Reading privileged memory with a side-channel_files/authorization.css" media="all" onload="if(media!=&#39;all&#39;)media=&#39;all&#39;" rel="stylesheet"><noscript>&lt;link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=4838136820032157985&amp;amp;zx=253ba9da-9da4-4788-be8e-07bc312af673' rel='stylesheet'/&gt;</noscript>
<script src="./Project Zero_ Reading privileged memory with a side-channel_files/cb=gapi.loaded_4" async=""></script><script src="./Project Zero_ Reading privileged memory with a side-channel_files/cb=gapi.loaded_3" async=""></script><script src="./Project Zero_ Reading privileged memory with a side-channel_files/cb=gapi.loaded_2" async=""></script><script type="text/javascript" src="./Project Zero_ Reading privileged memory with a side-channel_files/google_top_exp.js"></script><style>.gc-bubbleDefault{background-color:transparent !important;text-align:left;padding:0 !important;margin:0 !important;border:0 !important;table-layout:auto !important}.gc-reset{background-color:transparent !important;border:0 !important;padding:0 !important;margin:0 !important;text-align:left}.pls-bubbleTop{border-bottom:1px solid #ccc !important}.pls-topTail,.pls-vertShimLeft,.pls-contentLeft{background-image:url(//ssl.gstatic.com/s2/oz/images/stars/po/bubblev1/border_3.gif) !important}.pls-topTail{background-repeat:repeat-x !important;background-position:bottom !important}.pls-vertShim{background-color:#fff !important;text-align:right}.tbl-grey .pls-vertShim{background-color:#f5f5f5 !important}.pls-vertShimLeft{background-repeat:repeat-y !important;background-position:right !important;height:4px}.pls-vertShimRight{height:4px}.pls-confirm-container .pls-vertShim{background-color:#fff3c2 !important}.pls-contentWrap{background-color:#fff !important;position:relative !important;vertical-align:top}.pls-contentLeft{background-repeat:repeat-y;background-position:right;vertical-align:top}.pls-dropRight{background-image:url(//ssl.gstatic.com/s2/oz/images/stars/po/bubblev1/bubbleDropR_3.png) !important;background-repeat:repeat-y !important;vertical-align:top}.pls-vert,.pls-tailleft,.pls-dropTR .pls-dropBR,.pls-dropBL,.pls-vert img{vertical-align:top}.pls-dropBottom{background-image:url(//ssl.gstatic.com/s2/oz/images/stars/po/bubblev1/bubbleDropB_3.png) !important;background-repeat:repeat-x !important;width:100%;vertical-align:top}.pls-topLeft{background:inherit !important;text-align:right;vertical-align:bottom}.pls-topRight{background:inherit !important;text-align:left;vertical-align:bottom}.pls-bottomLeft{background:inherit !important;text-align:right}.pls-bottomRight{background:inherit !important;text-align:left;vertical-align:top}.pls-tailtop,.pls-tailright,.pls-tailbottom,.pls-tailleft{display:none;position:relative}.pls-tailbottom,.pls-tailtop,.pls-tailright,.pls-tailleft,.pls-dropTR,.pls-dropBR,.pls-dropBL{background-image:url(//ssl.gstatic.com/s2/oz/images/stars/po/bubblev1/bubbleSprite_3.png) !important;background-repeat:no-repeat}.tbl-grey .pls-tailbottom,.tbl-grey .pls-tailtop,.tbl-grey .pls-tailright,.tbl-grey .pls-tailleft,.tbl-grey .pls-dropTR,.tbl-grey .pls-dropBR,.tbl-grey .pls-dropBL{background-image:url(//ssl.gstatic.com/s2/oz/images/stars/po/bubblev1/bubbleSprite-grey.png) !important}.pls-tailbottom{background-position:-23px 0}.pls-confirm-container .pls-tailbottom{background-position:-23px -10px}.pls-tailtop{background-position:-19px -20px}.pls-tailright{background-position:0 0}.pls-tailleft{background-position:-10px 0}.pls-tailtop{vertical-align:top}.gc-bubbleDefault td{line-height:0;font-size:0}.pls-topLeft img,.pls-topRight img,.pls-tailbottom{vertical-align:bottom}.pls-bottomLeft img,.bubbleDropTR,.pls-dropBottomL img,.pls-dropBottom img,.pls-dropBottomR img,.pls-bottomLeft{vertical-align:top}.pls-dropTR{background-position:0 -22px}.pls-dropBR{background-position:0 -27px}.pls-dropBL{background-position:0 -16px}.pls-spacertop,.pls-spacerright,.pls-spacerbottom,.pls-spacerleft{position:static !important}.pls-spinner{bottom:0;position:absolute;left:0;margin:auto;right:0;top:0} </style><script async="" src="./Project Zero_ Reading privileged memory with a side-channel_files/lazy.min.js"></script></head>
<body class=" variant-simplysimple">
<div class="navbar section" id="navbar" name="Navbar"><div class="widget Navbar" data-version="1" id="Navbar1"><script src="./Project Zero_ Reading privileged memory with a side-channel_files/cb=gapi.loaded_1" async=""></script><script src="./Project Zero_ Reading privileged memory with a side-channel_files/cb=gapi(1).loaded_0" async=""></script><script type="text/javascript">
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener('load',
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent('onload', function(){ object[attribute] = val; });
      }
    }
  </script>
<div id="navbar-iframe-container"><iframe ng-non-bindable="" frameborder="0" hspace="0" marginheight="0" marginwidth="0" scrolling="no" style="" tabindex="0" vspace="0" width="100%" id="navbar-iframe" name="navbar-iframe" src="./Project Zero_ Reading privileged memory with a side-channel_files/navbar.html"></iframe></div>
<script type="text/javascript" src="./Project Zero_ Reading privileged memory with a side-channel_files/plusone.js" gapi_processed="true"></script>
<script type="text/javascript">
      gapi.load("gapi.iframes:gapi.iframes.style.bubble", function() {
        if (gapi.iframes && gapi.iframes.getContext) {
          gapi.iframes.getContext().openChild({
              url: 'https://www.blogger.com/navbar.g?targetBlogID\x3d4838136820032157985\x26blogName\x3dProject+Zero\x26publishMode\x3dPUBLISH_MODE_BLOGSPOT\x26navbarType\x3dLIGHT\x26layoutType\x3dLAYOUTS\x26searchRoot\x3dhttps://googleprojectzero.blogspot.com/search\x26blogLocale\x3den\x26v\x3d2\x26homepageUrl\x3dhttps://googleprojectzero.blogspot.com/\x26targetPostID\x3d6227737444967092885\x26blogPostOrPageUrl\x3dhttps://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html\x26vt\x3d-3982583195641882669',
              where: document.getElementById("navbar-iframe-container"),
              id: "navbar-iframe"
          });
        }
      });
    </script><script type="text/javascript">
(function() {
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = '//pagead2.googlesyndication.com/pagead/js/google_top_exp.js';
var head = document.getElementsByTagName('head')[0];
if (head) {
head.appendChild(script);
}})();
</script>
</div></div>
<div class="body-fauxcolumns">
<div class="fauxcolumn-outer body-fauxcolumn-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</div>
<div class="content">
<div class="content-fauxcolumns">
<div class="fauxcolumn-outer content-fauxcolumn-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</div>
<div class="content-outer">
<div class="content-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left content-fauxborder-left">
<div class="fauxborder-right content-fauxborder-right"></div>
<div class="content-inner">
<header>
<div class="header-outer">
<div class="header-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left header-fauxborder-left">
<div class="fauxborder-right header-fauxborder-right"></div>
<div class="region-inner header-inner">
<div class="header section" id="header" name="Header"><div class="widget Header" data-version="1" id="Header1">
<div id="header-inner">
<div class="titlewrapper">
<h1 class="title">
<a href="https://googleprojectzero.blogspot.ca/">
Project Zero
</a>
</h1>
</div>
<div class="descriptionwrapper">
<p class="description"><span>News and updates from the Project Zero team at Google</span></p>
</div>
</div>
</div></div>
</div>
</div>
<div class="header-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</header>
<div class="tabs-outer">
<div class="tabs-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left tabs-fauxborder-left">
<div class="fauxborder-right tabs-fauxborder-right"></div>
<div class="region-inner tabs-inner">
<div class="tabs no-items section" id="crosscol" name="Cross-Column"></div>
<div class="tabs no-items section" id="crosscol-overflow" name="Cross-Column 2"></div>
</div>
</div>
<div class="tabs-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<div class="main-outer">
<div class="main-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left main-fauxborder-left">
<div class="fauxborder-right main-fauxborder-right"></div>
<div class="region-inner main-inner">
<div class="columns fauxcolumns">
<div class="fauxcolumn-outer fauxcolumn-center-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<div class="fauxcolumn-outer fauxcolumn-left-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<div class="fauxcolumn-outer fauxcolumn-right-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<!-- corrects IE6 width calculation -->
<div class="columns-inner">
<div class="column-center-outer">
<div class="column-center-inner">
<div class="main section" id="main" name="Main"><div class="widget Blog" data-version="1" id="Blog1">
<div class="blog-posts hfeed">

          <div class="date-outer">
        
<h2 class="date-header"><span>Wednesday, January 3, 2018</span></h2>

          <div class="date-posts">
        
<div class="post-outer">
<div class="post hentry uncustomized-post-template" itemprop="blogPost" itemscope="itemscope" itemtype="http://schema.org/BlogPosting">
<meta content="https://3.bp.blogspot.com/-64YRnkgMujY/Wk064WtrSRI/AAAAAAAACPg/O4ZxlUiWerACL61P490xrVMWSmHTwQflQCEwYBhgL/s640/image3.png" itemprop="image_url">
<meta content="4838136820032157985" itemprop="blogId">
<meta content="6227737444967092885" itemprop="postId">
<a name="6227737444967092885"></a>
<h3 class="post-title entry-title" itemprop="name">
Reading privileged memory with a side-channel
</h3>
<div class="post-header">
<div class="post-header-line-1"></div>
</div>
<div class="post-body entry-content" id="post-body-6227737444967092885" itemprop="description articleBody">
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Posted by Jann Horn, Project Zero</span></div>
<b id="docs-internal-guid-c66856d3-bdac-1e12-91fc-544573d27dc6" style="font-weight: normal;"><br></b>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">We have discovered that CPU data cache timing can be abused to efficiently leak information out of mis-speculated execution, leading to (at worst) arbitrary virtual memory read vulnerabilities across local security boundaries in various contexts.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Variants of this issue are known to affect many modern processors, including certain processors by Intel, AMD and ARM. For a few Intel and AMD CPU models, we have exploits that work against real software. We reported this issue to Intel, AMD and ARM on 2017-06-01 [1]</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">So far, there are three known variants of the issue:</span></div>
<br>
<ul style="margin-bottom: 0pt; margin-top: 0pt;">
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Variant 1: bounds check bypass (</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 10.5pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">CVE-2017-5753)</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Variant 2: branch target injection (</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 10.5pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">CVE-2017-5715)</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Variant 3: rogue data cache load (</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 10.5pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">CVE-2017-5754)</span></div>
</li>
</ul>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; ">Before the issues described here were publicly disclosed, Daniel Gruss, Moritz Lipp, Yuval Yarom, Paul Kocher, Daniel Genkin, Michael Schwarz, Mike Hamburg, Stefan Mangard, Thomas Prescher and Werner Haas also reported them; their [writeups/blogposts/paper drafts] are at:</span></div>
<br>
<ul style="margin-bottom: 0pt; margin-top: 0pt;">
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; "><a href="https://spectreattack.com/spectre.pdf">Spectre</a> (variants 1 and 2)</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; "><a href="https://meltdownattack.com/meltdown.pdf">Meltdown</a> (variant 3)</span></div>
</li>
</ul>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">During the course of our research, we developed the following proofs of concept (PoCs):</span></div>
<br>
<ol style="margin-bottom: 0pt; margin-top: 0pt;">
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: decimal; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">A PoC that demonstrates the basic principles behind variant 1 in userspace on the tested Intel Haswell Xeon CPU, the AMD FX CPU, the AMD PRO CPU and an ARM Cortex A57 [2].</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> This PoC only tests for the ability to read data inside mis-speculated execution within the same process, without crossing any privilege boundaries.</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: decimal; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">A PoC for variant 1 that, when running with normal user privileges under a modern Linux kernel with a distro-standard config, can perform arbitrary reads in a 4GiB range [3]</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> in kernel virtual memory on the Intel Haswell Xeon CPU. If the kernel's BPF JIT is enabled (non-default configuration), it also works on the AMD PRO CPU. On the Intel Haswell Xeon CPU, kernel virtual memory can be read at a rate of around 2000 bytes per second after around 4 seconds of startup time. [4]</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: decimal; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">A PoC for variant 2 that, when running with root privileges inside a KVM guest created using virt-manager on the Intel Haswell Xeon CPU, with a specific (now outdated) version of Debian's distro kernel</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> [5] running on the host, can read host kernel memory at a rate of around 1500 bytes/second, with room for optimization. Before the attack can be performed, some initialization has to be performed that takes roughly between 10 and 30 minutes for a machine with 64GiB of RAM; the needed time should scale roughly linearly with the amount of host RAM. (If 2MB hugepages are available to the guest, the initialization should be much faster, but that hasn't been tested.)</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: decimal; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">A PoC for variant 3 that, when running with normal user privileges, can read kernel memory on the Intel Haswell Xeon CPU under some precondition. We believe that this precondition is that the targeted kernel memory is present in the L1D cache.</span></div>
</li>
</ol>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">For interesting resources around this topic, look down into the "Literature" section.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">A warning regarding explanations about processor internals in this blogpost: This blogpost contains a lot of speculation about hardware internals based on observed behavior, which might not necessarily correspond to what processors are actually doing.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">We have some ideas on possible mitigations and provided some of those ideas to the processor vendors; however, we believe that the processor vendors are in a much better position than we are to design and evaluate mitigations, and we expect them to be the source of authoritative guidance.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">The PoC code and the writeups that we sent to the CPU vendors are available here: <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1272">https://bugs.chromium.org/p/project-zero/issues/detail?id=1272</a>.</span></div>
<h1 dir="ltr" style="line-height: 1.38; margin-bottom: 6pt; margin-top: 20pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 20pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Tested Processors</span></h1>
<ul style="margin-bottom: 0pt; margin-top: 0pt;">
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.2; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 10pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Intel(R) Xeon(R) CPU E5-1650 v3 @ 3.50GHz (called "Intel Haswell Xeon CPU" in the rest of this document)</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 10pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.2; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 10pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">AMD FX(tm)-8320 Eight-Core Processor (called "AMD FX CPU" in the rest of this document)</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 10pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.2; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 10pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">AMD PRO A8-9600 R7, 10 COMPUTE CORES 4C+6G (called "AMD PRO CPU" in the rest of this document)</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 10pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.2; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 10pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">An ARM Cortex A57 core of a Google Nexus 5x phone [6]</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 10pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> (called "ARM Cortex A57" in the rest of this document)</span></div>
</li>
</ul>
<h1 dir="ltr" style="line-height: 1.38; margin-bottom: 6pt; margin-top: 20pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 20pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Glossary</span></h1>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: italic; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">retire:</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> An instruction retires when its results, e.g. register writes and memory writes, are committed and made visible to the rest of the system. Instructions can be executed out of order, but must always retire in order.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: italic; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">logical processor core:</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> A logical processor core is what the operating system sees as a processor core. With hyperthreading enabled, the number of logical cores is a multiple of the number of physical cores.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: italic; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">cached/uncached data:</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> In this blogpost, "uncached" data is data that is only present in main memory, not in any of the cache levels of the CPU. Loading uncached data will typically take over 100 cycles of CPU time.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: italic; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">speculative execution:</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> A processor can execute past a branch without knowing whether it will be taken or where its target is, therefore executing instructions before it is known whether they should be executed. If this speculation turns out to have been incorrect, the CPU can discard the resulting state without architectural effects and continue execution on the correct execution path. Instructions do not retire before it is known that they are on the correct execution path.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: italic; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">mis-speculation window:</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> The time window during which the CPU speculatively executes the wrong code and has not yet detected that mis-speculation has occurred.</span></div>
<h1 dir="ltr" style="line-height: 1.38; margin-bottom: 6pt; margin-top: 20pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 20pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Variant 1: Bounds check bypass</span></h1>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">This section explains the common theory behind all three variants and the theory behind our PoC for variant 1 that, when running in userspace under a Debian distro kernel, can perform arbitrary reads in a 4GiB region of kernel memory in at least the following configurations:</span></div>
<br>
<ul style="margin-bottom: 0pt; margin-top: 0pt;">
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Intel Haswell Xeon CPU, eBPF JIT is off (default state)</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Intel Haswell Xeon CPU, eBPF JIT is on (non-default state)</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">AMD PRO CPU, eBPF JIT is on (non-default state)</span></div>
</li>
</ul>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">The state of the eBPF JIT can be toggled using the net.core.bpf_jit_enable sysctl.</span></div>
<h2 dir="ltr" style="line-height: 1.38; margin-bottom: 6pt; margin-top: 18pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 16pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Theoretical explanation</span></h2>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">The </span><a href="https://www.intel.com/content/dam/www/public/us/en/documents/manuals/64-ia-32-architectures-optimization-manual.pdf" style="text-decoration: none;"><span style="background-color: transparent; color: #1155cc; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: underline; vertical-align: baseline;">Intel Optimization Reference Manual</span></a><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> says the following regarding Sandy Bridge (and later microarchitectural revisions) in section 2.3.2.3 ("Branch Prediction"):</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-left: 36pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Branch prediction predicts the branch target and enables the</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-left: 36pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">processor to begin executing instructions long before the branch</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-left: 36pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">true execution path is known.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">In section 2.3.5.2 ("L1 DCache"):</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-left: 36pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Loads can:</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-left: 36pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">[...]</span></div>
<ul style="margin-bottom: 0pt; margin-top: 0pt;">
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; margin-left: 36pt; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Be carried out speculatively, before preceding branches are resolved.</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; margin-left: 36pt; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Take cache misses out of order and in an overlapped manner.</span></div>
</li>
</ul>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Intel's Software Developer's Manual</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> [7] states in Volume 3A, section 11.7 ("Implicit Caching (Pentium 4, Intel Xeon, and P6 family processors"):</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-left: 36pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Implicit caching occurs when a memory element is made potentially cacheable, although the element may never have been accessed in the normal von Neumann sequence. Implicit caching occurs on the P6 and more recent processor families due to aggressive prefetching, branch prediction, and TLB miss handling. Implicit caching is an extension of the behavior of existing Intel386, Intel486, and Pentium processor systems, since software running on these processor families also has not been able to deterministically predict the behavior of instruction prefetch.</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Consider the code sample below. If </span><span style="background-color: lime; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">arr1-&gt;length</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> is uncached, the processor can speculatively load data from </span><span style="background-color: cyan; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">arr1-&gt;data[untrusted_offset_from_caller]</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">. This is an out-of-bounds read. That should not matter because the processor will effectively roll back the execution state when the branch has executed; none of the speculatively executed instructions will retire (e.g. cause registers etc. to be affected).</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">struct array {</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> &nbsp;unsigned long length;</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> &nbsp;unsigned char data[];</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">};</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">struct array *arr1 = ...;</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">unsigned long untrusted_offset_from_caller = ...;</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">if (untrusted_offset_from_caller &lt; </span><span style="background-color: lime; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">arr1-&gt;length</span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">) {</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> &nbsp;unsigned char value = </span><span style="background-color: cyan; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">arr1-&gt;data[untrusted_offset_from_caller]</span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">;</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> &nbsp;...</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">}</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">However, in the following code sample, there's an issue. If </span><span style="background-color: lime; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">arr1-&gt;length</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">, </span><span style="background-color: #4a86e8; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">arr2-&gt;data[0x200]</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> and </span><span style="background-color: #4a86e8; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">arr2-&gt;data[0x300]</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> are not cached, but all other accessed data is, and the branch conditions are predicted as true, the processor can do the following speculatively before </span><span style="background-color: lime; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">arr1-&gt;length</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> has been loaded and the execution is re-steered:</span></div>
<br>
<ul style="margin-bottom: 0pt; margin-top: 0pt;">
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">load </span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">value = </span><span style="background-color: cyan; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">arr1-&gt;data[</span><span style="background-color: #f6b26b; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">untrusted_offset_from_caller</span><span style="background-color: cyan; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">]</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">start a load from a data-dependent offset in </span><span style="background-color: #4a86e8; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">arr2-&gt;data</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">, loading the corresponding cache line into the L1 cache</span></div>
</li>
</ul>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">struct array {</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> &nbsp;unsigned long length;</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> &nbsp;unsigned char data[];</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">};</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">struct array *arr1 = ...; /* small array */</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">struct array *arr2 = ...; /* array of size 0x400 */</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: #f6b26b; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">/* &gt;0x400 </span><span style="background-color: #f6b26b; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 700; text-decoration: none; vertical-align: baseline;">(OUT OF BOUNDS!)</span><span style="background-color: #f6b26b; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> */</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: #f6b26b; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">unsigned long untrusted_offset_from_caller = ...;</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">if (</span><span style="background-color: #f6b26b; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">untrusted_offset_from_caller</span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> &lt; </span><span style="background-color: lime; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">arr1-&gt;length</span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">) {</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> &nbsp;unsigned char value = </span><span style="background-color: cyan; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">arr1-&gt;data[</span><span style="background-color: #f6b26b; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">untrusted_offset_from_caller</span><span style="background-color: cyan; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">]</span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">;</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> &nbsp;unsigned long index2 = ((value&amp;1)*0x100)+0x200;</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> &nbsp;if (index2 &lt; arr2-&gt;length) {</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> &nbsp;&nbsp;&nbsp;unsigned char value2 = </span><span style="background-color: #4a86e8; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">arr2-&gt;data[index2]</span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">;</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> &nbsp;}</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">}</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">After the execution has been returned to the non-speculative path because the processor has noticed that </span><span style="background-color: #f6b26b; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">untrusted_offset_from_caller</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> is bigger than </span><span style="background-color: lime; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">arr1-&gt;length</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">, the cache line containing </span><span style="background-color: #4a86e8; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">arr2-&gt;data[index2]</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> stays in the L1 cache. By measuring the time required to load </span><span style="background-color: #4a86e8; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">arr2-&gt;data[0x200]</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> and </span><span style="background-color: #4a86e8; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">arr2-&gt;data[0x300]</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">, an attacker can then determine whether the value of </span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">index2</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> during speculative execution was 0x200 or 0x300 - which discloses whether </span><span style="background-color: cyan; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">arr1-&gt;data[</span><span style="background-color: #f6b26b; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">untrusted_offset_from_caller</span><span style="background-color: cyan; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">]</span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">&amp;1</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> is 0 or 1.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">To be able to actually use this behavior for an attack, an attacker needs to be able to cause the execution of such a vulnerable code pattern in the targeted context with an out-of-bounds index. For this, the vulnerable code pattern must either be present in existing code, or there must be an interpreter or JIT engine that can be used to generate the vulnerable code pattern. So far, we have not actually identified any existing, exploitable instances of the vulnerable code pattern; the PoC for leaking kernel memory using variant 1 uses the eBPF interpreter or the eBPF JIT engine, which are built into the kernel and accessible to normal users.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">A minor variant of this could be to instead use an out-of-bounds read to a function pointer to gain control of execution in the mis-speculated path. We did not investigate this variant further.</span></div>
<h2 dir="ltr" style="line-height: 1.38; margin-bottom: 6pt; margin-top: 18pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 16pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Attacking the kernel</span></h2>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">This section describes in more detail how variant 1 can be used to leak Linux kernel memory using the eBPF bytecode interpreter and JIT engine. While there are many interesting potential targets for variant 1 attacks, we chose to attack the Linux in-kernel eBPF JIT/interpreter because it provides more control to the attacker than most other JITs.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">The Linux kernel supports eBPF since version 3.18. Unprivileged userspace code can supply bytecode to the kernel that is verified by the kernel and then:</span></div>
<br>
<ul style="margin-bottom: 0pt; margin-top: 0pt;">
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">either interpreted by an in-kernel bytecode interpreter</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">or translated to native machine code that also runs in kernel context using a JIT engine (which translates individual bytecode instructions without performing any further optimizations)</span></div>
</li>
</ul>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Execution of the bytecode can be triggered by attaching the eBPF bytecode to a socket as a filter and then sending data through the other end of the socket.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Whether the JIT engine is enabled depends on a run-time configuration setting - but at least on the tested Intel processor, the attack works independent of that setting.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Unlike classic BPF, eBPF has data types like data arrays and function pointer arrays into which eBPF bytecode can index. Therefore, it is possible to create the code pattern described above in the kernel using eBPF bytecode.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">eBPF's data arrays are less efficient than its function pointer arrays, so the attack will use the latter where possible.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Both machines on which this was tested have no SMAP, and the PoC relies on that (but it shouldn't be a precondition in principle).</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Additionally, at least on the Intel machine on which this was tested, bouncing modified cache lines between cores is slow, apparently because the MESI protocol is used for cache coherence [8]</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">. Changing the reference counter of an eBPF array on one physical CPU core causes the cache line containing the reference counter to be bounced over to that CPU core, making reads of the reference counter on all other CPU cores slow until the changed reference counter has been written back to memory. Because the length and the reference counter of an eBPF array are stored in the same cache line, this also means that changing the reference counter on one physical CPU core causes reads of the eBPF array's length to be slow on other physical CPU cores (intentional false sharing).</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">The attack uses two eBPF programs. The first one tail-calls through a page-aligned eBPF function pointer array </span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">prog_map</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> at a configurable index. In simplified terms, this program is used to determine the address of </span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">prog_map</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> by guessing the offset from </span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">prog_map</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> to a userspace address and tail-calling through </span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">prog_map</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> at the guessed offsets. To cause the branch prediction to predict that the offset is below the length of </span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">prog_map</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">, tail calls to an in-bounds index are performed in between. To increase the mis-speculation window, the cache line containing the length of </span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">prog_map</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> is bounced to another core. To test whether an offset guess was successful, it can be tested whether the userspace address has been loaded into the cache.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Because such straightforward brute-force guessing of the address would be slow, the following optimization is used: 2</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 6.6pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: super;">15</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> adjacent userspace memory mappings [9]</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">, each consisting of 2</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 6.6pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: super;">4</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> pages, are created at the userspace address </span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">user_mapping_area</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">, covering a total area of 2</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 6.6pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: super;">31</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> bytes. Each mapping maps the same physical pages, and all mappings are present in the pagetables.</span></div>
<br>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://3.bp.blogspot.com/-64YRnkgMujY/Wk064WtrSRI/AAAAAAAACPg/O4ZxlUiWerACL61P490xrVMWSmHTwQflQCEwYBhgL/s1600/image3.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="138" data-original-width="624" height="139" src="./Project Zero_ Reading privileged memory with a side-channel_files/image3.png" width="640"></a></div>
<div class="separator" style="clear: both; text-align: center;">
</div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"></span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">This permits the attack to be carried out in steps of 2</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 6.6pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: super;">31</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> bytes. For each step, after causing an out-of-bounds access through </span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">prog_map</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">, only one cache line each from the first 2</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 6.6pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: super;">4</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> pages of </span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">user_mapping_area</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> have to be tested for cached memory. Because the L3 cache is physically indexed, any access to a virtual address mapping a physical page will cause all other virtual addresses mapping the same physical page to become cached as well.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">When this attack finds a hit—a cached memory location—the upper 33 bits of the kernel address are known (because they can be derived from the address guess at which the hit occurred), and the low 16 bits of the address are also known (from the offset inside </span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">user_mapping_area</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> at which the hit was found). The remaining part of the address of </span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">user_mapping_area</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> is the middle.</span></div>
<br>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://1.bp.blogspot.com/-kSdcfy3GVSw/Wk065qWZZaI/AAAAAAAACPs/7HRZEXij3rIqvAf4gq8QpyHKvJsT2pYIQCEwYBhgL/s1600/image5.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="149" data-original-width="624" height="152" src="./Project Zero_ Reading privileged memory with a side-channel_files/image5.png" width="640"></a></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"></span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">The remaining bits in the middle can be determined by bisecting the remaining address space: Map two physical pages to adjacent ranges of virtual addresses, each virtual address range the size of half of the remaining search space, then determine the remaining address bit-wise.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">At this point, a second eBPF program can be used to actually leak data. In pseudocode, this program looks as follows:</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">uint64_t bitmask = &lt;runtime-configurable&gt;;</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">uint64_t bitshift_selector = &lt;runtime-configurable&gt;;</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">uint64_t prog_array_base_offset = &lt;runtime-configurable&gt;;</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">uint64_t secret_data_offset = &lt;runtime-configurable&gt;;</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">// index will be bounds-checked by the runtime,</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">// but the bounds check will be bypassed speculatively</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">uint64_t secret_data = bpf_map_read(array=victim_array, index=secret_data_offset);</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">// select a single bit, move it to a specific position, and add the base offset</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">uint64_t progmap_index = (((secret_data &amp; bitmask) &gt;&gt; bitshift_selector) &lt;&lt; 7) + prog_array_base_offset;</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">bpf_tail_call(prog_map, progmap_index);</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">This program reads 8-byte-aligned 64-bit values from an eBPF data array "</span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">victim_map</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">" at a runtime-configurable offset and bitmasks and bit-shifts the value so that one bit is mapped to one of two values that are 2</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 6.6pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: super;">7</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> bytes apart (sufficient to not land in the same or adjacent cache lines when used as an array index). Finally it adds a 64-bit offset, then uses the resulting value as an offset into </span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">prog_map</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> for a tail call.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">This program can then be used to leak memory by repeatedly calling the eBPF program with an out-of-bounds offset into </span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">victim_map</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> that specifies the data to leak and an out-of-bounds offset into </span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">prog_map</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> that causes </span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">prog_map + offset</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> to point to a userspace memory area. Misleading the branch prediction and bouncing the cache lines works the same way as for the first eBPF program, except that now, the cache line holding the length of </span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">victim_map</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> must also be bounced to another core.</span></div>
<h1 dir="ltr" style="line-height: 1.38; margin-bottom: 6pt; margin-top: 20pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 20pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Variant 2: Branch target injection</span></h1>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">This section describes the theory behind our PoC for variant 2 that, when running with root privileges inside a KVM guest created using virt-manager on the Intel Haswell Xeon CPU, with a specific version of Debian's distro kernel running on the host, can read host kernel memory at a rate of around 1500 bytes/second.</span></div>
<h2 dir="ltr" style="line-height: 1.38; margin-bottom: 6pt; margin-top: 18pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 16pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Basics</span></h2>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Prior research (see the Literature section at the end) has shown that it is possible for code in separate security contexts to influence each other's branch prediction. So far, this has only been used to infer information about where code is located (in other words, to create interference from the victim to the attacker); however, the basic hypothesis of this attack variant is that it can also be used to redirect execution of code in the victim context (in other words, to create interference from the attacker to the victim; the other way around).</span></div>
<br>
<div class="separator" style="clear: both; text-align: center;">
<a href="./Project Zero_ Reading privileged memory with a side-channel_files/image2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="200" data-original-width="278" src="./Project Zero_ Reading privileged memory with a side-channel_files/image2.png"></a></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt; text-align: center;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"></span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">The basic idea for the attack is to target victim code that contains an indirect branch whose target address is loaded from memory and flush the cache line containing the target address out to main memory. Then, when the CPU reaches the indirect branch, it won't know the true destination of the jump, and it won't be able to calculate the true destination until it has finished loading the cache line back into the CPU, which takes a few hundred cycles. Therefore, there is a time window of typically over 100 cycles in which the CPU will speculatively execute instructions based on branch prediction.</span></div>
<h2 dir="ltr" style="line-height: 1.38; margin-bottom: 6pt; margin-top: 18pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 16pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Haswell branch prediction internals</span></h2>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Some of the internals of the branch prediction implemented by Intel's processors have already been published; however, getting this attack to work properly required significant further experimentation to determine additional details.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">This section focuses on the branch prediction internals that were experimentally derived from the Intel Haswell Xeon CPU.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Haswell seems to have multiple branch prediction mechanisms that work very differently:</span></div>
<br>
<ul style="margin-bottom: 0pt; margin-top: 0pt;">
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">A generic branch predictor that can only store one target per source address; used for all kinds of jumps, like absolute jumps, relative jumps and so on.</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">A specialized indirect call predictor that can store multiple targets per source address; used for indirect calls.</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">(There is also a specialized return predictor, according to Intel's optimization manual, but we haven't analyzed that in detail yet. If this predictor could be used to reliably dump out some of the call stack through which a VM was entered, that would be very interesting.)</span></div>
</li>
</ul>
<h3 dir="ltr" style="line-height: 1.38; margin-bottom: 4pt; margin-top: 16pt;">
<span style="background-color: transparent; color: #434343; font-family: &quot;arial&quot;; font-size: 13.999999999999998pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Generic predictor</span></h3>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">The generic branch predictor, as documented in prior research, only uses the lower 31 bits of the address of the last byte of the source instruction for its prediction. If, for example, a branch target buffer (BTB) entry exists for a jump from 0x4141.0004.1000 to 0x4141.0004.5123, the generic predictor will also use it to predict a jump from 0x4242.0004.1000. When the higher bits of the source address differ like this, the higher bits of the predicted destination change together with it—in this case, the predicted destination address will be 0x4242.0004.5123—so apparently this predictor doesn't store the full, absolute destination address.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Before the lower 31 bits of the source address are used to look up a BTB entry, they are folded together using XOR. Specifically, the following bits are folded together:</span></div>
<br>
<div dir="ltr" style="margin-left: 0pt;">
<table style="border-collapse: collapse; border: none; width: 468pt;"><colgroup><col width="*"><col width="*"></colgroup><tbody>
<tr style="height: 0pt;"><td style="border-bottom: solid #000000 1pt; border-left: solid #000000 1pt; border-right: solid #000000 1pt; border-top: solid #000000 1pt; padding: 5pt 5pt 5pt 5pt; vertical-align: top;"><div dir="ltr" style="line-height: 1.2; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">bit A</span></div>
</td><td style="border-bottom: solid #000000 1pt; border-left: solid #000000 1pt; border-right: solid #000000 1pt; border-top: solid #000000 1pt; padding: 5pt 5pt 5pt 5pt; vertical-align: top;"><div dir="ltr" style="line-height: 1.2; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">bit B</span></div>
</td></tr>
<tr style="height: 0pt;"><td style="border-bottom: solid #000000 1pt; border-left: solid #000000 1pt; border-right: solid #000000 1pt; border-top: solid #000000 1pt; padding: 5pt 5pt 5pt 5pt; vertical-align: top;"><div dir="ltr" style="line-height: 1.2; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">0x40.0000</span></div>
</td><td style="border-bottom: solid #000000 1pt; border-left: solid #000000 1pt; border-right: solid #000000 1pt; border-top: solid #000000 1pt; padding: 5pt 5pt 5pt 5pt; vertical-align: top;"><div dir="ltr" style="line-height: 1.2; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">0x2000</span></div>
</td></tr>
<tr style="height: 0pt;"><td style="border-bottom: solid #000000 1pt; border-left: solid #000000 1pt; border-right: solid #000000 1pt; border-top: solid #000000 1pt; padding: 5pt 5pt 5pt 5pt; vertical-align: top;"><div dir="ltr" style="line-height: 1.2; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">0x80.0000</span></div>
</td><td style="border-bottom: solid #000000 1pt; border-left: solid #000000 1pt; border-right: solid #000000 1pt; border-top: solid #000000 1pt; padding: 5pt 5pt 5pt 5pt; vertical-align: top;"><div dir="ltr" style="line-height: 1.2; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">0x4000</span></div>
</td></tr>
<tr style="height: 0pt;"><td style="border-bottom: solid #000000 1pt; border-left: solid #000000 1pt; border-right: solid #000000 1pt; border-top: solid #000000 1pt; padding: 5pt 5pt 5pt 5pt; vertical-align: top;"><div dir="ltr" style="line-height: 1.2; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">0x100.0000</span></div>
</td><td style="border-bottom: solid #000000 1pt; border-left: solid #000000 1pt; border-right: solid #000000 1pt; border-top: solid #000000 1pt; padding: 5pt 5pt 5pt 5pt; vertical-align: top;"><div dir="ltr" style="line-height: 1.2; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">0x8000</span></div>
</td></tr>
<tr style="height: 0pt;"><td style="border-bottom: solid #000000 1pt; border-left: solid #000000 1pt; border-right: solid #000000 1pt; border-top: solid #000000 1pt; padding: 5pt 5pt 5pt 5pt; vertical-align: top;"><div dir="ltr" style="line-height: 1.2; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">0x200.0000</span></div>
</td><td style="border-bottom: solid #000000 1pt; border-left: solid #000000 1pt; border-right: solid #000000 1pt; border-top: solid #000000 1pt; padding: 5pt 5pt 5pt 5pt; vertical-align: top;"><div dir="ltr" style="line-height: 1.2; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">0x1.0000</span></div>
</td></tr>
<tr style="height: 0pt;"><td style="border-bottom: solid #000000 1pt; border-left: solid #000000 1pt; border-right: solid #000000 1pt; border-top: solid #000000 1pt; padding: 5pt 5pt 5pt 5pt; vertical-align: top;"><div dir="ltr" style="line-height: 1.2; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">0x400.0000</span></div>
</td><td style="border-bottom: solid #000000 1pt; border-left: solid #000000 1pt; border-right: solid #000000 1pt; border-top: solid #000000 1pt; padding: 5pt 5pt 5pt 5pt; vertical-align: top;"><div dir="ltr" style="line-height: 1.2; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">0x2.0000</span></div>
</td></tr>
<tr style="height: 0pt;"><td style="border-bottom: solid #000000 1pt; border-left: solid #000000 1pt; border-right: solid #000000 1pt; border-top: solid #000000 1pt; padding: 5pt 5pt 5pt 5pt; vertical-align: top;"><div dir="ltr" style="line-height: 1.2; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">0x800.0000</span></div>
</td><td style="border-bottom: solid #000000 1pt; border-left: solid #000000 1pt; border-right: solid #000000 1pt; border-top: solid #000000 1pt; padding: 5pt 5pt 5pt 5pt; vertical-align: top;"><div dir="ltr" style="line-height: 1.2; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">0x4.0000</span></div>
</td></tr>
<tr style="height: 0pt;"><td style="border-bottom: solid #000000 1pt; border-left: solid #000000 1pt; border-right: solid #000000 1pt; border-top: solid #000000 1pt; padding: 5pt 5pt 5pt 5pt; vertical-align: top;"><div dir="ltr" style="line-height: 1.2; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">0x2000.0000</span></div>
</td><td style="border-bottom: solid #000000 1pt; border-left: solid #000000 1pt; border-right: solid #000000 1pt; border-top: solid #000000 1pt; padding: 5pt 5pt 5pt 5pt; vertical-align: top;"><div dir="ltr" style="line-height: 1.2; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">0x10.0000</span></div>
</td></tr>
<tr style="height: 0pt;"><td style="border-bottom: solid #000000 1pt; border-left: solid #000000 1pt; border-right: solid #000000 1pt; border-top: solid #000000 1pt; padding: 5pt 5pt 5pt 5pt; vertical-align: top;"><div dir="ltr" style="line-height: 1.2; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">0x4000.0000</span></div>
</td><td style="border-bottom: solid #000000 1pt; border-left: solid #000000 1pt; border-right: solid #000000 1pt; border-top: solid #000000 1pt; padding: 5pt 5pt 5pt 5pt; vertical-align: top;"><div dir="ltr" style="line-height: 1.2; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">0x20.0000</span></div>
</td></tr>
</tbody></table>
</div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">In other words, if a source address is XORed with both numbers in a row of this table, the branch predictor will not be able to distinguish the resulting address from the original source address when performing a lookup. For example, the branch predictor is able to distinguish source addresses 0x100.0000 and 0x180.0000, and it can also distinguish source addresses 0x100.0000 and 0x180.8000, but it can't distinguish source addresses 0x100.0000 and 0x140.2000 or source addresses 0x100.0000 and 0x180.4000. In the following, this will be referred to as aliased source addresses.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">When an aliased source address is used, the branch predictor will still predict the same target as for the unaliased source address. This indicates that the branch predictor stores a truncated absolute destination address, but that hasn't been verified.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Based on observed maximum forward and backward jump distances for different source addresses, the low 32-bit half of the target address could be stored as an absolute 32-bit value with an additional bit that specifies whether the jump from source to target crosses a 2</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 6.6pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: super;">32</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> boundary; if the jump crosses such a boundary, bit 31 of the source address determines whether the high half of the instruction pointer should increment or decrement.</span></div>
<h3 dir="ltr" style="line-height: 1.38; margin-bottom: 4pt; margin-top: 16pt;">
<span style="background-color: transparent; color: #434343; font-family: &quot;arial&quot;; font-size: 13.999999999999998pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Indirect call predictor</span></h3>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">The inputs of the BTB lookup for this mechanism seem to be:</span></div>
<br>
<ul style="margin-bottom: 0pt; margin-top: 0pt;">
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">The low 12 bits of the address of the source instruction (we are not sure whether it's the address of the first or the last byte) or a subset of them.</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">The branch history buffer state.</span></div>
</li>
</ul>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">If the indirect call predictor can't resolve a branch, it is resolved by the generic predictor instead. Intel's optimization manual hints at this behavior: "Indirect Calls and Jumps. These may either be predicted as having a monotonic target or as having targets that vary in accordance with recent program behavior."</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">The branch history buffer (BHB) stores information about the last 29 taken branches - basically a fingerprint of recent control flow - and is used to allow better prediction of indirect calls that can have multiple targets.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">The update function of the BHB works as follows (in pseudocode; </span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">src</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> is the address of the last byte of the source instruction, </span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">dst</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> is the destination address):</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">void bhb_update(uint58_t *bhb_state, unsigned long src, unsigned long dst) {</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> &nbsp;*bhb_state &lt;&lt;= 2;</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> &nbsp;*bhb_state ^= (dst &amp; 0x3f);</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> &nbsp;*bhb_state ^= (src &amp; 0xc0) &gt;&gt; 6;</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> &nbsp;*bhb_state ^= (src &amp; 0xc00) &gt;&gt; (10 - 2);</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> &nbsp;*bhb_state ^= (src &amp; 0xc000) &gt;&gt; (14 - 4);</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> &nbsp;*bhb_state ^= (src &amp; 0x30) &lt;&lt; (6 - 4);</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> &nbsp;*bhb_state ^= (src &amp; 0x300) &lt;&lt; (8 - 8);</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> &nbsp;*bhb_state ^= (src &amp; 0x3000) &gt;&gt; (12 - 10);</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> &nbsp;*bhb_state ^= (src &amp; 0x30000) &gt;&gt; (16 - 12);</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> &nbsp;*bhb_state ^= (src &amp; 0xc0000) &gt;&gt; (18 - 14);</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">}</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Some of the bits of the BHB state seem to be folded together further using XOR when used for a BTB access, but the precise folding function hasn't been understood yet.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">The BHB is interesting for two reasons. First, knowledge about its approximate behavior is required in order to be able to accurately cause collisions in the indirect call predictor. But it also permits dumping out the BHB state at any repeatable program state at which the attacker can execute code - for example, when attacking a hypervisor, directly after a hypercall. The dumped BHB state can then be used to fingerprint the hypervisor or, if the attacker has access to the hypervisor binary, to determine the low 20 bits of the hypervisor load address (in the case of KVM: the low 20 bits of the load address of kvm-intel.ko).</span></div>
<h3 dir="ltr" style="line-height: 1.38; margin-bottom: 4pt; margin-top: 16pt;">
<span style="background-color: transparent; color: #434343; font-family: &quot;arial&quot;; font-size: 13.999999999999998pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Reverse-Engineering Branch Predictor Internals</span></h3>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: italic; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">This subsection describes how we reverse-engineered the internals of the Haswell branch predictor. Some of this is written down from memory, since we didn't keep a detailed record of what we were doing.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">We initially attempted to perform BTB injections into the kernel using the generic predictor, using the knowledge from prior research that the generic predictor only looks at the lower half of the source address and that only a partial target address is stored. This kind of worked - however, the injection success rate was very low, below 1%. (This is the method we used in our preliminary PoCs for method 2 against modified hypervisors running on Haswell.)</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">We decided to write a userspace test case to be able to more easily test branch predictor behavior in different situations.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Based on the assumption that branch predictor state is shared between hyperthreads [10]</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">, we wrote a program of which two instances are each pinned to one of the two logical processors running on a specific physical core, where one instance attempts to perform branch injections while the other measures how often branch injections are successful. Both instances were executed with ASLR disabled and had the same code at the same addresses. The injecting process performed indirect calls to a function that accesses a (per-process) test variable; the measuring process performed indirect calls to a function that tests, based on timing, whether the per-process test variable is cached, and then evicts it using CLFLUSH. Both indirect calls were performed through the same callsite. Before each indirect call, the function pointer stored in memory was flushed out to main memory using CLFLUSH to widen the speculation time window. Additionally, because of the reference to "recent program behavior" in Intel's optimization manual, a bunch of conditional branches that are always taken were inserted in front of the indirect call.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">In this test, the injection success rate was above 99%, giving us a base setup for future experiments.</span></div>
<br>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://2.bp.blogspot.com/-RMKau2Jstd0/Wk066oeGPUI/AAAAAAAACP0/sb5X95OHei0JV0xhCQDRhaYhRsLvx9ZmACEwYBhgL/s1600/image7.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="644" data-original-width="618" height="640" src="./Project Zero_ Reading privileged memory with a side-channel_files/image7.png" width="612"></a></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"></span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">We then tried to figure out the details of the prediction scheme. We assumed that the prediction scheme uses a global branch history buffer of some kind.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">To determine the duration for which branch information stays in the history buffer, a conditional branch that is only taken in one of the two program instances was inserted in front of the series of always-taken conditional jumps, then the number of always-taken conditional jumps (N) was varied. The result was that for N=25, the processor was able to distinguish the branches (misprediction rate under 1%), but for N=26, it failed to do so (misprediction rate over 99%).</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Therefore, the branch history buffer had to be able to store information about at least the last 26 branches.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">The code in one of the two program instances was then moved around in memory. This revealed that only the lower 20 bits of the source and target addresses have an influence on the branch history buffer.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Testing with different types of branches in the two program instances revealed that static jumps, taken conditional jumps, calls and returns influence the branch history buffer the same way; non-taken conditional jumps don't influence it; the address of the last byte of the source instruction is the one that counts; IRETQ doesn't influence the history buffer state (which is useful for testing because it permits creating program flow that is invisible to the history buffer).</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Moving the last conditional branch before the indirect call around in memory multiple times revealed that the branch history buffer contents can be used to distinguish many different locations of that last conditional branch instruction. This suggests that the history buffer doesn't store a list of small history values; instead, it seems to be a larger buffer in which history data is mixed together.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">However, a history buffer needs to "forget" about past branches after a certain number of new branches have been taken in order to be useful for branch prediction. Therefore, when new data is mixed into the history buffer, this can not cause information in bits that are already present in the history buffer to propagate downwards - and given that, upwards combination of information probably wouldn't be very useful either. Given that branch prediction also must be very fast, we concluded that it is likely that the update function of the history buffer left-shifts the old history buffer, then XORs in the new state (see diagram).</span></div>
<br>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://1.bp.blogspot.com/-crbBTenupqw/Wk066CBQ2qI/AAAAAAAACPw/GaUAa5tUDE8dV9tZ6bt-QWGLY5klZM5FgCEwYBhgL/s1600/image6.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="117" data-original-width="624" height="118" src="./Project Zero_ Reading privileged memory with a side-channel_files/image6.png" width="640"></a></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"></span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">If this assumption is correct, then the history buffer contains a lot of information about the most recent branches, but only contains as many bits of information as are shifted per history buffer update about the last branch about which it contains any data. Therefore, we tested whether flipping different bits in the source and target addresses of a jump followed by 32 always-taken jumps with static source and target allows the branch prediction to disambiguate an indirect call. [11]</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> </span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">With 32 static jumps in between, no bit flips seemed to have an influence, so we decreased the number of static jumps until a difference was observable. The result with 28 always-taken jumps in between was that bits 0x1 and 0x2 of the target and bits 0x40 and 0x80 of the source had such an influence; but flipping both 0x1 in the target and 0x40 in the source or 0x2 in the target and 0x80 in the source did not permit disambiguation. This shows that the per-insertion shift of the history buffer is 2 bits and shows which data is stored in the least significant bits of the history buffer. We then repeated this with decreased amounts of fixed jumps after the bit-flipped jump to determine which information is stored in the remaining bits.</span></div>
<h2 dir="ltr" style="line-height: 1.38; margin-bottom: 6pt; margin-top: 18pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 16pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Reading host memory from a KVM guest</span></h2>
<h3 dir="ltr" style="line-height: 1.38; margin-bottom: 4pt; margin-top: 16pt;">
<span style="background-color: transparent; color: #434343; font-family: &quot;arial&quot;; font-size: 13.999999999999998pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Locating the host kernel</span></h3>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Our PoC locates the host kernel in several steps. The information that is determined and necessary for the next steps of the attack consists of:</span></div>
<br>
<ul style="margin-bottom: 0pt; margin-top: 0pt;">
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">lower 20 bits of the address of kvm-intel.ko</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">full address of kvm.ko</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">full address of vmlinux</span></div>
</li>
</ul>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Looking back, this is unnecessarily complicated, but it nicely demonstrates the various techniques an attacker can use. A simpler way would be to first determine the address of vmlinux, then bisect the addresses of kvm.ko and kvm-intel.ko.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">In the first step, the address of kvm-intel.ko is leaked. For this purpose, the branch history buffer state after guest entry is dumped out. Then, for every possible value of bits 12..19 of the load address of kvm-intel.ko, the expected lowest 16 bits of the history buffer are computed based on the load address guess and the known offsets of the last 8 branches before guest entry, and the results are compared against the lowest 16 bits of the leaked history buffer state.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">The branch history buffer state is leaked in steps of 2 bits by measuring misprediction rates of an indirect call with two targets. One way the indirect call is reached is from a vmcall instruction followed by a series of N branches whose relevant source and target address bits are all zeroes. The second way the indirect call is reached is from a series of controlled branches in userspace that can be used to write arbitrary values into the branch history buffer.</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Misprediction rates are measured as in the section "Reverse-Engineering Branch Predictor Internals", using one call target that loads a cache line and another one that checks whether the same cache line has been loaded.</span></div>
<br>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://3.bp.blogspot.com/-juuq6gYvhn4/Wk065XER9yI/AAAAAAAACPo/EuTi1HzweloKCChZajY7FUDEtHXhs12ZwCEwYBhgL/s1600/image4.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="462" data-original-width="451" height="640" src="./Project Zero_ Reading privileged memory with a side-channel_files/image4.png" width="624"></a></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"></span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">With N=29, mispredictions will occur at a high rate if the controlled branch history buffer value is zero because all history buffer state from the hypercall has been erased. With N=28, mispredictions will occur if the controlled branch history buffer value is one of 0&lt;&lt;(28*2), 1&lt;&lt;(28*2), 2&lt;&lt;(28*2), 3&lt;&lt;(28*2) - by testing all four possibilities, it can be detected which one is right. Then, for decreasing values of N, the four possibilities are {0|1|2|3}&lt;&lt;(28*2) | (history_buffer_for(N+1) &gt;&gt; 2). By repeating this for decreasing values for N, the branch history buffer value for N=0 can be determined.</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"></span></div>
<br>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://4.bp.blogspot.com/-uAWgXXpjs8I/Wk064FS-g3I/AAAAAAAACPc/0nh9nbSn0EkTXgzbbuY1TRROTR02GWIFQCEwYBhgL/s1600/image1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="315" data-original-width="457" height="440" src="./Project Zero_ Reading privileged memory with a side-channel_files/image1.png" width="640"></a></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">At this point, the low 20 bits of kvm-intel.ko are known; the next step is to roughly locate kvm.ko.</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">For this, the generic branch predictor is used, using data inserted into the BTB by an indirect call from kvm.ko to kvm-intel.ko that happens on every hypercall; this means that the source address of the indirect call has to be leaked out of the BTB.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">kvm.ko will probably be located somewhere in the range from </span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">0xffffffffc0000000</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> to </span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">0xffffffffc4000000</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">, with page alignment (0x1000). This means that the first four entries in the table in the section "Generic Predictor" apply; there will be 2</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 6.6pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: super;">4</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">-1=15 aliasing addresses for the correct one. But that is also an advantage: It cuts down the search space from 0x4000 to 0x4000/2</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 6.6pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: super;">4</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">=1024.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">To find the right address for the source or one of its aliasing addresses, code that loads data through a specific register is placed at all possible call targets (the leaked low 20 bits of kvm-intel.ko plus the in-module offset of the call target plus a multiple of 2</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 6.6pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: super;">20</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">) and indirect calls are placed at all possible call sources. Then, alternatingly, hypercalls are performed and indirect calls are performed through the different possible non-aliasing call sources, with randomized history buffer state that prevents the specialized prediction from working. After this step, there are 2</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 6.6pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: super;">16</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> remaining possibilities for the load address of kvm.ko.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Next, the load address of vmlinux can be determined in a similar way, using an indirect call from vmlinux to kvm.ko. Luckily, none of the bits which are randomized in the load address of vmlinux &nbsp;are folded together, so unlike when locating kvm.ko, the result will directly be unique. vmlinux has an alignment of 2MiB and a randomization range of 1GiB, so there are still only 512 possible addresses.</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Because (as far as we know) a simple hypercall won't actually cause indirect calls from vmlinux to kvm.ko, we instead use port I/O from the status register of an emulated serial port, which is present in the default configuration of a virtual machine created with virt-manager.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">The only remaining piece of information is which one of the 16 aliasing load addresses of kvm.ko is actually correct. Because the source address of an indirect call to kvm.ko is known, this can be solved using bisection: Place code at the various possible targets that, depending on which instance of the code is speculatively executed, loads one of two cache lines, and measure which one of the cache lines gets loaded.</span></div>
<h3 dir="ltr" style="line-height: 1.38; margin-bottom: 4pt; margin-top: 16pt;">
<span style="background-color: transparent; color: #434343; font-family: &quot;arial&quot;; font-size: 13.999999999999998pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Identifying cache sets</span></h3>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">The PoC assumes that the VM does not have access to hugepages.To discover eviction sets for all L3 cache sets with a specific alignment relative to a 4KiB page boundary, the PoC first allocates 25600 pages of memory. Then, in a loop, it selects random subsets of all remaining unsorted pages such that the expected number of sets for which an eviction set is contained in the subset is 1, reduces each subset down to an eviction set by repeatedly accessing its cache lines and testing whether the cache lines are always cached (in which case they're probably not part of an eviction set) and attempts to use the new eviction set to evict all remaining unsorted cache lines to determine whether they are in the same cache set [12].</span></div>
<h3 dir="ltr" style="line-height: 1.38; margin-bottom: 4pt; margin-top: 16pt;">
<span style="background-color: transparent; color: #434343; font-family: &quot;arial&quot;; font-size: 13.999999999999998pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Locating the host-virtual address of a guest page</span></h3>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Because this attack uses a FLUSH+RELOAD approach for leaking data, it needs to know the host-kernel-virtual address of one guest page. Alternative approaches such as PRIME+PROBE should work without that requirement.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">The basic idea for this step of the attack is to use a branch target injection attack against the hypervisor to load an attacker-controlled address and test whether that caused the guest-owned page to be loaded. For this, a gadget that simply loads from the memory location specified by R8 can be used - R8-R11 still contain guest-controlled values when the first indirect call after a guest exit is reached on this kernel build.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">We expected that an attacker would need to either know which eviction set has to be used at this point or brute-force it simultaneously; however, experimentally, using random eviction sets works, too. Our theory is that the observed behavior is actually the result of L1D and L2 evictions, which might be sufficient to permit a few instructions worth of speculative execution.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">The host kernel maps (nearly?) all physical memory in the physmap area, including memory assigned to KVM guests. However, the location of the physmap is randomized (with a 1GiB alignment), in an area of size 128PiB. Therefore, directly bruteforcing the host-virtual address of a guest page would take a long time. It is not necessarily impossible; as a ballpark estimate, it should be possible within a day or so, maybe less, assuming 12000 successful injections per second and 30 guest pages that are tested in parallel; but not as impressive as doing it in a few minutes.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">To optimize this, the problem can be split up: First, brute-force the physical address using a gadget that can load from physical addresses, then brute-force the base address of the physmap region. Because the physical address can usually be assumed to be far below 128PiB, it can be brute-forced more efficiently, and brute-forcing the base address of the physmap region afterwards is also easier because then address guesses with 1GiB alignment can be used.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">To brute-force the physical address, the following gadget can be used:</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">ffffffff810a9def: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4c 89 c0 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov &nbsp;&nbsp;&nbsp;rax,r8</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">ffffffff810a9df2: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4d 63 f9 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;movsxd r15,r9d</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">ffffffff810a9df5: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4e 8b 04 fd c0 b3 a6 &nbsp;&nbsp;&nbsp;mov &nbsp;&nbsp;&nbsp;r8,QWORD PTR [r15*8-0x7e594c40]</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">ffffffff810a9dfc: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;81 </span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">ffffffff810a9dfd: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4a 8d 3c 00 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lea &nbsp;&nbsp;&nbsp;rdi,[rax+r8*1]</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">ffffffff810a9e01: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4d 8b a4 00 f8 00 00 &nbsp;&nbsp;&nbsp;mov &nbsp;&nbsp;&nbsp;r12,QWORD PTR [r8+rax*1+0xf8]</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">ffffffff810a9e08: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;00 </span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">This gadget permits loading an 8-byte-aligned value from the area around the kernel text section by setting R9 appropriately, which in particular permits loading </span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">page_offset_base</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">, the start address of the physmap. Then, the value that was originally in R8 - the physical address guess minus 0xf8 - is added to the result of the previous load, 0xfa is added to it, and the result is dereferenced.</span></div>
<h3 dir="ltr" style="line-height: 1.38; margin-bottom: 4pt; margin-top: 16pt;">
<span style="background-color: transparent; color: #434343; font-family: &quot;arial&quot;; font-size: 13.999999999999998pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Cache set selection</span></h3>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">To select the correct L3 eviction set, the attack from the following section is essentially executed with different eviction sets until it works.</span></div>
<h3 dir="ltr" style="line-height: 1.38; margin-bottom: 4pt; margin-top: 16pt;">
<span style="background-color: transparent; color: #434343; font-family: &quot;arial&quot;; font-size: 13.999999999999998pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Leaking data</span></h3>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">At this point, it would normally be necessary to locate gadgets in the host kernel code that can be used to actually leak data by reading from an attacker-controlled location, shifting and masking the result appropriately and then using the result of that as offset to an attacker-controlled address for a load. But piecing gadgets together and figuring out which ones work in a speculation context seems annoying. So instead, we decided to use the eBPF interpreter, which is built into the host kernel - while there is no legitimate way to invoke it from inside a VM, the presence of the code in the host kernel's text section is sufficient to make it usable for the attack, just like with ordinary ROP gadgets.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">The eBPF interpreter entry point has the following function signature:</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">static unsigned int __bpf_prog_run(void *ctx, const struct bpf_insn *insn)</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">The second parameter is a pointer to an array of statically pre-verified eBPF instructions to be executed - which means that </span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">__bpf_prog_run()</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> will not perform any type checks or bounds checks. The first parameter is simply stored as part of the initial emulated register state, so its value doesn't matter.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">The eBPF interpreter provides, among other things:</span></div>
<br>
<ul style="margin-bottom: 0pt; margin-top: 0pt;">
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">multiple emulated 64-bit registers</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">64-bit immediate writes to emulated registers</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">memory reads from addresses stored in emulated registers</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">bitwise operations (including bit shifts) and arithmetic operations</span></div>
</li>
</ul>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">To call the interpreter entry point, a gadget that gives RSI and RIP control given R8-R11 control and controlled data at a known memory location is necessary. The following gadget provides this functionality:</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">ffffffff81514edd: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4c 89 ce &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov &nbsp;&nbsp;&nbsp;rsi,r9</span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"><br class="kix-line-break"></span><span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 9pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">ffffffff81514ee0: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;41 ff 90 b0 00 00 00 &nbsp;&nbsp;&nbsp;call &nbsp;&nbsp;QWORD PTR [r8+0xb0]</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Now, by pointing R8 and R9 at the mapping of a guest-owned page in the physmap, it is possible to speculatively execute arbitrary unvalidated eBPF bytecode in the host kernel. Then, relatively straightforward bytecode can be used to leak data into the cache.</span></div>
<h1 dir="ltr" style="line-height: 1.38; margin-bottom: 6pt; margin-top: 20pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 20pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Variant 3: Rogue data cache load</span></h1>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Basically, read Anders Fogh's blogpost: </span><a href="https://cyber.wtf/2017/07/28/negative-result-reading-kernel-memory-from-user-mode/" style="text-decoration: none;"><span style="background-color: transparent; color: #1155cc; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: underline; vertical-align: baseline;">https://cyber.wtf/2017/07/28/negative-result-reading-kernel-memory-from-user-mode/</span></a></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">In summary, an attack using this variant of the issue attempts to read kernel memory from userspace without misdirecting the control flow of kernel code. This works by using the code pattern that was used for the previous variants, but in userspace. The underlying idea is that the permission check for accessing an address might not be on the critical path for reading data from memory to a register, where the permission check could have significant performance impact. Instead, the memory read could make the result of the read available to following instructions immediately and only perform the permission check asynchronously, setting a flag in the reorder buffer that causes an exception to be raised if the permission check fails.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">We do have a few additions to make to Anders Fogh's blogpost:</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-left: 36pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">"Imagine the following instruction executed in usermode</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-left: 36pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;courier new&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">mov rax,[somekernelmodeaddress]</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-left: 36pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">It will cause an interrupt when retired, [...]"</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">It is also possible to already execute that instruction behind a high-latency mispredicted branch to avoid taking a page fault. This might also widen the speculation window by increasing the delay between the read from a kernel address and delivery of the associated exception.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-left: 36pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">"First, I call a syscall that touches this memory. Second, I use the prefetcht0 instruction to improve my odds of having the address loaded in L1."</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">When we used prefetch instructions after doing a syscall, the attack stopped working for us, and we have no clue why. Perhaps the CPU somehow stores whether access was denied on the last access and prevents the attack from working if that is the case?</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-left: 36pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">"Fortunately I did not get a slow read suggesting that Intel null’s the result when the access is not allowed."</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">That (read from kernel address returns all-zeroes) seems to happen for memory that is not sufficiently cached but for which pagetable entries are present, at least after repeated read attempts. For unmapped memory, the kernel address read does not return a result at all.</span></div>
<h1 dir="ltr" style="line-height: 1.38; margin-bottom: 6pt; margin-top: 20pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 20pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Ideas for further research</span></h1>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">We believe that our research provides many remaining research topics that we have not yet investigated, and we encourage other public researchers to look into these.</span></div>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">This section contains an even higher amount of speculation than the rest of this blogpost - it contains untested ideas that might well be useless.</span></div>
<h2 dir="ltr" style="line-height: 1.38; margin-bottom: 6pt; margin-top: 18pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 16pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Leaking without data cache timing</span></h2>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">It would be interesting to explore whether there are microarchitectural attacks other than measuring data cache timing that can be used for exfiltrating data out of speculative execution.</span></div>
<h2 dir="ltr" style="line-height: 1.38; margin-bottom: 6pt; margin-top: 18pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 16pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Other microarchitectures</span></h2>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Our research was relatively Haswell-centric so far. It would be interesting to see details e.g. on how the branch prediction of other modern processors works and how well it can be attacked.</span></div>
<h2 dir="ltr" style="line-height: 1.38; margin-bottom: 6pt; margin-top: 18pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 16pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Other JIT engines</span></h2>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">We developed a successful variant 1 attack against the JIT engine built into the Linux kernel. It would be interesting to see whether attacks against more advanced JIT engines with less control over the system are also practical - in particular, JavaScript engines.</span></div>
<h2 dir="ltr" style="line-height: 1.38; margin-bottom: 6pt; margin-top: 18pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 16pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">More efficient scanning for host-virtual addresses and cache sets</span></h2>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">In variant 2, while scanning for the host-virtual address of a guest-owned page, it might make sense to attempt to determine its L3 cache set first. This could be done by performing L3 evictions using an eviction pattern through the physmap, then testing whether the eviction affected the guest-owned page.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">The same might work for cache sets - use an L1D+L2 eviction set to evict the function pointer in the host kernel context, use a gadget in the kernel to evict an L3 set using physical addresses, then use that to identify which cache sets guest lines belong to until a guest-owned eviction set has been constructed.</span></div>
<h2 dir="ltr" style="line-height: 1.38; margin-bottom: 6pt; margin-top: 18pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 16pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Dumping the complete BTB state</span></h2>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Given that the generic BTB seems to only be able to distinguish 2</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 6.6pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: super;">31-8</span><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> or fewer source addresses, it seems feasible to dump out the complete BTB state generated by e.g. a hypercall in a timeframe around the order of a few hours. (Scan for jump sources, then for every discovered jump source, bisect the jump target.) This could potentially be used to identify the locations of functions in the host kernel even if the host kernel is custom-built.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">The source address aliasing would reduce the usefulness somewhat, but because target addresses don't suffer from that, it might be possible to correlate (source,target) pairs from machines with different KASLR offsets and reduce the number of candidate addresses based on KASLR being additive while aliasing is bitwise.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">This could then potentially allow an attacker to make guesses about the host kernel version or the compiler used to build it based on jump offsets or distances between functions.</span></div>
<h2 dir="ltr" style="line-height: 1.38; margin-bottom: 6pt; margin-top: 18pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 16pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Variant 2: Leaking with more efficient gadgets</span></h2>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">If sufficiently efficient gadgets are used for variant 2, it might not be necessary to evict host kernel function pointers from the L3 cache at all; it might be sufficient to only evict them from L1D and L2. </span></div>
<h2 dir="ltr" style="line-height: 1.38; margin-bottom: 6pt; margin-top: 18pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 16pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Various speedups</span></h2>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">In particular the variant 2 PoC is still a bit slow. This is probably partly because:</span></div>
<br>
<ul style="margin-bottom: 0pt; margin-top: 0pt;">
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">It only leaks one bit at a time; leaking more bits at a time should be doable.</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">It heavily uses IRETQ for hiding control flow from the processor.</span></div>
</li>
</ul>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">It would be interesting to see what data leak rate can be achieved using variant 2.</span></div>
<h2 dir="ltr" style="line-height: 1.38; margin-bottom: 6pt; margin-top: 18pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 16pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Leaking or injection through the return predictor</span></h2>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">If the return predictor also doesn't lose its state on a privilege level change, it might be useful for either locating the host kernel from inside a VM (in which case bisection could be used to very quickly discover the full address of the host kernel) or injecting return targets (in particular if the return address is stored in a cache line that can be flushed out by the attacker and isn't reloaded before the return instruction).</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">However, we have not performed any experiments with the return predictor that yielded conclusive results so far.</span></div>
<h2 dir="ltr" style="line-height: 1.38; margin-bottom: 6pt; margin-top: 18pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 16pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Leaking data out of the indirect call predictor</span></h2>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">We have attempted to leak target information out of the indirect call predictor, but haven't been able to make it work.</span></div>
<h1 dir="ltr" style="line-height: 1.38; margin-bottom: 6pt; margin-top: 20pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 20pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Vendor statements</span></h1>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">The following statement were provided to us regarding this issue from the vendors to whom Project Zero disclosed this vulnerability:</span></div>
<h2 dir="ltr" style="line-height: 1.38; margin-bottom: 6pt; margin-top: 18pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 16pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Intel</span></h2>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Intel is committed to improving the overall security of computer systems.  The methods described here rely on common properties of modern microprocessors.  Thus, susceptibility to these methods is not limited to Intel processors, nor does it mean that a processor is working outside its intended functional specification.  Intel is working closely with our ecosystem partners, as well as with other silicon vendors whose processors are affected, to design and distribute both software and hardware mitigations for these methods.<br><br>
For more information and links to useful resources, visit:<br><br>
<a href="https://security-center.intel.com/advisory.aspx?intelid=INTEL-SA-00088&amp;languageid=en-fr">https://security-center.intel.com/advisory.aspx?intelid=INTEL-SA-00088&amp;languageid=en-fr</a><br>
<a href="http://newsroom.intel.com/wp-content/uploads/sites/11/2018/01/Intel-Analysis-of-Speculative-Execution-Side-Channels.pdf">http://newsroom.intel.com/wp-content/uploads/sites/11/2018/01/Intel-Analysis-of-Speculative-Execution-Side-Channels.pdf</a></span></div>
<h2 dir="ltr" style="line-height: 1.38; margin-bottom: 6pt; margin-top: 18pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 16pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">AMD</span></h2>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">AMD provided the following link: <a href="http://www.amd.com/en/corporate/speculative-execution">http://www.amd.com/en/corporate/speculative-execution</a></span></div>
<h2 dir="ltr" style="line-height: 1.38; margin-bottom: 6pt; margin-top: 18pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 16pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">ARM</span></h2>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Arm recognises that the speculation functionality of many modern high-performance processors, despite working as intended, can be used in conjunction with the timing of cache operations to leak some information as described in this blog. Correspondingly, Arm has developed software mitigations that we recommend be deployed.</span></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Specific details regarding the affected processors and mitigations can be found at this website: </span><a href="https://developer.arm.com/support/security-update" style="text-decoration: none;"><span style="background-color: transparent; color: #1155cc; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: underline; vertical-align: baseline;">https://developer.arm.com/support/security-update</span></a></div>
<br>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Arm has included a detailed technical whitepaper as well as links to information from some of Arm’s architecture partners regarding their specific implementations and mitigations.</span></div>
<h1 dir="ltr" style="line-height: 1.38; margin-bottom: 6pt; margin-top: 20pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 20pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Literature</span></h1>
<div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">Note that some of these documents - in particular Intel's documentation - change over time, so quotes from and references to it may not reflect the latest version of Intel's documentation.</span></div>
<br>
<ul style="margin-bottom: 0pt; margin-top: 0pt;">
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<a href="https://www.intel.com/content/dam/www/public/us/en/documents/manuals/64-ia-32-architectures-optimization-manual.pdf" style="text-decoration: none;"><span style="background-color: transparent; color: #1155cc; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: underline; vertical-align: baseline;">https://www.intel.com/content/dam/www/public/us/en/documents/manuals/64-ia-32-architectures-optimization-manual.pdf</span></a><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">: Intel's optimization manual has many interesting pieces of optimization advice that hint at relevant microarchitectural behavior; for example:</span></div>
</li>
<ul style="margin-bottom: 0pt; margin-top: 0pt;">
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: circle; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">"Placing data immediately following an indirect branch can cause a performance problem. If the data consists of all zeros, it looks like a long stream of ADDs to memory destinations and this can cause resource conflicts and slow down branch recovery. Also, data immediately following indirect branches may appear as branches to the branch predication [sic] hardware, which can branch off to execute other data pages. This can lead to subsequent self-modifying code problems."</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: circle; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">"Loads can:[...]Be carried out speculatively, before preceding branches are resolved."</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: circle; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">"Software should avoid writing to a code page in the same 1-KByte subpage that is being executed or fetching code in the same 2-KByte subpage of that is being written. In addition, sharing a page containing directly or speculatively executed code with another processor as a data page can trigger an SMC condition that causes the entire pipeline of the machine and the trace cache to be cleared. This is due to the self-modifying code condition."</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: circle; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">"if mapped as WB or WT, there is a potential for speculative processor reads to bring the data into the caches"</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: circle; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">"Failure to map the region as WC may allow the line to be speculatively read into the processor caches (via the wrong path of a mispredicted branch)."</span></div>
</li>
</ul>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<a href="https://software.intel.com/en-us/articles/intel-sdm" style="text-decoration: none;"><span style="background-color: transparent; color: #1155cc; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: underline; vertical-align: baseline;">https://software.intel.com/en-us/articles/intel-sdm</span></a><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">: Intel's Software Developer Manuals</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<a href="http://www.agner.org/optimize/microarchitecture.pdf" style="text-decoration: none;"><span style="background-color: transparent; color: #1155cc; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: underline; vertical-align: baseline;">http://www.agner.org/optimize/microarchitecture.pdf</span></a><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">: Agner Fog's documentation of reverse-engineered processor behavior and relevant theory was very helpful for this research.</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<a href="http://www.cs.binghamton.edu/~dima/micro16.pdf" style="text-decoration: none;"><span style="background-color: transparent; color: #1155cc; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: underline; vertical-align: baseline;">http://www.cs.binghamton.edu/~dima/micro16.pdf</span></a><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;"> and </span><a href="https://github.com/felixwilhelm/mario_baslr" style="text-decoration: none;"><span style="background-color: transparent; color: #1155cc; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: underline; vertical-align: baseline;">https://github.com/felixwilhelm/mario_baslr</span></a><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">: Prior research by Dmitry Evtyushkin, Dmitry Ponomarev and Nael Abu-Ghazaleh on abusing branch target buffer behavior to leak addresses that we used as a starting point for analyzing the branch prediction of Haswell processors. Felix Wilhelm's research based on this provided the basic idea behind variant 2.</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<a href="https://arxiv.org/pdf/1507.06955.pdf" style="text-decoration: none;"><span style="background-color: transparent; color: #1155cc; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: underline; vertical-align: baseline;">https://arxiv.org/pdf/1507.06955.pdf</span></a><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">: The rowhammer.js research by Daniel Gruss, Clémentine Maurice and Stefan Mangard contains information about L3 cache eviction patterns that we reused in the KVM PoC to evict a function pointer.</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<a href="https://xania.org/201602/bpu-part-one" style="text-decoration: none;"><span style="background-color: transparent; color: #1155cc; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: underline; vertical-align: baseline;">https://xania.org/201602/bpu-part-one</span></a><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">: Matt Godbolt blogged about reverse-engineering the structure of the branch predictor on Intel processors.</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<a href="https://www.sophia.re/thesis.pdf" style="text-decoration: none;"><span style="background-color: transparent; color: #1155cc; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: underline; vertical-align: baseline;">https://www.sophia.re/thesis.pdf</span></a><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">: Sophia D'Antoine wrote a thesis that shows that opcode scheduling can theoretically be used to transmit data between hyperthreads.</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<a href="https://gruss.cc/files/kaiser.pdf" style="text-decoration: none;"><span style="background-color: transparent; color: #1155cc; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: underline; vertical-align: baseline;">https://gruss.cc/files/kaiser.pdf</span></a><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">: Daniel Gruss, Moritz Lipp, Michael Schwarz, Richard Fellner, Clémentine Maurice, and Stefan Mangard wrote a paper on mitigating microarchitectural issues caused by pagetable sharing between userspace and the kernel.</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<a href="https://www.jilp.org/" style="text-decoration: none;"><span style="background-color: transparent; color: #1155cc; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: underline; vertical-align: baseline;">https://www.jilp.org/</span></a><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">: This journal contains many articles on branch prediction.</span></div>
</li>
<li dir="ltr" style="background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; text-decoration: none; vertical-align: baseline;"><div dir="ltr" style="line-height: 1.38; margin-bottom: 0pt; margin-top: 0pt;">
<a href="http://blog.stuffedcow.net/2013/01/ivb-cache-replacement/" style="text-decoration: none;"><span style="background-color: transparent; color: #1155cc; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: underline; vertical-align: baseline;">http://blog.stuffedcow.net/2013/01/ivb-cache-replacement/</span></a><span style="background-color: transparent; color: black; font-family: &quot;arial&quot;; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline;">: This blogpost by Henry Wong investigates the L3 cache replacement policy used by Intel's Ivy Bridge architecture.</span></div>
</li>
</ul>
<div>
<h1 dir="ltr" style="line-height: 1.38; margin-bottom: 6pt; margin-top: 20pt;">
<span style="font-family: &quot;arial&quot;; font-size: 20pt; font-weight: 400; vertical-align: baseline; ">References</span></h1>
</div>
<div>
<span style="font-family: &quot;arial&quot;; font-size: 14.6667px; ">[1] </span><span style="font-family: &quot;arial&quot;; font-size: 10pt; vertical-align: baseline; ">This initial report did not contain any information about variant 3. We had discussed whether direct reads from kernel memory could work, but thought that it was unlikely. We later tested and reported variant 3 prior to the publication of Anders Fogh's work at </span><a href="https://cyber.wtf/2017/07/28/negative-result-reading-kernel-memory-from-user-mode/" style="text-decoration-line: none;"><span style="color: #1155cc; font-family: &quot;arial&quot;; font-size: 11pt; vertical-align: baseline; ">https://cyber.wtf/2017/07/28/negative-result-reading-kernel-memory-from-user-mode/</span></a><span style="font-family: &quot;arial&quot;; font-size: 10pt; vertical-align: baseline; ">.</span></div>
<div>
<span style="font-family: &quot;arial&quot;; font-size: 14.6667px; ">[2] </span><span style="font-family: &quot;arial&quot;; font-size: 10pt; ">The precise model names are listed in the section "Tested Processors". The code for reproducing this is in the writeup_files.tar archive in our bugtracker, in the folders userland_test_x86 and userland_test_aarch64.</span></div>
<div>
<span style="font-family: &quot;arial&quot;; font-size: 14.6667px; ">[3] </span><span style="font-family: &quot;arial&quot;; font-size: 10pt; ">The attacker-controlled offset used to perform an out-of-bounds access on an array by this PoC is a 32-bit value, limiting the accessible addresses to a 4GiB window in the kernel heap area.</span></div>
<div>
<span style="font-family: &quot;arial&quot;; font-size: 14.6667px; ">[4] </span><span style="font-family: &quot;arial&quot;; font-size: 10pt; ">This PoC won't work on CPUs with SMAP support; however, that is not a fundamental limitation.</span></div>
<div>
<span style="font-family: &quot;arial&quot;; font-size: 14.6667px; ">[5] </span><span style="font-family: &quot;arial&quot;; font-size: 10pt; vertical-align: baseline; ">linux-image-4.9.0-3-amd64 at version 4.9.30-2+deb9u2 (available at </span><a href="http://snapshot.debian.org/archive/debian/20170701T224614Z/pool/main/l/linux/linux-image-4.9.0-3-amd64_4.9.30-2%2Bdeb9u2_amd64.deb" style="text-decoration-line: none;"><span style="color: #1155cc; font-family: &quot;arial&quot;; font-size: 10pt; vertical-align: baseline; ">http://snapshot.debian.org/archive/debian/20170701T224614Z/pool/main/l/linux/linux-image-4.9.0-3-amd64_4.9.30-2%2Bdeb9u2_amd64.deb</span></a><span style="font-family: &quot;arial&quot;; font-size: 10pt; vertical-align: baseline; ">, sha256 5f950b26aa7746d75ecb8508cc7dab19b3381c9451ee044cd2edfd6f5efff1f8, signed via </span><a href="http://snapshot.debian.org/archive/debian-security/20170701T114538Z/dists/stretch/updates/Release.gpg" style="text-decoration-line: none;"><span style="color: #1155cc; font-family: &quot;arial&quot;; font-size: 10pt; vertical-align: baseline; ">Release.gpg</span></a><span style="font-family: &quot;arial&quot;; font-size: 10pt; vertical-align: baseline; ">, </span><a href="http://snapshot.debian.org/archive/debian-security/20170701T114538Z/dists/stretch/updates/Release" style="text-decoration-line: none;"><span style="color: #1155cc; font-family: &quot;arial&quot;; font-size: 10pt; vertical-align: baseline; ">Release</span></a><span style="font-family: &quot;arial&quot;; font-size: 10pt; vertical-align: baseline; ">, </span><a href="http://snapshot.debian.org/archive/debian-security/20170701T114538Z/dists/stretch/updates/main/binary-amd64/Packages.xz" style="text-decoration-line: none;"><span style="color: #1155cc; font-family: &quot;arial&quot;; font-size: 10pt; vertical-align: baseline; ">Packages.xz</span></a><span style="font-family: &quot;arial&quot;; font-size: 10pt; vertical-align: baseline; ">); that was the current distro kernel version when I set up the machine. It is very unlikely that the PoC works with other kernel versions without changes; it contains a number of hardcoded addresses/offsets.</span></div>
<div>
<span style="font-family: &quot;arial&quot;; font-size: 14.6667px; ">[6] </span><span style="font-family: &quot;arial&quot;; font-size: 10pt; ">The phone was running an Android build from May 2017.</span></div>
<div>
<span style="font-family: &quot;arial&quot;; font-size: 14.6667px; ">[7] </span><a href="https://software.intel.com/en-us/articles/intel-sdm" style="text-decoration-line: none;"><span style="color: #1155cc; font-family: &quot;arial&quot;; font-size: 10pt; vertical-align: baseline; ">https://software.intel.com/en-us/articles/intel-sdm</span></a></div>
<div>
<span style="font-family: &quot;arial&quot;; font-size: 14.6667px; ">[8] </span><a href="https://software.intel.com/en-us/articles/avoiding-and-identifying-false-sharing-among-threads" style="text-decoration-line: none;"><span style="color: #1155cc; font-family: &quot;arial&quot;; font-size: 10pt; vertical-align: baseline; ">https://software.intel.com/en-us/articles/avoiding-and-identifying-false-sharing-among-threads</span></a><span style="font-family: &quot;arial&quot;; font-size: 10pt; vertical-align: baseline; ">, section "background"</span></div>
<div>
<span style="font-family: &quot;arial&quot;; font-size: 14.6667px; ">[9] </span><span style="font-family: &quot;arial&quot;; font-size: 10pt; vertical-align: baseline; ">More than 2</span><span style="font-family: &quot;arial&quot;; font-size: 6pt; vertical-align: super; ">15</span><span style="font-family: &quot;arial&quot;; font-size: 10pt; vertical-align: baseline; "> mappings would be more efficient, but the kernel places a hard cap of 2</span><span style="font-family: &quot;arial&quot;; font-size: 6pt; vertical-align: super; ">16</span><span style="font-family: &quot;arial&quot;; font-size: 6pt; vertical-align: sub; "> </span><span style="font-family: &quot;arial&quot;; font-size: 10pt; vertical-align: baseline; ">on the number of VMAs that a process can have.</span></div>
<div>
<span style="font-family: &quot;arial&quot;; font-size: 14.6667px; ">[10] </span><span style="font-family: &quot;arial&quot;; font-size: 10pt; ">Intel's optimization manual states that "In the first implementation of HT Technology, the physical execution resources are shared and the architecture state is duplicated for each logical processor", so it would be plausible for predictor state to be shared. While predictor state could be tagged by logical core, that would likely reduce performance for multithreaded processes, so it doesn't seem likely.</span></div>
<div>
<span style="font-family: &quot;arial&quot;; font-size: 14.6667px; ">[11] </span><span style="font-family: &quot;arial&quot;; font-size: 10pt; ">In case the history buffer was a bit bigger than we had measured, we added some margin - in particular because we had seen slightly different history buffer lengths in different experiments, and because 26 isn't a very round number.</span></div>
<div>
<span style="font-family: &quot;arial&quot;; font-size: 14.6667px; ">[12] </span><span style="font-family: &quot;arial&quot;; font-size: 10pt; vertical-align: baseline; ">The basic idea comes from </span><a href="http://palms.ee.princeton.edu/system/files/SP_vfinal.pdf" style="text-decoration-line: none;"><span style="color: #1155cc; font-family: &quot;arial&quot;; font-size: 10pt; vertical-align: baseline; ">http://palms.ee.princeton.edu/system/files/SP_vfinal.pdf</span></a><span style="font-family: &quot;arial&quot;; font-size: 10pt; vertical-align: baseline; ">, section IV, although the authors of that paper still used hugepages.</span></div>
<div>
<span style="font-family: &quot;arial&quot;; font-size: 14.6667px; "><br></span></div>
<div style="clear: both;"></div>
</div>
<div class="post-footer">
<div class="post-footer-line post-footer-line-1">
<span class="post-author vcard">
Posted by
<span class="fn" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person">
<meta content="https://www.blogger.com/profile/15940768551906668205" itemprop="url">
<a class="g-profile" href="https://www.blogger.com/profile/15940768551906668205" rel="author" title="author profile" data-gapiscan="true" data-onload="true" data-gapiattached="true">
<span itemprop="name">Ben</span>
</a>
</span>
</span>
<span class="post-timestamp">
at
<meta content="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html" itemprop="url">
<a class="timestamp-link" href="https://googleprojectzero.blogspot.ca/2018/01/reading-privileged-memory-with-side.html" rel="bookmark" title="permanent link"><abbr class="published" itemprop="datePublished" title="2018-01-03T14:27:00-08:00">2:27 PM</abbr></a>
</span>
<span class="reaction-buttons">
</span>
<span class="post-comment-link">
</span>
<span class="post-backlinks post-comment-link">
</span>
<span class="post-icons">
<span class="item-control blog-admin pid-612473818">
<a href="https://www.blogger.com/post-edit.g?blogID=4838136820032157985&amp;postID=6227737444967092885&amp;from=pencil" title="Edit Post">
<img alt="" class="icon-action" height="18" src="./Project Zero_ Reading privileged memory with a side-channel_files/icon18_edit_allbkg.gif" width="18">
</a>
</span>
</span>
<div class="post-share-buttons goog-inline-block">
<a class="goog-inline-block share-button sb-email" href="https://www.blogger.com/share-post.g?blogID=4838136820032157985&amp;postID=6227737444967092885&amp;target=email" target="_blank" title="Email This"><span class="share-button-link-text">Email This</span></a><a class="goog-inline-block share-button sb-blog" href="https://www.blogger.com/share-post.g?blogID=4838136820032157985&amp;postID=6227737444967092885&amp;target=blog" onclick="window.open(this.href, &quot;_blank&quot;, &quot;height=270,width=475&quot;); return false;" target="_blank" title="BlogThis!"><span class="share-button-link-text">BlogThis!</span></a><a class="goog-inline-block share-button sb-twitter" href="https://www.blogger.com/share-post.g?blogID=4838136820032157985&amp;postID=6227737444967092885&amp;target=twitter" target="_blank" title="Share to Twitter"><span class="share-button-link-text">Share to Twitter</span></a><a class="goog-inline-block share-button sb-facebook" href="https://www.blogger.com/share-post.g?blogID=4838136820032157985&amp;postID=6227737444967092885&amp;target=facebook" onclick="window.open(this.href, &quot;_blank&quot;, &quot;height=430,width=640&quot;); return false;" target="_blank" title="Share to Facebook"><span class="share-button-link-text">Share to Facebook</span></a><a class="goog-inline-block share-button sb-pinterest" href="https://www.blogger.com/share-post.g?blogID=4838136820032157985&amp;postID=6227737444967092885&amp;target=pinterest" target="_blank" title="Share to Pinterest"><span class="share-button-link-text">Share to Pinterest</span></a><div class="goog-inline-block google-plus-share-container"><div id="___plusone_0" style="text-indent: 0px; margin: 0px; padding: 0px; background: transparent; border-style: none; float: none; line-height: normal; font-size: 1px; vertical-align: baseline; display: inline-block; width: 32px; height: 20px;"><iframe ng-non-bindable="" frameborder="0" hspace="0" marginheight="0" marginwidth="0" scrolling="no" style="position: static; top: 0px; width: 32px; margin: 0px; border-style: none; left: 0px; visibility: visible; height: 20px;" tabindex="0" vspace="0" width="100%" id="I0_1518479098240" name="I0_1518479098240" src="./Project Zero_ Reading privileged memory with a side-channel_files/fastbutton.html" data-gapiattached="true" title="G+"></iframe></div></div>
</div>
</div>
<div class="post-footer-line post-footer-line-2">
<span class="post-labels">
</span>
</div>
<div class="post-footer-line post-footer-line-3">
<span class="post-location">
</span>
</div>
</div>
</div>
<div class="comments" id="comments">
<a name="comments"></a>
<h4>120 comments:</h4>
<div class="comments-content">
<script async="async" src="./Project Zero_ Reading privileged memory with a side-channel_files/comments.js" type="text/javascript"></script>
<script type="text/javascript">
    (function() {
      var items = [{'id': '7320179167879533204', 'body': 'So reading this: Both Intel and AMD have the \x26quot;bug\x26quot;, but in real life only Intel are vulnerable.', 'timestamp': '1515020248664', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515020248664#c7320179167879533204', 'author': {'name': 'Jamne Jansson', 'avatarUrl': '//lh4.googleusercontent.com/-zbKcihsg3do/AAAAAAAAAAI/AAAAAAAAAHI/vMVEo2fLdVM/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/01391704675814654904'}, 'displayTime': 'January 3, 2018 at 2:57 PM', 'deleteclass': 'item-control blog-admin pid-2000217853'}, {'id': '7053426628276274147', 'body': 'Link to ARM security-update doesn\x26#39;t work as of 22:58 GMT on 3 January 2017', 'timestamp': '1515020320052', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515020320052#c7053426628276274147', 'author': {'name': 'John', 'avatarUrl': '//3.bp.blogspot.com/_lOUFos1-Pis/Sau81TZsm3I/AAAAAAAAAIU/huUI3Rr6WjQ/S45-s35/hat.jpg', 'profileUrl': 'https://www.blogger.com/profile/03083217667667590668'}, 'displayTime': 'January 3, 2018 at 2:58 PM', 'deleteclass': 'item-control blog-admin pid-1351088499'}, {'id': '1801913178267003427', 'body': 'So any words on more recent architectures?\x3cbr /\x3eAMD Zen and Intel Skylake and newer?', 'timestamp': '1515020793329', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515020793329#c1801913178267003427', 'author': {'name': 'DooMMasteR', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/17260981663417323134'}, 'displayTime': 'January 3, 2018 at 3:06 PM', 'deleteclass': 'item-control blog-admin pid-1619808291'}, {'id': '6798580981063708240', 'body': 'oh.', 'timestamp': '1515021299241', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515021299241#c6798580981063708240', 'author': {'name': 'Krzysztof Bryk', 'avatarUrl': '//lh5.googleusercontent.com/-b1UFEYpmk-I/AAAAAAAAAAI/AAAAAAAAxgQ/p3Uft4O5zB4/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/12197467608127062719'}, 'displayTime': 'January 3, 2018 at 3:14 PM', 'deleteclass': 'item-control blog-admin pid-1675402947'}, {'id': '3918825633173428964', 'body': 'So for AMD, this appears to only impact Linux and FreeBSD users using an \x26quot;APU\x26quot; who\x26#39;ve manually turned on the BPF JIT. Considering I had no clue this thing existed until now, I\x26#39;m going to guess this impacts all of 3 users.\x3cbr /\x3e\x3cbr /\x3ehttps://www.kernel.org/doc/Documentation/networking/filter.txt', 'timestamp': '1515021584343', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515021584343#c3918825633173428964', 'author': {'name': 'Artificial Wisdom', 'avatarUrl': '//3.bp.blogspot.com/_7vI01mpK-ro/SllV4AzTnmI/AAAAAAAAACo/lFN1-bpK-Is/S45-s35/newhope.jpg', 'profileUrl': 'https://www.blogger.com/profile/06596383987021017812'}, 'displayTime': 'January 3, 2018 at 3:19 PM', 'deleteclass': 'item-control blog-admin pid-2105994189'}, {'id': '6150327868575011561', 'parentId': '7320179167879533204', 'body': 'It looks like there are two different bugs and Intel is vulnerable to the one that is easiest to trigger.', 'timestamp': '1515022432027', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515022432027#c6150327868575011561', 'author': {'name': 'Andy Glover', 'avatarUrl': '//lh4.googleusercontent.com/-2hMsL037vec/AAAAAAAAAAI/AAAAAAAAJ7g/6_9k-fvpeVQ/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/12182391899777527943'}, 'displayTime': 'January 3, 2018 at 3:33 PM', 'deleteclass': 'item-control blog-admin pid-1340182275'}, {'id': '3360087956790821251', 'parentId': '7320179167879533204', 'body': 'Yes, and probably more bugs, but the Intel one is a bad one', 'timestamp': '1515023033033', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515023033033#c3360087956790821251', 'author': {'name': 'Jamne Jansson', 'avatarUrl': '//lh4.googleusercontent.com/-zbKcihsg3do/AAAAAAAAAAI/AAAAAAAAAHI/vMVEo2fLdVM/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/01391704675814654904'}, 'displayTime': 'January 3, 2018 at 3:43 PM', 'deleteclass': 'item-control blog-admin pid-2000217853'}, {'id': '138089837026034169', 'body': 'Yeah find it strange why amd is being singled out, when they are least affected in this, and not at all affected for meltdown, which is what all the performance hitting patches are for.\x3cbr /\x3e\x3cbr /\x3e(Not running amd cpus, but let&#8217;s be fair here)', 'timestamp': '1515023805393', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515023805393#c138089837026034169', 'author': {'name': 'Michael J', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/08146626034371688354'}, 'displayTime': 'January 3, 2018 at 3:56 PM', 'deleteclass': 'item-control blog-admin pid-137350061'}, {'id': '8572111276098465261', 'body': 'I see a lot of mentioning of Linux. Does OpenBSD handle the situation any better?', 'timestamp': '1515023906130', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515023906130#c8572111276098465261', 'author': {'name': 'Acex222', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/01161173717009806663'}, 'displayTime': 'January 3, 2018 at 3:58 PM', 'deleteclass': 'item-control blog-admin pid-122658402'}, {'id': '8452690805298033582', 'parentId': '3918825633173428964', 'body': 'FreeBSD is not impacted at all. At least for now.', 'timestamp': '1515024025028', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515024025028#c8452690805298033582', 'author': {'name': 'Equand', 'avatarUrl': '//lh5.googleusercontent.com/-cWKhUFQQPqE/AAAAAAAAAAI/AAAAAAAAABg/3KAaWRr_0SU/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/05364165160252633013'}, 'displayTime': 'January 3, 2018 at 4:00 PM', 'deleteclass': 'item-control blog-admin pid-1468700980'}, {'id': '5796706728859614654', 'body': 'Would be nice to see some performance metrics out of the google datacenters with KPTI on/off..\x3cbr /\x3eIMHO this could be a big problem for Intel, as enterprise customers will demand compensation from them.', 'timestamp': '1515030330865', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515030330865#c5796706728859614654', 'author': {'name': 'Spacefish', 'avatarUrl': '//4.bp.blogspot.com/_ehXQl3thZlo/S1-BZjtQ8xI/AAAAAAAAA9Y/JML4upOBckg/S45-s35/545218_aaafecb7.jpg', 'profileUrl': 'https://www.blogger.com/profile/13586568359146195305'}, 'displayTime': 'January 3, 2018 at 5:45 PM', 'deleteclass': 'item-control blog-admin pid-2133437392'}, {'id': '3250872953343552729', 'body': 'I\x26#39;m glad to see that Project Zero is willing to extend their 90-day deadline when the defect owners need extra time.', 'timestamp': '1515030388586', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515030388586#c3250872953343552729', 'author': {'name': 'Bruce', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/13886296585847560301'}, 'displayTime': 'January 3, 2018 at 5:46 PM', 'deleteclass': 'item-control blog-admin pid-825317995'}, {'id': '3702023949938729150', 'body': 'That AMD \x26quot;is vulnerable\x26quot; should NOT be believed for a single solitary nanosecond without empirical evidence of exploitation on AMD platforms. I could be wrong, but this WREAKS of Intel damage-control. That is to say, the \x26quot;AMD is exploitable\x26quot; line _may_ be an attempt to exploit human psychology in order to mitigate consumer-flight from Intel CPU\x26#39;s toward AMD\x26#39;s offering.... \x3cbr /\x3e\x3cbr /\x3eUpon reading about the Intel bug and how AMD was not vulnerable (at first), the involuntary thought that immediately entered my own mind was \x26quot;my next CPU is gonna be AMD. period.\x26quot; So what I\x26#39;m saying is that in order to curb this rational impulse in consumers (given the severity of the bug), there MAY be a \x26quot;push\x26quot; to vilify AMD\x26#39;s chips to instill the feeling of \x26quot;oh well, if they both have serious bugs, I may as well stay with what I\x26#39;m using on my next purchase\x26quot;.', 'timestamp': '1515034042369', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515034042369#c3702023949938729150', 'author': {'name': 'c4p0ne', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/03935495190007473747'}, 'displayTime': 'January 3, 2018 at 6:47 PM', 'deleteclass': 'item-control blog-admin pid-1803158265'}, {'id': '6720752231412209557', 'parentId': '3918825633173428964', 'body': 'Please elaborate more with technical details about your claim that freebsd is not impacted ', 'timestamp': '1515034734045', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515034734045#c6720752231412209557', 'author': {'name': 'Alireza Haghdoost', 'avatarUrl': '//4.bp.blogspot.com/_4CpQ2WUYR8Q/SauhyVnNpxI/AAAAAAAAAdk/jTrHlH0V5Hg/S45-s35/ARH.jpg', 'profileUrl': 'https://www.blogger.com/profile/11019963008669563400'}, 'displayTime': 'January 3, 2018 at 6:58 PM', 'deleteclass': 'item-control blog-admin pid-1542024210'}, {'id': '6047260701494662094', 'parentId': '3918825633173428964', 'body': 'Nope see: https://lists.freebsd.org/pipermail/freebsd-security/2018-January/009651.html', 'timestamp': '1515035418162', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515035418162#c6047260701494662094', 'author': {'name': 'sebastian.alexander.schmidt', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/17671063747952328513'}, 'displayTime': 'January 3, 2018 at 7:10 PM', 'deleteclass': 'item-control blog-admin pid-373089245'}, {'id': '2177968161024038054', 'body': 'That\x26#39;s horrible! What does this mean for ordinary users?', 'timestamp': '1515046769709', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515046769709#c2177968161024038054', 'author': {'name': 'Unknown', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/05782220189881739573'}, 'displayTime': 'January 3, 2018 at 10:19 PM', 'deleteclass': 'item-control blog-admin pid-161566169'}, {'id': '4621809964577030989', 'parentId': '3702023949938729150', 'body': 'Well, might be a valid assumption considering this: https://lkml.org/lkml/2017/12/27/2\x3cbr /\x3e\x3cbr /\x3eMore info in the comments over there: \x3cbr /\x3ehttps://news.ycombinator.com/item?id\x3d16046636', 'timestamp': '1515053248780', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515053248780#c4621809964577030989', 'author': {'name': 'Akaino', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/09446608163075760165'}, 'displayTime': 'January 4, 2018 at 12:07 AM', 'deleteclass': 'item-control blog-admin pid-1071630044'}, {'id': '7368798239603477851', 'parentId': '1801913178267003427', 'body': 'skylake to', 'timestamp': '1515057457081', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515057457081#c7368798239603477851', 'author': {'name': 'Unknown', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/03523240299024754363'}, 'displayTime': 'January 4, 2018 at 1:17 AM', 'deleteclass': 'item-control blog-admin pid-900526364'}, {'id': '4732464982590111109', 'parentId': '1801913178267003427', 'body': 'skylake and newer to', 'timestamp': '1515057593901', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515057593901#c4732464982590111109', 'author': {'name': 'win dows', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/03523240299024754363'}, 'displayTime': 'January 4, 2018 at 1:19 AM', 'deleteclass': 'item-control blog-admin pid-900526364'}, {'id': '3922612046928760190', 'body': 'I said to myself \x26quot;my next CPU is gonna be AMD\x26quot; after Intel Hyper-threading trick.', 'timestamp': '1515057659518', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515057659518#c3922612046928760190', 'author': {'name': 'SeventhSon Sidorov', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/09395929012624525246'}, 'displayTime': 'January 4, 2018 at 1:20 AM', 'deleteclass': 'item-control blog-admin pid-1358838285'}, {'id': '6924474143171565069', 'parentId': '3702023949938729150', 'body': '\x26quot;For a few Intel and AMD CPU models, we have exploits that work against real software.\x26quot;\x3cbr /\x3eWhat precisely is hard to comprehend in this sentence?', 'timestamp': '1515058806011', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515058806011#c6924474143171565069', 'author': {'name': 'Denys Rtveliashvili', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/00204394471970362232'}, 'displayTime': 'January 4, 2018 at 1:40 AM', 'deleteclass': 'item-control blog-admin pid-1337699363'}, {'id': '7428743444650004834', 'parentId': '5796706728859614654', 'body': 'Even though it is not by Google, Phoronix did some performance testing with server and end user workload: https://www.phoronix.com/scan.php?page\x3darticle\x26amp;item\x3dlinux-kpti-kvm\x26amp;num\x3d1', 'timestamp': '1515059002804', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515059002804#c7428743444650004834', 'author': {'name': 'Hibiki Taisuna', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/02514096425944070168'}, 'displayTime': 'January 4, 2018 at 1:43 AM', 'deleteclass': 'item-control blog-admin pid-1772399751'}, {'id': '6284377492295164961', 'parentId': '3702023949938729150', 'body': 'I could exploit Spectre with the code example in the white paper on AMD.', 'timestamp': '1515059126829', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515059126829#c6284377492295164961', 'author': {'name': 'Hibiki Taisuna', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/02514096425944070168'}, 'displayTime': 'January 4, 2018 at 1:45 AM', 'deleteclass': 'item-control blog-admin pid-1772399751'}, {'id': '2838877153992131097', 'body': '\x26quot;this rational impulse\x26quot; \x3d\x26gt; this irrational impulse\x3cbr /\x3eWe\x26#39;re talking about a single flaw. Deciding to switch from an anecdotical fact is not rational (without more data suggesting the alternative is better) !', 'timestamp': '1515060507204', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515060507204#c2838877153992131097', 'author': {'name': 'Colin Pitrat', 'avatarUrl': '//lh6.googleusercontent.com/-wORijD5gmBA/AAAAAAAAAAI/AAAAAAAABrk/em6eCmA6oqA/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/00395815280566122938'}, 'displayTime': 'January 4, 2018 at 2:08 AM', 'deleteclass': 'item-control blog-admin pid-1625765668'}, {'id': '6265843783786115850', 'parentId': '3250872953343552729', 'body': 'They always said: \x26quot;As always, we reserve the right to bring deadlines forwards or backwards based on extreme circumstances. \x26quot;\x3cbr /\x3e\x3cbr /\x3eI suspect three affected hardware vendors and nearly every OS vendors, it probably took them most of this time to notify everyone who needed to know.', 'timestamp': '1515061339012', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515061339012#c6265843783786115850', 'author': {'name': 'Simon Waters', 'avatarUrl': '//lh3.googleusercontent.com/-JxWU__xXFkQ/AAAAAAAAAAI/AAAAAAAAACM/RiCY70Cpa-Y/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/07744590058377481669'}, 'displayTime': 'January 4, 2018 at 2:22 AM', 'deleteclass': 'item-control blog-admin pid-845020604'}, {'id': '8207466094648191610', 'body': 'From reading GPZ, Spectre, Meltdown and Fogh, it appears that the side-execution attacks are possible on all modern CPUs, but have only been successfully exploited on Intel chips, quite possibly because of the designs they use which make them the most performant. AMD and ARM are harder to exploit because they lack the hardware which in part gives Intel its performance edge.\x3cbr /\x3e\x3cbr /\x3eSome of the attacks appear exploitable through JavaScript loadable through a webpage in Chrome. It\x26#39;s probably possible through Firefox, Edge, and Safari too. It could read out your passwords. That\x26#39;s pretty devastating.\x3cbr /\x3e\x3cbr /\x3eSome also allow containerised software access to all the other containers on a physical host, including those on cloud infrastructure. Again, pretty devastating. Google say that have mitigated that threat on their infrastructure (I wonder how?); have others?\x3cbr /\x3e\x3cbr /\x3eI note that the research exposing these attacks was in large part funded by the EU!', 'timestamp': '1515063560938', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515063560938#c8207466094648191610', 'author': {'name': 'Dan G', 'avatarUrl': '//4.bp.blogspot.com/_7eSuPgLpzOg/SaqiZ_eQN6I/AAAAAAAAB38/FaY30zjOe_c/S45-s35/desk.jpg', 'profileUrl': 'https://www.blogger.com/profile/05110042278054177075'}, 'displayTime': 'January 4, 2018 at 2:59 AM', 'deleteclass': 'item-control blog-admin pid-454150743'}, {'id': '5904482337926457589', 'body': 'Well, I&#8217;m glad you understand it. I think I shall have to wait for the idiot&#8217;s patch!', 'timestamp': '1515067133779', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515067133779#c5904482337926457589', 'author': {'name': 'Sadies', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/16626321724759680659'}, 'displayTime': 'January 4, 2018 at 3:58 AM', 'deleteclass': 'item-control blog-admin pid-1710541185'}, {'id': '1415836744640630389', 'parentId': '3918825633173428964', 'body': '\x26quot;The FreeBSD Security Team recently learned of the details of these\x3cbr /\x3eissues that affect certain CPUs. Details could not be discussed\x3cbr /\x3epublicly, but mitigation work is in progress.\x3cbr /\x3e\x3cbr /\x3eWork is ongoing to develop and commit these mitigations to the FreeBSD\x26quot;\x3cbr /\x3e\x3cbr /\x3eSo, if FreeBSD is not impacted, why are they doing mitigation work and applying patches? \x3cbr /\x3eWhat you claim, doesn\x26#39;t seem to make any sense according to their statement? \x3cbr /\x3e', 'timestamp': '1515069970279', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515069970279#c1415836744640630389', 'author': {'name': 'Chris Sprucefield', 'avatarUrl': '//lh3.googleusercontent.com/-2k2nOTmOAeU/AAAAAAAAAAI/AAAAAAAAAAA/4ZImuHwBqW4/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/07900132592901750926'}, 'displayTime': 'January 4, 2018 at 4:46 AM', 'deleteclass': 'item-control blog-admin pid-1290045314'}, {'id': '5003941761442481900', 'parentId': '5796706728859614654', 'body': 'Never mind the future goodwill and trust impact on this one. \x3cbr /\x3eThe Pentium calculus bug was pretty bad for them, but this makes everything else pale in comparison, and if the performance losses are as big as an average of 20%, then someone will demand quite some comp for that. \x3cbr /\x3e\x3cbr /\x3eThe spectre vulnerability seems to be more of a generic one, while bad, not as easy to actually do on a generic system where you don\x26#39;t know the current setup.\x3cbr /\x3e\x3cbr /\x3eAs for mitigating that one, it looks like you may have to make cache lines private to the process, rather than a shared general global space.', 'timestamp': '1515070283565', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515070283565#c5003941761442481900', 'author': {'name': 'Chris Sprucefield', 'avatarUrl': '//lh3.googleusercontent.com/-2k2nOTmOAeU/AAAAAAAAAAI/AAAAAAAAAAA/4ZImuHwBqW4/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/07900132592901750926'}, 'displayTime': 'January 4, 2018 at 4:51 AM', 'deleteclass': 'item-control blog-admin pid-1290045314'}, {'id': '1107761947744486687', 'body': 'I think the general claim is that even if AMD is not vulnerable to the specific attacks identified so far, their architecture implements similar features that may well be subject to similar exploits in future. So swapping Intel CPUs for AMD ones *today* would indeed reduce your vulnerability, but switching to an AMD processor *next year* would not. On the one hand, the Intel-specific attack will have been mitigated in software in the meantime; and on the other, an AMD-specific attack may be discovered later.\x3cbr /\x3e\x3cbr /\x3eThe only reason to switch to AMD in the long term would be if they could demonstrate that their architecture design process is superior, such that exploits like this are significantly less likely. However, given the complexity of modern processors, it would be completely unsurprising if a new family of exploits was discovered that nobody knew to design against.', 'timestamp': '1515073038571', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515073038571#c1107761947744486687', 'author': {'name': 'Rowan Collins', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/11501625256059457499'}, 'displayTime': 'January 4, 2018 at 5:37 AM', 'deleteclass': 'item-control blog-admin pid-554412158'}, {'id': '5714685950523587542', 'body': 'what about UEK? Is it affected?', 'timestamp': '1515073552569', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515073552569#c5714685950523587542', 'author': {'name': 'kpematopa e na sofia', 'avatarUrl': '//lh3.googleusercontent.com/-YVJtvUFcFwA/AAAAAAAAAAI/AAAAAAAAADA/G8Cvz5VAO0w/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/17516817556853122034'}, 'displayTime': 'January 4, 2018 at 5:45 AM', 'deleteclass': 'item-control blog-admin pid-695123664'}, {'id': '6440907833255218864', 'body': 'It\x26#39;s funny how Project Zero is researching Intel and AMD processors looking for vulnerabilities when this team still hasn\x26#39;t fixed the Android WiFi Direct vulnerability!  \x3cbr /\x3e\x3cbr /\x3eGoing on 3 years and still no fix!\x3cbr /\x3e\x3cbr /\x3ehttps://threatpost.com/android-wi-fi-direct-vulnerability-details-disclosed/110650/\x3cbr /\x3e\x3cbr /\x3eProject Zero team, maybe you should work on fixing internal bugs instead of those of other companies!', 'timestamp': '1515074588314', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515074588314#c6440907833255218864', 'author': {'name': 'sfw2008', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/14441065746676177611'}, 'displayTime': 'January 4, 2018 at 6:03 AM', 'deleteclass': 'item-control blog-admin pid-1047262911'}, {'id': '5332354702675792868', 'body': 'All these attacks appear to depend on access to the high resolution \x26quot;timestamp counter\x26quot; of the CPU. This makes me wonder what would be the negative impact of making the related instructions privileged. Philosophically speaking this sounds as a good idea because it isolates the logical model of computation from access to the real world time.', 'timestamp': '1515075360713', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515075360713#c5332354702675792868', 'author': {'name': 'nikolayo', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/07078172730540310601'}, 'displayTime': 'January 4, 2018 at 6:16 AM', 'deleteclass': 'item-control blog-admin pid-664025971'}, {'id': '2183774660356855812', 'body': 'Interesting, but not surprised. Since years I routinely deactivate all prefetching systems forcthe CPU in BIOS. At least on VM hosts. I would like to know if such a system is still vulnerable.\x3cbr /\x3e\x3cbr /\x3eWhy I did that? I observed severe performance hits with high virtualizazion ratios. I suspected pipeline trashing and or malallocation of fake HT cores. We had VMS getting scheduled on two fakes (HT cores). They performed bad, but also crippled the VM running on the two real cores.\x3cbr /\x3e\x3cbr /\x3eDisabling HT resulted in 2x faster response times.\x3cbr /\x3e\x3cbr /\x3eDisabling PREFETCH (IP and Data) resulted in another 3x faster response.\x3cbr /\x3e\x3cbr /\x3eJIRA Kanban board (a large one)\x3cbr /\x3e\x3cbr /\x3eSystems that exhibited performance issues where disk was suspected were recovering and ran smoothly ever after without touching any outside system. (MSExchange)\x3cbr /\x3e\x3cbr /\x3eHPE has the hints to disable prefetch in their tuning guides for low latency systems.', 'timestamp': '1515076485151', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515076485151#c2183774660356855812', 'author': {'name': 'Marco', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/01875820203679277116'}, 'displayTime': 'January 4, 2018 at 6:34 AM', 'deleteclass': 'item-control blog-admin pid-1502435259'}, {'id': '3160947669943313254', 'parentId': '3702023949938729150', 'body': 'Everyone with a bit of tech background knows this. But I\x26#39;ve seen a lot of business articles just copying Intel\x26#39;s \x26#39;all sides\x26#39; argument.\x3cbr /\x3e\x3cbr /\x3eI\x26#39;ve never been an Intel fan, and how they handle this consolidates my view of them as a traditional \x26#39;evil\x26#39; corp', 'timestamp': '1515078219668', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515078219668#c3160947669943313254', 'author': {'name': 'Unknown', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/04319611595028970524'}, 'displayTime': 'January 4, 2018 at 7:03 AM', 'deleteclass': 'item-control blog-admin pid-707812780'}, {'id': '8162275856452847779', 'body': 'I tried replicating something along the lines of PoC 1 (in BASIC of all things), but couldn\x26#39;t get it to read the memory speculatively on an i7-860 from what I could see (it does reliably detect the cache misses when it is in proper code flow). Coming here I see I might need to learn more about branch prediction, I barely know what I\x26#39;m doing. But after seeing news of this earlier today and reading the papers I thought it sounds worryingly easy, so the fact I got this far starting from scratch in a little over 3 hours (and if it had speculatively executed the read, I would have detected it) is kind of scary.', 'timestamp': '1515078564282', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515078564282#c8162275856452847779', 'author': {'name': 'adx', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/08977098164422796580'}, 'displayTime': 'January 4, 2018 at 7:09 AM', 'deleteclass': 'item-control blog-admin pid-1014491555'}, {'id': '8307820975979548028', 'body': ' Philosophically speaking the root cause for these \x26quot;bugs\x26quot; is : program access to fine grained real time information breaks the abstraction of sequential execution. So I wonder whether depriving user space programs of access to such information could solve or at least mitigate the problem. What if e.g. instructions for access to the CPU \x26quot;timestamp counter\x26quot; are made privileged and OS - supported timers have sufficiently low resolution?', 'timestamp': '1515078582053', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515078582053#c8307820975979548028', 'author': {'name': 'nikolayo', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/07078172730540310601'}, 'displayTime': 'January 4, 2018 at 7:09 AM', 'deleteclass': 'item-control blog-admin pid-664025971'}, {'id': '7529941025260060615', 'parentId': '3702023949938729150', 'body': 'WREAKS \x3d\x3d\x26gt; REEKS\x3cbr /\x3eTwo entirely different words, meaning to completely different things.', 'timestamp': '1515079461024', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515079461024#c7529941025260060615', 'author': {'name': 'fredex', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/02265485787642193724'}, 'displayTime': 'January 4, 2018 at 7:24 AM', 'deleteclass': 'item-control blog-admin pid-1448192863'}, {'id': '2029551004604591823', 'parentId': '3702023949938729150', 'body': 'AMD themselves have reported that they are affected by 1 of the 3 vulnerabilities. \x3cbr /\x3ehttps://www.amd.com/en/corporate/speculative-execution', 'timestamp': '1515090699932', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515090699932#c2029551004604591823', 'author': {'name': 'Jeremy Corbello', 'avatarUrl': '//lh5.googleusercontent.com/-tcUqNYkGsAg/AAAAAAAAAAI/AAAAAAAAAF4/rFXOaSyrIGU/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/14794907422663911605'}, 'displayTime': 'January 4, 2018 at 10:31 AM', 'deleteclass': 'item-control blog-admin pid-956758245'}, {'id': '7893813268177997558', 'parentId': '3702023949938729150', 'body': 'This couldn\x26#39;t have been said any better!', 'timestamp': '1515090802872', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515090802872#c7893813268177997558', 'author': {'name': 'Unknown', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/17784703847779922879'}, 'displayTime': 'January 4, 2018 at 10:33 AM', 'deleteclass': 'item-control blog-admin pid-720995047'}, {'id': '6221888973186274612', 'parentId': '3702023949938729150', 'body': '\x26quot;1. A PoC that demonstrates the basic principles behind variant 1 in userspace on the tested Intel Haswell Xeon CPU, the AMD FX CPU, the AMD PRO CPU and an ARM Cortex A57 [2]. This PoC only tests for the ability to read data inside mis-speculated execution within the same process, without crossing any privilege boundaries.\x3cbr /\x3e\x3cbr /\x3e2. A PoC for variant 1 that, when running with normal user privileges under a modern Linux kernel with a distro-standard config, can perform arbitrary reads in a 4GiB range [3] in kernel virtual memory on the Intel Haswell Xeon CPU. If the kernel\x26#39;s BPF JIT is enabled (non-default configuration), it also works on the AMD PRO CPU. On the Intel Haswell Xeon CPU, kernel virtual memory can be read at a rate of around 2000 bytes per second after around 4 seconds of startup time. [4]\x26quot;', 'timestamp': '1515091156109', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515091156109#c6221888973186274612', 'author': {'name': 'Peter', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/06432566211516609646'}, 'displayTime': 'January 4, 2018 at 10:39 AM', 'deleteclass': 'item-control blog-admin pid-1533064788'}, {'id': '8056760102318684239', 'body': '\x3cbr /\x3eI have just received an update of the Windows KB4056892 patch but making a benchmark I noticed that the score is decreased and that is 4691 step in single-core at 4629 instead in multi-core I passed 12588 to 12483 and I have an intel-core i5 of 7th generation with NVIDIA GeForce GT 1030,', 'timestamp': '1515095026122', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515095026122#c8056760102318684239', 'author': {'name': 'adventuretimeh 2', 'avatarUrl': '//lh4.googleusercontent.com/-FOmiIAy_qIs/AAAAAAAAAAI/AAAAAAAAAb8/9wGEEqabrAQ/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/11930793690094140214'}, 'displayTime': 'January 4, 2018 at 11:43 AM', 'deleteclass': 'item-control blog-admin pid-1506945407'}, {'id': '2879295379477186427', 'body': 'Is there a possibility of getting some dates put on the research articles from Daniel Gruss, Moritz Lipp, et al?\x3cbr /\x3e\x3cbr /\x3eSeems a little odd that there aren\x26#39;t any dates on those papers other than the reference material. Wouldn\x26#39;t mind knowing when they published those papers.', 'timestamp': '1515095216381', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515095216381#c2879295379477186427', 'author': {'name': 'Unknown', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/11279965544532010097'}, 'displayTime': 'January 4, 2018 at 11:46 AM', 'deleteclass': 'item-control blog-admin pid-496185878'}, {'id': '1241911917199757254', 'parentId': '7320179167879533204', 'body': 'Folks,\x3cbr /\x3eSorry for the rookie question, but in order for any of the variant to be triggered, an \x26quot;attacker\x26quot; must first has either physical/remote access to the machine - correct? (in order to access the memory/root)\x3cbr /\x3e\x3cbr /\x3eScenario b:\x3cbr /\x3eAlso, a similar approach may be utilized if a user has visited a malicious site and an attacker now has access to the browser-session and again other sessions running in parallel?', 'timestamp': '1515095375409', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515095375409#c1241911917199757254', 'author': {'name': 'Ali J.', 'avatarUrl': '//lh3.googleusercontent.com/-RQieV0N4gn0/AAAAAAAAAAI/AAAAAAAAAMc/48DicAeHMk8/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/16920242518383596017'}, 'displayTime': 'January 4, 2018 at 11:49 AM', 'deleteclass': 'item-control blog-admin pid-1456081860'}, {'id': '3590647665898256016', 'parentId': '7320179167879533204', 'body': 'Folks,\x3cbr /\x3eSorry for the rookie question, but in order for any of the Variants be implemented, the attacker would need either physical or remote access to the machine (with an intel/AMD/ARM chip) - correct?', 'timestamp': '1515095611586', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515095611586#c3590647665898256016', 'author': {'name': 'Ali J.', 'avatarUrl': '//lh3.googleusercontent.com/-RQieV0N4gn0/AAAAAAAAAAI/AAAAAAAAAMc/48DicAeHMk8/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/16920242518383596017'}, 'displayTime': 'January 4, 2018 at 11:53 AM', 'deleteclass': 'item-control blog-admin pid-1456081860'}, {'id': '7935716908800547615', 'body': 'Intel should issue a \x26quot;recall\x26quot;.', 'timestamp': '1515095674956', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515095674956#c7935716908800547615', 'author': {'name': 'Ken Zheng', 'avatarUrl': '//4.bp.blogspot.com/_x3zfW3QzJVw/SbnlGlRmMyI/AAAAAAAAAHw/twO8Vx78QGA/S45-s35/kenatsun97.gif', 'profileUrl': 'https://www.blogger.com/profile/07214879671853081697'}, 'displayTime': 'January 4, 2018 at 11:54 AM', 'deleteclass': 'item-control blog-admin pid-2052801987'}, {'id': '4923121180493565950', 'body': 'Are you sure about the mapping from variant 1/2/3 to Meltdown/Spectre? Looking at the description of Meltdown on the Cyberus blog (http://blog.cyberus-technology.de/posts/2018-01-03-meltdown.html), it seems to correspond to variant 1 (and maybe 2, not sure) as described here (not variant 3).', 'timestamp': '1515098069016', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515098069016#c4923121180493565950', 'author': {'name': 'Unknown', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/07627329866749684881'}, 'displayTime': 'January 4, 2018 at 12:34 PM', 'deleteclass': 'item-control blog-admin pid-1159231711'}, {'id': '6351900027641169862', 'body': 'This is going to be interesting to see how this plays out in a month.  FDIV was bad, I was there but it was self inflicted by how Intel handled it.  But this seems like it has way more legal, political and customer relations pathways and the fact that it impacts way more products and it seems like it\x26#39;s not limited to just Intel.  As more and more people get their head around this type of attack methodology and apply it to more parts of the CPU and different CPUs, GPUs, etc more products will fall.  So right now, batten down the hatches, we are going for a ride...', 'timestamp': '1515103527055', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515103527055#c6351900027641169862', 'author': {'name': 'Ken', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/15011836855669376603'}, 'displayTime': 'January 4, 2018 at 2:05 PM', 'deleteclass': 'item-control blog-admin pid-740013729'}, {'id': '511256723335818520', 'parentId': '5796706728859614654', 'body': 'Info from Google for KPTI performance:\x3cbr /\x3e\x3cbr /\x3e\x26quot;On most of our workloads, including our cloud infrastructure, we see negligible impact on performance.\x26quot; \x3cbr /\x3e\x3cbr /\x3ehttps://security.googleblog.com/2018/01/more-details-about-mitigations-for-cpu_4.html', 'timestamp': '1515104631076', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515104631076#c511256723335818520', 'author': {'name': 'Nikolay', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/02716925755387178105'}, 'displayTime': 'January 4, 2018 at 2:23 PM', 'deleteclass': 'item-control blog-admin pid-74061795'}, {'id': '6220113181117859327', 'parentId': '1801913178267003427', 'body': 'Why not look at AMDs website? https://developer.arm.com/support/security-update', 'timestamp': '1515105811774', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515105811774#c6220113181117859327', 'author': {'name': 'publicarray', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/17671063747952328513'}, 'displayTime': 'January 4, 2018 at 2:43 PM', 'deleteclass': 'item-control blog-admin pid-373089245'}, {'id': '2558766068452496902', 'parentId': '7935716908800547615', 'body': 'The problem is that the vulnerability has existed in their CPUs since the 90s. Effectively, every device running an intel cpu is compromised.\x3cbr /\x3eThis will probably have a long tail end, as many older machines which will never or cannot be updated will remain exposed for decades.', 'timestamp': '1515107307257', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515107307257#c2558766068452496902', 'author': {'name': 'Unknown', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/07283242419328574552'}, 'displayTime': 'January 4, 2018 at 3:08 PM', 'deleteclass': 'item-control blog-admin pid-1025473413'}, {'id': '2488198985945310456', 'body': 'What does the timing code use?  rdtsc ? cpuid ?', 'timestamp': '1515107620674', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515107620674#c2488198985945310456', 'author': {'name': 'David F.', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/06923837085602918625'}, 'displayTime': 'January 4, 2018 at 3:13 PM', 'deleteclass': 'item-control blog-admin pid-799272630'}, {'id': '5349933284480985986', 'body': 'What is used for timing?  rdtsc with cpuid?  (authorize this one as it will notify me of updates).', 'timestamp': '1515107956956', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515107956956#c5349933284480985986', 'author': {'name': 'David F.', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/06923837085602918625'}, 'displayTime': 'January 4, 2018 at 3:19 PM', 'deleteclass': 'item-control blog-admin pid-799272630'}, {'id': '6111288264547472575', 'body': 'Passwords, SSNs, credit cards are nothing. Imagine getting the private key from banking institutions, government entities etc. Being able to decrpyt all data to and from these entities would be world changing. HTTPS would become pointless, and everything anyone does with the entity that was compromised would be readable. That is devastating.', 'timestamp': '1515119251750', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515119251750#c6111288264547472575', 'author': {'name': 'Kold', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/09135953864733039772'}, 'displayTime': 'January 4, 2018 at 6:27 PM', 'deleteclass': 'item-control blog-admin pid-1860006626'}, {'id': '2085512598394721511', 'parentId': '3702023949938729150', 'body': 'It already exists.\x3cbr /\x3ehttps://spectreattack.com/spectre.pdf\x3cbr /\x3e\x3cbr /\x3eHardware 1.3 \x3cbr /\x3e\x26quot;Hardware.We have empirically verified the vulnerability of several Intel processors to Spectre attacks,  including Ivy Bridge, Haswell and Skylake based processors. We  have  also  verified  the  attack&#8217;s  applicability to  AMD  Ryzen  CPUs. Finally,  we  have  also  successfully mounted Spectre attacks on several Samsung and Qualcomm processors (which use an ARM architecture)found in popular mobile phones.\x26quot;\x3cbr /\x3e\x3cbr /\x3eThey even use the word empirical.', 'timestamp': '1515119683582', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515119683582#c2085512598394721511', 'author': {'name': '71Jay17', 'avatarUrl': '//lh4.googleusercontent.com/-urXR0FTu4gY/AAAAAAAAAAI/AAAAAAAAADM/Y12QKeDtPk8/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/10845840475827162290'}, 'displayTime': 'January 4, 2018 at 6:34 PM', 'deleteclass': 'item-control blog-admin pid-1989363583'}, {'id': '65915222006915742', 'body': 'I used rdtscp in my test above. I just tried on a C2D which didn\x26#39;t like that, \x26#39;prefixing\x26#39; rdtsc with cpuid worked. Couldn\x26#39;t confirm speculative accesses on the C2D either (see my post above) but I think I\x26#39;m just doing it wrong. I had modelled it on my understanding of Meltdown, but my test is more like Spectre because I\x26#39;m abusing the branch predictor (incompetently).\x3cbr /\x3e\x3cbr /\x3eCompare that to the statement in the Meltdown paper that they didn\x26#39;t get it working on AMD simply because it didn\x26#39;t - I\x26#39;m not calling them incompetent but if they don\x26#39;t know why it didn\x26#39;t work and think it might work, then that\x26#39;s the last type of good news wanted by AMD (or ARM).\x3cbr /\x3e\x3cbr /\x3eIt really is a rather simple (and fundamental) issue, there has been a grey cloud hanging over speculative execution since it was conceived (imagine the horrors it could wreak on memory-mapped I/O), but now that engineering curio has become a Problem I can\x26#39;t really see a way out other than locking out all forms of timing from untrusted code, including the ability to run raw code at full speed. That is the inverse of where all these JIT VMs have taken us. It\x26#39;s sort of like the perfect storm. Complexity, speed, determinism.', 'timestamp': '1515119699058', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515119699058#c65915222006915742', 'author': {'name': 'adx', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/08977098164422796580'}, 'displayTime': 'January 4, 2018 at 6:34 PM', 'deleteclass': 'item-control blog-admin pid-1014491555'}, {'id': '3961463360650947266', 'parentId': '7320179167879533204', 'body': 'Intel, AMD \x26amp; all ARM processors that use speculative execution are all vulnerable to at least one of the 3 variants of the vulnerability. Intel is just the worst impacted due to meltdown being unique to them.', 'timestamp': '1515119874932', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515119874932#c3961463360650947266', 'author': {'name': '71Jay17', 'avatarUrl': '//lh4.googleusercontent.com/-urXR0FTu4gY/AAAAAAAAAAI/AAAAAAAAADM/Y12QKeDtPk8/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/10845840475827162290'}, 'displayTime': 'January 4, 2018 at 6:37 PM', 'deleteclass': 'item-control blog-admin pid-1989363583'}, {'id': '6104991461932130377', 'body': 'There are more ways than this to access kernel space. These cache buffer reads are Tre cool. But what of the sys call kernel internals that link kernel and userland? The kernels memory manager calls on Linux can also be called from userland using similar buffer techniques.', 'timestamp': '1515122200103', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515122200103#c6104991461932130377', 'author': {'name': 'Belly Knots', 'avatarUrl': '//lh4.googleusercontent.com/-_LaARau0j8c/AAAAAAAAAAI/AAAAAAAAAUU/voRdBfBDliU/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/16542571270346691636'}, 'displayTime': 'January 4, 2018 at 7:16 PM', 'deleteclass': 'item-control blog-admin pid-426620607'}, {'id': '7907054412518878119', 'body': 'Out of my curiosity are SPARC CPU, HP PA and IBM POWER architectures are also found vulnerable to this flaw? Because many Legacy Banks and very old organizations still rely on the hardware that runs IBM AIX, HP UNIX, and Oracle {Legacy SUN} Solaris infrastructure. There should always be a patch or method of prevention from the respective vendors.. and this is a never ending learning cycle.', 'timestamp': '1515122416881', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515122416881#c7907054412518878119', 'author': {'name': 'Sandeep Kumar Pyaraka', 'avatarUrl': '//lh6.googleusercontent.com/-51GFVa4pYeo/AAAAAAAAAAI/AAAAAAAABiU/Lg6ZgRYFp08/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/17655844911964509212'}, 'displayTime': 'January 4, 2018 at 7:20 PM', 'deleteclass': 'item-control blog-admin pid-1576262237'}, {'id': '1033424649309359369', 'body': 'arm64.\x3cbr /\x3ehow a53 no problem?\x3cbr /\x3ea53 a57 this armv8.', 'timestamp': '1515123635008', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515123635008#c1033424649309359369', 'author': {'name': 'андрей шемякин', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/18139932078636405349'}, 'displayTime': 'January 4, 2018 at 7:40 PM', 'deleteclass': 'item-control blog-admin pid-621843416'}, {'id': '5198125571873172439', 'parentId': '3702023949938729150', 'body': 'My involuntary thought since I already have PCs I built on AMD is wondering if this vulnerability or the propose software OS update patch will even have any affect on my system.  The test AMD CPU used in this PoC is a lot newer than the AMD chips I use on my two desktop systems ie. AMD Opteron 185 and AMD Phenom II. \x3cbr /\x3e\x3cbr /\x3eMy other thought is how would the attacker get administrative permission to even execute code exploit.  Don\x26#39;t the current permissions in place still apply to when it comes to defending against any exploit.  Don\x26#39;t the ermission to read+execute need to happen first, and this blog post mentions nothing of any sort.  Who knows what these control testers were doing to try legitimately hack a PC. \x3cbr /\x3e\x3cbr /\x3eWith that in mind, the urgency for concern of this wans. ', 'timestamp': '1515124775362', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515124775362#c5198125571873172439', 'author': {'name': 'Clarence Smith', 'avatarUrl': '//lh4.googleusercontent.com/-t-K02eSYOc4/AAAAAAAAAAI/AAAAAAAAKXs/7B8Kj5oj7qU/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/15919824353979973259'}, 'displayTime': 'January 4, 2018 at 7:59 PM', 'deleteclass': 'item-control blog-admin pid-536865141'}, {'id': '4650227636202424871', 'parentId': '3922612046928760190', 'body': 'Two of my desktop computers are already AMD.  I\x26#39;m thinking of adding VIA to the mix, if they still make desktop CPUs like I remember in the early 2000s.', 'timestamp': '1515124933429', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515124933429#c4650227636202424871', 'author': {'name': 'Clarence Smith', 'avatarUrl': '//lh4.googleusercontent.com/-t-K02eSYOc4/AAAAAAAAAAI/AAAAAAAAKXs/7B8Kj5oj7qU/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/15919824353979973259'}, 'displayTime': 'January 4, 2018 at 8:02 PM', 'deleteclass': 'item-control blog-admin pid-536865141'}, {'id': '1780351237922037841', 'parentId': '8307820975979548028', 'body': 'Unfortunately it would be a simple matter to repeat each test enough times that a coarse-grained clock would still show the difference, so such a change would only slow an attack down, not stop it.\x3cbr /\x3e', 'timestamp': '1515128914623', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515128914623#c1780351237922037841', 'author': {'name': 'MK', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/14289675575382598584'}, 'displayTime': 'January 4, 2018 at 9:08 PM', 'deleteclass': 'item-control blog-admin pid-28783640'}, {'id': '3412520428104682520', 'parentId': '5349933284480985986', 'body': 'Depends. The JavaScript version of the spectre attack uses a separate webworker that increases a value in a tight loop to simulate a good-enough clock. (access to rdtsc is restricted and Chrome already decreases the accuracy of performance.now())', 'timestamp': '1515144826122', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515144826122#c3412520428104682520', 'author': {'name': 'Christoph Hack', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/00032972068093102766'}, 'displayTime': 'January 5, 2018 at 1:33 AM', 'deleteclass': 'item-control blog-admin pid-2113079403'}, {'id': '4754441366618484823', 'body': 'Well the browser developers begin to turn a little bit @ the timeing functions for js. A little help but this here will get into a full patch and reroll verions roulette.\x3cbr /\x3e\x3cbr /\x3eHard to detect error - good that it has been posted now.', 'timestamp': '1515147176303', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515147176303#c4754441366618484823', 'author': {'name': 'Vigar', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/00415051552964835755'}, 'displayTime': 'January 5, 2018 at 2:12 AM', 'deleteclass': 'item-control blog-admin pid-570032854'}, {'id': '5915496641177222865', 'parentId': '7320179167879533204', 'body': 'No a rookie question, it is a good question, while there is a lot of hype about the exploits, there does not appear to be a clear simple explanation of how an attacker would use these exploits.  I believe from what I read so far, this would have to be a targeted attack to gather the exploited information.  If anyone has any other information please update us all.', 'timestamp': '1515165904735', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515165904735#c5915496641177222865', 'author': {'name': 'Peaceful Blogger', 'avatarUrl': '//3.bp.blogspot.com/_hXrhkVZXtLM/SZdGNW20tUI/AAAAAAAAAaE/eU3JZNIcuNY/S45-s35/DSC02602.JPG', 'profileUrl': 'https://www.blogger.com/profile/12626915382891209217'}, 'displayTime': 'January 5, 2018 at 7:25 AM', 'deleteclass': 'item-control blog-admin pid-1361673886'}, {'id': '1120784762805780592', 'body': 'If this vulnerabilities are for hardware Intel Chips, for example we have patched the physical Host machine, hosting Virtual machines, is it still necessary to patch the VM\x26#39;s (using virtualized CPU) riding on the physical host that has been patched?', 'timestamp': '1515166540879', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515166540879#c1120784762805780592', 'author': {'name': 'Domain Junkie', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/10950533743426480312'}, 'displayTime': 'January 5, 2018 at 7:35 AM', 'deleteclass': 'item-control blog-admin pid-1644921291'}, {'id': '1527003317722471563', 'parentId': '7320179167879533204', 'body': 'Out of pure curiosity because I used to work on both chips, I wonder if PowerPC (and Power) chips and Oracle\x26#39;s abandoned SPARC processors are also effected?', 'timestamp': '1515176382739', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515176382739#c1527003317722471563', 'author': {'name': 'Bill Jurasz', 'avatarUrl': '//lh3.googleusercontent.com/-5hyO2Ta6sNY/AAAAAAAAAAI/AAAAAAAAAEk/yaoCvwI9ujk/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/15984225017685069008'}, 'displayTime': 'January 5, 2018 at 10:19 AM', 'deleteclass': 'item-control blog-admin pid-745788240'}, {'id': '7112527430055826355', 'parentId': '7053426628276274147', 'body': 'you meant 2018?', 'timestamp': '1515196460267', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515196460267#c7112527430055826355', 'author': {'name': 'JRivero_Work', 'avatarUrl': '//3.bp.blogspot.com/_MdWqB0wVU_s/S8dg2Lxp10I/AAAAAAAADaQ/LWb1ehEsDCI/S45-s35/DSCN0716.JPG', 'profileUrl': 'https://www.blogger.com/profile/17697908935203047147'}, 'displayTime': 'January 5, 2018 at 3:54 PM', 'deleteclass': 'item-control blog-admin pid-164170350'}, {'id': '3399190143643690882', 'body': 'Hi,\x3cbr /\x3eWe are trying to evaluate the possibility of this attack on the below Middleware products:\x3cbr /\x3e1) IBM WebSphere Application Server\x3cbr /\x3e2) IBM WebSphere MQ\x3cbr /\x3e3) IBM Message Broker\x3cbr /\x3e4) Redhat JWS Tomcat\x3cbr /\x3e5) Redhat Directory Server\x3cbr /\x3e6) Oracle Directory Server\x3cbr /\x3e7) CA Siteminder\x3cbr /\x3e8) OpenAM ForgeRock\x3cbr /\x3e9) Oracle WebLogic\x3cbr /\x3e10) Other Oracle Products like ORMB, OID etc.\x3cbr /\x3e\x3cbr /\x3eDoes this vulnerability affects any of these products?', 'timestamp': '1515201737390', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515201737390#c3399190143643690882', 'author': {'name': 'Eureka !!!!!', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/09801029434152890444'}, 'displayTime': 'January 5, 2018 at 5:22 PM', 'deleteclass': 'item-control blog-admin pid-646159601'}, {'id': '4089607114020839367', 'parentId': '7907054412518878119', 'body': 'if attacker will be able run to code on these system it can\x26#39;t help them anyway.', 'timestamp': '1515226297639', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515226297639#c4089607114020839367', 'author': {'name': 'str', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/02841258206889517140'}, 'displayTime': 'January 6, 2018 at 12:11 AM', 'deleteclass': 'item-control blog-admin pid-1255526261'}, {'id': '6213326162011255256', 'parentId': '7320179167879533204', 'body': 'AFAIK this is not a remote exploitable bug. You have to be able to run userspace (unprivileged) code on the machine. On the bad side, it seems that from inside a VM (eg. in a cloud service) you can read others VMs\x26#39; memory.\x3cbr /\x3e\x3cbr /\x3eAnyway, all the hype mixing all processors together, mixing those 3 variants together, is just wrong. Only meltdown (the Intel-specific one, variant 3), can be used to *accurately* read memory. The other variants can only do a fair guess of the memory contents timing the cache access.', 'timestamp': '1515235215978', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515235215978#c6213326162011255256', 'author': {'name': 'Edoardo', 'avatarUrl': '//2.bp.blogspot.com/_gU9OU0XbpAw/TCselOdY0fI/AAAAAAAAACs/00y7OUyoQH0/S45-s35/19636_1246503016048_1633593755_596563_7222224_n.jpg', 'profileUrl': 'https://www.blogger.com/profile/00151062503533533562'}, 'displayTime': 'January 6, 2018 at 2:40 AM', 'deleteclass': 'item-control blog-admin pid-670718987'}, {'id': '364671465516541006', 'parentId': '7907054412518878119', 'body': 'https://www.ibm.com/blogs/psirt/potential-impact-processors-power-family/ ', 'timestamp': '1515252838838', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515252838838#c364671465516541006', 'author': {'name': 'Xuanjun Si', 'avatarUrl': '//lh4.googleusercontent.com/-thn64dBxkcE/AAAAAAAAAAI/AAAAAAAAMKM/o6rgidf5wck/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/15509008655459723259'}, 'displayTime': 'January 6, 2018 at 7:33 AM', 'deleteclass': 'item-control blog-admin pid-1812866546'}, {'id': '960636250519657242', 'body': 'Control point integrity which moves the code pointers (indirect call pointers and return addresses over stack) to a safe shadow memory having a \x26quot;RO\x26quot; permissions should be helpful in combating such attacks. Are any PoC done over Intel\x26#39;s SGX extension.', 'timestamp': '1515253355606', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515253355606#c960636250519657242', 'author': {'name': 'Jatin', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/12192702207978448664'}, 'displayTime': 'January 6, 2018 at 7:42 AM', 'deleteclass': 'item-control blog-admin pid-516503568'}, {'id': '108692582115011333', 'parentId': '3702023949938729150', 'body': '\x26quot;WREAKS \x3d\x3d\x26gt; REEKS\x3cbr /\x3eTwo entirely different words, meaning to completely different things.\x26quot;\x3cbr /\x3e\x3cbr /\x3eto \x3d\x3d\x26gt; two\x3cbr /\x3e\x3cbr /\x3eIf you\x26#39;re going to go around correcting others\x26#39; spelling, then at least make sure your own passes muster, mkay?', 'timestamp': '1515253400344', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515253400344#c108692582115011333', 'author': {'name': 'Stephen Keen', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/04758119695379351518'}, 'displayTime': 'January 6, 2018 at 7:43 AM', 'deleteclass': 'item-control blog-admin pid-1474371572'}, {'id': '1123512873996910336', 'body': 'I came up with a solution but it does not involve retpoline, you must think of the problem from a physics point of view, security is binary its either secure or its not, let me give an example of 1 and 0\x3cbr /\x3e\x3cbr /\x3eThe processor is handling 1 to 0 for each bit in question weather it is writing or reading comes after the fact.\x3cbr /\x3e\x3cbr /\x3eMy current solution 7th Jan 18\x3cbr /\x3e\x3cbr /\x3eT \x3d (phase doubler) divided by 1\x3cbr /\x3e\x3cbr /\x3eWith this equation we can take a step forward in processing logic by adding double phase to the 1 and 0 calculation of a processor\x3cbr /\x3e\x3cbr /\x3eWith phase i have added checkphase similar to checksum on a binary level\x3cbr /\x3e\x3cbr /\x3eBut this can be easily added as kernal to all processors\x3cbr /\x3e\x3cbr /\x3eThis give us a new variable \x3d T\x3cbr /\x3e\x3cbr /\x3eT equals the phase of the 1 or the 0 \x3cbr /\x3e\x3cbr /\x3eBut it does so twice to check and allocate processing by splitting and checking and comparing the digits in a bit twice ', 'timestamp': '1515261144194', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515261144194#c1123512873996910336', 'author': {'name': 'Zipcode technology', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/05715833273393977399'}, 'displayTime': 'January 6, 2018 at 9:52 AM', 'deleteclass': 'item-control blog-admin pid-1278991185'}, {'id': '4152918199645090594', 'parentId': '1801913178267003427', 'body': 'Good to see the definitive list of exploitable ARM processors... Mine isn\x26#39;t on the list but think I\x26#39;ll test it myself, just in case. ', 'timestamp': '1515262253913', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515262253913#c4152918199645090594', 'author': {'name': 'Abe', 'avatarUrl': '//1.bp.blogspot.com/-qf-Ke_tfnJY/V-MYZsoVVtI/AAAAAAAABOQ/objQoKerLjknntZm1Gv1xn-JHjqACWEAgCK4B/s35/adamd-1b-profile.jpg', 'profileUrl': 'https://www.blogger.com/profile/11245940820150640952'}, 'displayTime': 'January 6, 2018 at 10:10 AM', 'deleteclass': 'item-control blog-admin pid-721616001'}, {'id': '6192122787125588344', 'body': 'Excellent article, very detailed. \x3cbr /\x3e\x3cbr /\x3eI\x26#39;ve also read an article published on LWN on the same topic but that article caused me some confusion. They provide a similar code sample for demonstrating the boundary check exploit which contained the following lines of code.\x3cbr /\x3e\x3cbr /\x3e    if (offset \x26lt; array1-\x26gt;length) {\x3cbr /\x3e        unsigned char value \x3d array1-\x26gt;data[offset];\x3cbr /\x3e       unsigned long index \x3d ((value\x26amp;1)*0x100)+0x200;\x3cbr /\x3e       if (index \x26lt; array2-\x26gt;length) // length is \x26lt; 0x300\x3cbr /\x3e            unsigned char value2 \x3d array2-\x26gt;data[index];\x3cbr /\x3e     }\x3cbr /\x3e\x3cbr /\x3eHowever what I don\x26#39;t understand about this code is, if the LSB of value evaluates to 1 then index is 0x300, but the comment states the length of array2 is \x26lt; 0x300 which would mean the if statement wouldn\x26#39;t evaluate to true. Now am I correct in assuming that the inner if statement would also trigger speculative execution and the boundary check bypassed again or was this most likely a mistake by the author?\x3cbr /\x3e ', 'timestamp': '1515278267325', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515278267325#c6192122787125588344', 'author': {'name': 'ImperialDev', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/01561216421115521655'}, 'displayTime': 'January 6, 2018 at 2:37 PM', 'deleteclass': 'item-control blog-admin pid-14773401'}, {'id': '3119090522474521630', 'body': ' struct array {\x3cbr /\x3e unsigned long length;\x3cbr /\x3e unsigned char data[];\x3cbr /\x3e};\x3cbr /\x3estruct array *arr1 \x3d ...;\x3cbr /\x3eunsigned long untrusted_offset_from_caller \x3d ...;\x3cbr /\x3eif (untrusted_offset_from_caller \x26lt; arr1-\x26gt;length) {\x3cbr /\x3e unsigned char value \x3d arr1-\x26gt;data[untrusted_offset_from_caller];\x3cbr /\x3e ...\x3cbr /\x3e}\x3cbr /\x3eHowever, in the following code sample, there\x26#39;s an issue. If arr1-\x26gt;length, arr2-\x26gt;data[0x200] and arr2-\x26gt;data[0x300] are not cached, but all other accessed data is, and the branch conditions are predicted as true, the processor can do the following speculatively before arr1-\x26gt;length has been loaded and the execution is re-steered:\x3cbr /\x3e\x3cbr /\x3e    load value \x3d arr1-\x26gt;data[untrusted_offset_from_caller]\x3cbr /\x3e    start a load from a data-dependent offset in arr2-\x26gt;data, loading the corresponding cache line into the L1 cache\x3cbr /\x3e\x3cbr /\x3e\x3cbr /\x3estruct array {\x3cbr /\x3e unsigned long length;\x3cbr /\x3e unsigned char data[];\x3cbr /\x3e};\x3cbr /\x3estruct array *arr1 \x3d ...; /* small array */\x3cbr /\x3estruct array *arr2 \x3d ...; /* array of size 0x400 */\x3cbr /\x3e/* \x26gt;0x400 (OUT OF BOUNDS!) */\x3cbr /\x3eunsigned long untrusted_offset_from_caller \x3d ...;\x3cbr /\x3eif (untrusted_offset_from_caller \x26lt; arr1-\x26gt;length) {\x3cbr /\x3e unsigned char value \x3d arr1-\x26gt;data[untrusted_offset_from_caller];\x3cbr /\x3e unsigned long index2 \x3d ((value\x26amp;1)*0x100)+0x200;\x3cbr /\x3e if (index2 \x26lt; arr2-\x26gt;length) {\x3cbr /\x3e   unsigned char value2 \x3d arr2-\x26gt;data[index2];\x3cbr /\x3e }\x3cbr /\x3e}\x3cbr /\x3e\x3cbr /\x3eIn order to compile the code, is it possible to fill the dots ...? In this way we can verify your discovery. ', 'timestamp': '1515317316262', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515317316262#c3119090522474521630', 'author': {'name': 'Blogger', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/09176102356738042104'}, 'displayTime': 'January 7, 2018 at 1:28 AM', 'deleteclass': 'item-control blog-admin pid-1264730033'}, {'id': '5791083419745167196', 'body': 'It should be clearly mention that an specurative load in user mode does not load the corresponding cache line of kernel data into the L1 cache.\x3cbr /\x3e\x3cbr /\x3eThis results in \x3cbr /\x3e\x26quot;To be able to actually use this behavior for an attack, an attacker needs to be able to cause the execution of such a vulnerable code pattern in the targeted context with an out-of-bounds index.  For this, the vulnerable code pattern must either be present in existing code, or there must be an interpreter or JIT engine that can be used to generate the vulnerable code pattern.\x26quot;\x3cbr /\x3eas described.\x3cbr /\x3e\x3cbr /\x3eI don\x26#39;t understand why the Variant 1 works on \x26quot;Intel Haswell Xeon CPU, eBPF JIT is off (default state)\x26quot;, which is the most (\x26quot;the only\x26quot; for me) important on this report.  It is not proved in this report, if I understand correctly.\x3cbr /\x3e', 'timestamp': '1515332845414', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515332845414#c5791083419745167196', 'author': {'name': 'SFLin', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/15696036599680035229'}, 'displayTime': 'January 7, 2018 at 5:47 AM', 'deleteclass': 'item-control blog-admin pid-163238614'}, {'id': '2710975700671160396', 'body': 'Great article and great job!!!\x3cbr /\x3eHowever, I do not get how these discovered undocumented features are related to \x26quot;security vulnerability\x26quot;. There are hundreds or thousands of methods for stealing information from hard-drive, screen, communication channels and memory. But all these security issues have one unambiguous source. The evil program was installed and run on your computer without your permission and authorization. Doesn\x26#39;t matter how it harms your system after that. Destroys your disk, copies your files or have the unauthorized access to other process memory or processor\x26#39;s cache. The security vulnerability is the fact that this program could be started on your computer without your permission. If it happens - there are hundreds of methods to steal your information or harm your computer, and these methods are way more simple and reliable than trying to read other process memory.\x3cbr /\x3eI hope that I miss something and you can help me to figure my mistake out, because 30+ years experience in computer programming and software architecture is challenged by \x26quot;the storm in the glass of water\x26quot; caused by the discovery of \x26quot;security vulnerability\x26quot; of the chip (???). I wouldn\x26#39;t have any problem if the issue has been classified as \x26quot;undocumented feature\x26quot; or bug. It still had to be fixed and you still have done great job and deserves all credits.\x3cbr /\x3eBut it is hard for me to accept the discovered issue under the tag of \x26quot;security\x26quot;. I hope you may help me to fix a gap in my understanding.', 'timestamp': '1515344571413', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515344571413#c2710975700671160396', 'author': {'name': 'Yuri Kreinin', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/06351425016912798444'}, 'displayTime': 'January 7, 2018 at 9:02 AM', 'deleteclass': 'item-control blog-admin pid-1395416549'}, {'id': '5161319623650497743', 'parentId': '3702023949938729150', 'body': 'Several AMD FX and at least one APU are affected.  And it is very easily exploited remotely.  I have no statistics except my machines.  Every Intel and AMD processor I have is attacked remotely almost every day.  Not sure if I get attacked more than the average person (it seems to me I should be a boring target to either criminal or state attackers) or if there is widespread (psychological) denial.  Many people who should be able to see and understand this stuff better than me still speak as if this is overblown.  \x3cbr /\x3e\x3cbr /\x3eIt\x26#39;s not.  It\x26#39;s real, it\x26#39;s far worse than the most paranoid security scenarios ever imagined, and if you aren\x26#39;t under constant attack then you either don\x26#39;t realize you are being attacked, or your turn hasn\x26#39;t come yet. \x3cbr /\x3e\x3cbr /\x3eIt certainly will; I am nobody and if I\x26#39;m getting it this bad then I can only imagine that everyone is or will.  Perhaps it becomes harder to see with professional level training since professionals \x26quot;know\x26quot; even better than anyone that security disaster this bad \x26quot;can\x26#39;t\x26quot; happen.  But, unfortunately it has happened.  Every everything is darn near wide open and remotely exploitable.  \x3cbr /\x3e\x3cbr /\x3eStill waiting for the running, screaming and hair on fire.  That is where we should be.  Time to disembark from our pleasure cruise on denial.', 'timestamp': '1515349239595', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515349239595#c5161319623650497743', 'author': {'name': 'BNP WJ', 'avatarUrl': '//lh6.googleusercontent.com/-CIyY0NTyiHw/AAAAAAAAAAI/AAAAAAAAABA/VHhgcKy0d8s/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/15798210151450343469'}, 'displayTime': 'January 7, 2018 at 10:20 AM', 'deleteclass': 'item-control blog-admin pid-285885577'}, {'id': '7195026662307698634', 'body': '1) Are older AMD (pre-2015) APUs vulnerable to all variations of this exploit?\x3cbr /\x3e2) Have there been vulnerability tests released for all tree variants (for consumers to check in with)?\x3cbr /\x3e3) What should I do about my Intel Xeon X5472 workstation?', 'timestamp': '1515367040929', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515367040929#c7195026662307698634', 'author': {'name': 'TopHatProductions115', 'avatarUrl': '//4.bp.blogspot.com/-35wJc9H1GM4/U94vfsO1khI/AAAAAAAAAMI/bFmSLQbIbuk/s35/TopHatProductions115_absent.png', 'profileUrl': 'https://www.blogger.com/profile/17338522180858247013'}, 'displayTime': 'January 7, 2018 at 3:17 PM', 'deleteclass': 'item-control blog-admin pid-1747280572'}, {'id': '1853016284404002188', 'body': 'AMD claims that Variant Two- Branch Target Injection and Variant Three- Rogue Data Cache Load has a near zero to zero risk on AMD processors. Microsoft also confirmed Xbox One, in which AMD CPU and GPU is used, has no impacted by Meltdown and Spectre\x3cbr /\x3e\x3cbr /\x3ehttps://stevivor.com/news/xbox-one-mitigates-recent-chip-related-security-vulnerabilities/ \x3cbr /\x3e\x3cbr /\x3eHere only shows Variant one- bounds check bypass with  AMD FX and PRO processor.  What about the newer AMD  Ryzen and   EPYC processor? \x3cbr /\x3e', 'timestamp': '1515377834210', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515377834210#c1853016284404002188', 'author': {'name': 'Somsri Varanuyuth', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/01405255076932880465'}, 'displayTime': 'January 7, 2018 at 6:17 PM', 'deleteclass': 'item-control blog-admin pid-990806103'}, {'id': '6899524236866531916', 'parentId': '2710975700671160396', 'body': 'Imagine you being a cloud provider, renting VMs. Now one of your customers happily read your hypervisor memory. Is that accepatble to you?', 'timestamp': '1515395531775', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515395531775#c6899524236866531916', 'author': {'name': 'J', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/00621306780575849955'}, 'displayTime': 'January 7, 2018 at 11:12 PM', 'deleteclass': 'item-control blog-admin pid-254348355'}, {'id': '9132678378008452252', 'body': 'good alert Google Team,    important,    imo, this has gotten amplified in the last six months.   i can understand , how a browser session,    captured,   could reveal the private key,     ', 'timestamp': '1515414454006', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515414454006#c9132678378008452252', 'author': {'name': 'BOMBOVA', 'avatarUrl': '//2.bp.blogspot.com/-AcYBjkCrHvA/VILE-p3LnZI/AAAAAAAAAQM/OIIL-jPBRT4/s35/*', 'profileUrl': 'https://www.blogger.com/profile/16158693680439830382'}, 'displayTime': 'January 8, 2018 at 4:27 AM', 'deleteclass': 'item-control blog-admin pid-566991074'}, {'id': '7042177740312844800', 'body': 'I hope the guys that discovered this will eventually produce some testing applications so that we can test if our systems are really not vulnerable any more after applying all recommended patches. I mean the tests which really try to exploit the vulnerabilities.\x3cbr /\x3e\x3cbr /\x3eMoreover, as nobody knows if the vulnerabilities have been exploited in the wild, would it be wise that we change passwords, private keys and other secret parts of our credentials once our systems are patched?', 'timestamp': '1515418200071', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515418200071#c7042177740312844800', 'author': {'name': 'rpr', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/16124750110629546625'}, 'displayTime': 'January 8, 2018 at 5:30 AM', 'deleteclass': 'item-control blog-admin pid-825836278'}, {'id': '5241457376972049555', 'body': 'from what I understand, both exploits are possible only with hyperthreading on. Is that so? ', 'timestamp': '1515425445680', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515425445680#c5241457376972049555', 'author': {'name': 'Sid', 'avatarUrl': '//1.bp.blogspot.com/_V7V6ZUHl4kU/SasF8cBqbPI/AAAAAAAAABE/vkyiHz44wus/S45-s35/myself.jpg', 'profileUrl': 'https://www.blogger.com/profile/04101473047938934148'}, 'displayTime': 'January 8, 2018 at 7:30 AM', 'deleteclass': 'item-control blog-admin pid-1718266561'}, {'id': '6416240483800354932', 'parentId': '7320179167879533204', 'body': 'Power chips are possibly affected.  IBM to issue fix on Jan 9\x3cbr /\x3ehttps://www.ibm.com/blogs/psirt/potential-impact-processors-power-family', 'timestamp': '1515425629296', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515425629296#c6416240483800354932', 'author': {'name': 'johnvoris', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/00193765948519092297'}, 'displayTime': 'January 8, 2018 at 7:33 AM', 'deleteclass': 'item-control blog-admin pid-435385631'}, {'id': '5718461585215012697', 'body': 'ASUS Advisory if you want to add this to links ;)\x3cbr /\x3ehttps://www.asus.com/News/V5urzYAT6myCC1o2?_ga\x3d2.82328660.371051983.1515436172-668502183.1503859416', 'timestamp': '1515436801823', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515436801823#c5718461585215012697', 'author': {'name': 'Unknown', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/16726201594909890454'}, 'displayTime': 'January 8, 2018 at 10:40 AM', 'deleteclass': 'item-control blog-admin pid-893527526'}, {'id': '7982600671302167723', 'parentId': '2710975700671160396', 'body': '1. It explains how the harmful program can be access on your machine without your permission. Thank you.\x3cbr /\x3e2. However, your example doesn\x26#39;t apply to the majority of personal computers\x3cbr /\x3e3. Suppose VM has read access to hypervisor memory. What \x26quot;useful\x26quot; information can it steal from there? How does it finds and extracts sensitive information from the huge amount of data?\x3cbr /\x3e4. It still sounds for me as a problem of OS / software and not hardware.', 'timestamp': '1515444063299', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515444063299#c7982600671302167723', 'author': {'name': 'Yuri Kreinin', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/06351425016912798444'}, 'displayTime': 'January 8, 2018 at 12:41 PM', 'deleteclass': 'item-control blog-admin pid-1395416549'}, {'id': '429886688456074264', 'body': 'On x86, it is possible to shutdown speculation following an indirect jump with the UD2 instruction. This is described in the Intel&#174; 64 and IA-32 Architectures Optimization Reference Manual:\x3cbr /\x3e\x3cbr /\x3eAssembly/Compiler Coding Rule 14. (M impact, L generality) When indirect branches are present, try to put the most likely target of an indirect branch immediately following the indirect branch. Alternatively, if indirect branches are common but they cannot be predicted by branch prediction hardware, then follow the indirect branch with a UD2 instruction, which will stop the processor from decoding down the fall-through path.\x3cbr /\x3e', 'timestamp': '1515476363607', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515476363607#c429886688456074264', 'author': {'name': 'Unknown', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/06586334509553334314'}, 'displayTime': 'January 8, 2018 at 9:39 PM', 'deleteclass': 'item-control blog-admin pid-1832084563'}, {'id': '6271253976747161042', 'parentId': '7053426628276274147', 'body': 'Arm security-update is located at https://developer.arm.com/support/security-update', 'timestamp': '1515490961139', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515490961139#c6271253976747161042', 'author': {'name': 'Bruce Yang', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/06332042359602211603'}, 'displayTime': 'January 9, 2018 at 1:42 AM', 'deleteclass': 'item-control blog-admin pid-2133360416'}, {'id': '4201222968294253829', 'body': 'Does December 2017 security updates covers protection from these 2 vulnerabilities?', 'timestamp': '1515493209576', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515493209576#c4201222968294253829', 'author': {'name': 'Rajat Insan', 'avatarUrl': '//2.bp.blogspot.com/_ztCqqu1jsy8/SazVAGw7IrI/AAAAAAAAAA8/8gF3sAZTlQo/S45-s35/rajat.jpg', 'profileUrl': 'https://www.blogger.com/profile/04613556748100133165'}, 'displayTime': 'January 9, 2018 at 2:20 AM', 'deleteclass': 'item-control blog-admin pid-631206786'}, {'id': '220218180810361156', 'parentId': '4201222968294253829', 'body': 'Rajat, I suggest reading the following guidelines for Windows Server OS and for clients OS:\x3cbr /\x3ehttps://support.microsoft.com/en-us/help/4072698/\x3cbr /\x3ehttps://support.microsoft.com/en-hk/help/4073119/\x3cbr /\x3eI\x26#39;d say that all the updates recommended on those pages were issued in January 2018.\x3cbr /\x3e\x3cbr /\x3eThe same applies to Linux distributions listed at the end of https://meltdownattack.com', 'timestamp': '1515504472397', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515504472397#c220218180810361156', 'author': {'name': 'rpr', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/16124750110629546625'}, 'displayTime': 'January 9, 2018 at 5:27 AM', 'deleteclass': 'item-control blog-admin pid-825836278'}, {'id': '2506283646101943145', 'parentId': '7320179167879533204', 'body': 'Spectre could be used via the Browser (Firefox,Chrome, etc.) via a jvascript. In this scenario it would be possible for one tab to read the other tabs and things like the password you used for them. Thats why you should be aware that your Browser is up to date!\x3cbr /\x3eThis is just a simplified explanation.', 'timestamp': '1515587490339', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515587490339#c2506283646101943145', 'author': {'name': 'Lorenz Lindemann', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/17648728706457668379'}, 'displayTime': 'January 10, 2018 at 4:31 AM', 'deleteclass': 'item-control blog-admin pid-328430414'}, {'id': '3345607423953893514', 'body': 'Assume you are running a virtual machine on a cloud provider, the cloud provider is also hosting other customers on the same physical hardware.\x3cbr /\x3eYour virtual machine is patched, then another customer decides to run a custom Linux VM with rogue code, hence he can exploit meltdown to read your vm\x26#39;s memory?\x3cbr /\x3e\x3cbr /\x3eThe meltdown fix prevents you from exploiting others, not others from exploiting you, correct?', 'timestamp': '1515594718978', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515594718978#c3345607423953893514', 'author': {'name': 'Adam Furtenbach', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/07206118933952322548'}, 'displayTime': 'January 10, 2018 at 6:31 AM', 'deleteclass': 'item-control blog-admin pid-1701719785'}, {'id': '6575043431867188392', 'body': 'I have posted a number of comments that question how this \x26quot;security breach\x26quot; can steal the sensitive information. Only the first two comments were published, but the rest just disappeared (or were blocked for some reason).\x3cbr /\x3eI repeat my very simple question - suppose I have read-access to all the memory of all other processes. How can intruder utilize this option in order to discover passwords, usernames etc? Ok, he might be able to find some photos, perhaps. But what about the more sensitive and encrypted information.\x3cbr /\x3eI suggested a very simple test: suppose, I put the attacker program on my computer - is it able to find the entire text message inside another unknown running process, if I provide some key-words? Could it be done, if I encrypt the message?', 'timestamp': '1515624033731', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515624033731#c6575043431867188392', 'author': {'name': 'Yuri Kreinin', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/06351425016912798444'}, 'displayTime': 'January 10, 2018 at 2:40 PM', 'deleteclass': 'item-control blog-admin pid-1395416549'}, {'id': '2766645272235480814', 'parentId': '6575043431867188392', 'body': 'Your suggested test is exactly what it can do. Imagine opening up a debugger on the computer capable of reading anything in RAM. Passwords, usernames, what is open, the content of a document being worked on, the data being shuttled back and forth with a client of a server, keys in use, the lot. The bigger the system, the more there is to look through. Photos, ironically probably not (if they are on disk and not in use). Encrypted information no not without a key or password, but usually the point of something being in memory is that it is being worked on, in other words it is decrypted. Not always, but the security model relies on protected memory being unreadable, encryption is usually only used on files on the disk in case they are accidentally disclosed. That\x26#39;s why this \x26quot;flaw\x26quot; is so bad - it can read information that is not expected to be encrypted. It\x26#39;s hard to think of a worse-case scenario. Fortunately the patches seem to be practical and the players in the discovery have managed it well and were probably able to prevent mass exploitation at a scale we have never seen before.', 'timestamp': '1515633926918', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515633926918#c2766645272235480814', 'author': {'name': 'adx', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/08977098164422796580'}, 'displayTime': 'January 10, 2018 at 5:25 PM', 'deleteclass': 'item-control blog-admin pid-1014491555'}, {'id': '9217717268005109064', 'parentId': '7320179167879533204', 'body': 'There is a PoC exploit of this in JavaScript - however I am not sure if it has been expanded on or exploited in any specific way. This means, though, that even visiting a webpage that is infected could gain the attacker access to your cache...', 'timestamp': '1515698692437', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515698692437#c9217717268005109064', 'author': {'name': 'Sam Cyanide', 'avatarUrl': '//lh3.googleusercontent.com/-x1c13YtFQcQ/AAAAAAAAAAI/AAAAAAAABtA/fZlhvEQgkAM/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/15584291730209133034'}, 'displayTime': 'January 11, 2018 at 11:24 AM', 'deleteclass': 'item-control blog-admin pid-2056929376'}, {'id': '1897331547409398219', 'body': 'Can someone at Project Zero explain why the FreeBSD Security Team was notified so much later than their counterparts supporting other systems? I am honestly very disappointed in Google\x26#39;s delay in this regard.', 'timestamp': '1515709054545', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515709054545#c1897331547409398219', 'author': {'name': 'Unknown', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/05889212960761838838'}, 'displayTime': 'January 11, 2018 at 2:17 PM', 'deleteclass': 'item-control blog-admin pid-389076539'}, {'id': '1403705798707490788', 'parentId': '6575043431867188392', 'body': 'Could you explain, how would you be able to discover sensitive information (passwords, usernames etc) inside the memory dump of tens of gigabytes without knowing the exact layout?\x3cbr /\x3eAnd what does this memory dump worth when it is created with a speed of 2K byte per second?\x3cbr /\x3eI suggested a very simple test, which is much easier than stealing of sensitive information and I suggested this test because I doubt that it could be done.\x3cbr /\x3eYou remind the debugger - that\x26#39;s a very good point. You can write a debugger-like application, which attaches to the process of interest and retrieves the information, if it knows how to do it with this particular process. No need to use \x26quot;cache-lines\x26quot; and other tricks. The most computers are vulnerable to this. Isn\x26#39;t it? ', 'timestamp': '1515729249394', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515729249394#c1403705798707490788', 'author': {'name': 'Yuri Kreinin', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/06351425016912798444'}, 'displayTime': 'January 11, 2018 at 7:54 PM', 'deleteclass': 'item-control blog-admin pid-1395416549'}, {'id': '487498929959072361', 'body': 'You know what would be great, if all google pages showed a date published and a data updated. Some for almost any of the vendor pages. Please, it is 2018 we use dates and time. Thanks.', 'timestamp': '1515800381067', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515800381067#c487498929959072361', 'author': {'name': 'Saint Crusty', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/16775745880820642277'}, 'displayTime': 'January 12, 2018 at 3:39 PM', 'deleteclass': 'item-control blog-admin pid-1215135636'}, {'id': '62942650886674319', 'parentId': '6440907833255218864', 'body': 'Your own source specifies that \x26quot;Android 5.0.1 and 5.0.2 are not vulnerable, according to the advisory.\x26quot; i.e. all versions of Android still supported by google at the moment (Lollipop except 5.0.x, Marshmallow, Nougat and Oreo) aren\x26#39;t affected by the Wifi Direct vulnerability.', 'timestamp': '1515868666632', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515868666632#c62942650886674319', 'author': {'name': 'Yet Again', 'avatarUrl': '//lh3.googleusercontent.com/-_pAhTXoBzQU/AAAAAAAAAAI/AAAAAAAAAKY/Rz6RuQ08rrw/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/01993185823702529356'}, 'displayTime': 'January 13, 2018 at 10:37 AM', 'deleteclass': 'item-control blog-admin pid-1490421540'}, {'id': '6210824591003501536', 'parentId': '2879295379477186427', 'body': 'Ditto, the year and also where it was published (or technical paper if not in conference proceedings or journal), because even some of the co-authors cite  Kocher \x26amp; al. without any date or venue c.f. reference [19] in https://meltdownattack.com/meltdown.pdf', 'timestamp': '1515869280765', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515869280765#c6210824591003501536', 'author': {'name': 'Yet Again', 'avatarUrl': '//lh3.googleusercontent.com/-_pAhTXoBzQU/AAAAAAAAAAI/AAAAAAAAAKY/Rz6RuQ08rrw/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/01993185823702529356'}, 'displayTime': 'January 13, 2018 at 10:48 AM', 'deleteclass': 'item-control blog-admin pid-1490421540'}, {'id': '1355434673930403380', 'parentId': '6575043431867188392', 'body': 'Yuri, the fact that sensitive data is hidden in a lot of noise (tens of GB of data dump) is a classic machine learning problem. If a team is determined to use the flaw, (1) experts in computer security would access/grab the data dump, then (2) experts in data-mining/ machine learning would then separate the data from the \x26quot;noise\x26quot;.\x3cbr /\x3eThe best analogy that comes to mind: suppose we find out that everyone\x26#39;s home has a flaw, where the key to their house is buried somewhere in the garden. Since the flaw affects almost anyone, the probability of any one person getting robbed is extremely low, but if your house is known to contain tons of gold, then it\x26#39;s worth mining your entire garden with metal detectors just to find the key. And entire groups might start deploying an army of miners with metal detectors just to gather as many keys as possible \x26quot;just in case\x26quot; (ex: Gov agencies, misc nefarious groups).\x3cbr /\x3eKeep in mind that the data\x26#39;s not encrypted, so it\x26#39;s just a matter of finding recurring patterns. One extremely simplified example: parse the data-dump to get all websites, and look for recurring bank websites, then get the data you input immediately afterwards (yes, I\x26#39;m over-simplifying a LOT but it\x26#39;s just probabilistic algorithms crunching a lot of data) .... eventually, one\x26#39;ll obtain your online banking password.  Same for paypal and what not. \x3cbr /\x3ePS: my field isn\x26#39;t computer security, but rather data mining so to me it\x26#39;s the \x26quot;easy part\x26quot; of the problem, though I\x26#39;d need an accomplice to get the data-dump. ', 'timestamp': '1515871077942', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515871077942#c1355434673930403380', 'author': {'name': 'Yet Again', 'avatarUrl': '//lh3.googleusercontent.com/-_pAhTXoBzQU/AAAAAAAAAAI/AAAAAAAAAKY/Rz6RuQ08rrw/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/01993185823702529356'}, 'displayTime': 'January 13, 2018 at 11:17 AM', 'deleteclass': 'item-control blog-admin pid-1490421540'}, {'id': '6741595981781493101', 'parentId': '6575043431867188392', 'body': 'What you say about the debugger does apply if you\x26#39;re running everything as Administrator or root (or on a C64). But in a secured computer, no ordinary user can attach a debugger to a privileged process, that is locked out and is the whole point of brick-wall like memory protection. It doesn\x26#39;t rely on security through obscurity or hoping things are hard to find, but hardware designed to make it absolutely (completely and utterly) impossible for a normal level user to get past. Computers have had this memory protection hardware for decades.\x3cbr /\x3e\x3cbr /\x3eI\x26#39;m not saying extracting the root password would be trivial, but first off in a server with 10s of GB of RAM you can pretty much guarantee it is all being used for something. Reading any of it is almost certain to disclose sensitive data. It might be some random php in a file cache, but it is still data that someone trusts is behind the security wall. The Meltdown dumps were produced at 500KB/s, which is plenty fast enough to find something juicy or dump all RAM in less than a day. I mentioned the debugger because it\x26#39;s interactive - you\x26#39;re sitting there perusing stuff interactively, watching how it changes when you do something, like say attempting to log in over SSH. Even 2KB/s would be enough for that. The mechanics of the attack also means you get a massive hardware assist and can effectively search a lot faster for certain things. If you\x26#39;re logged into some random web host they tell you exactly what kernel is running with what patches, and one of the papers on this attack discusses what structures might be vulnerable even with mitigations like address space randomisation. Without memory protection, there is basically no security at all against locally running code.', 'timestamp': '1515921601742', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1515921601742#c6741595981781493101', 'author': {'name': 'adx', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/08977098164422796580'}, 'displayTime': 'January 14, 2018 at 1:20 AM', 'deleteclass': 'item-control blog-admin pid-1014491555'}, {'id': '6907526937829018537', 'body': 'as a new one, just mark it', 'timestamp': '1516242336738', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1516242336738#c6907526937829018537', 'author': {'name': '吴光韬', 'avatarUrl': '//lh4.googleusercontent.com/-FQiCdB4M-8g/AAAAAAAAAAI/AAAAAAAABMU/dNeRfv4z_k4/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/07557330351988823220'}, 'displayTime': 'January 17, 2018 at 6:25 PM', 'deleteclass': 'item-control blog-admin pid-1929181896'}, {'id': '1687940820028404905', 'body': 'If I use a fingerprint recognition system, can I prevent hacking? Would not it be possible to hack through the program by changing all passwords to fingerprint? Instead, it is based on the assumption that the fingerprint recognition system is based on external USB hardware.', 'timestamp': '1516319039852', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1516319039852#c1687940820028404905', 'author': {'name': 'Unknown', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/00038765374445105388'}, 'displayTime': 'January 18, 2018 at 3:43 PM', 'deleteclass': 'item-control blog-admin pid-1517526033'}, {'id': '3656594530100660739', 'body': 'If I use a fingerprint recognition system, can I prevent hacking? Would not it be possible to hack through the program by changing all passwords to fingerprint? Instead, it is based on the assumption that the fingerprint recognition system is based on external USB hardware.', 'timestamp': '1516319173439', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1516319173439#c3656594530100660739', 'author': {'name': '원동주', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/00038765374445105388'}, 'displayTime': 'January 18, 2018 at 3:46 PM', 'deleteclass': 'item-control blog-admin pid-1517526033'}, {'id': '6807439105513856891', 'body': 'So, what are those of us that have NO IDEA what the hell you are talking about, supposed to do?  Seriously!!! We are all not computer or mis specialists.  I deleted the \x26quot;AdBot\x26quot; extension and ran a Mbytes scan.  Do I have to do anything else?', 'timestamp': '1516331406700', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1516331406700#c6807439105513856891', 'author': {'name': 'Rick Coe', 'avatarUrl': '//lh5.googleusercontent.com/-ZVxYUDWeWMg/AAAAAAAAAAI/AAAAAAAAAYU/ppog0lKUu1M/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/15749737049488289436'}, 'displayTime': 'January 18, 2018 at 7:10 PM', 'deleteclass': 'item-control blog-admin pid-1855132382'}, {'id': '337690053541848846', 'body': 'Great work and great article.', 'timestamp': '1516331677764', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1516331677764#c337690053541848846', 'author': {'name': 'Jimin Cai', 'avatarUrl': '//lh6.googleusercontent.com/-tSOX6YpK1wk/AAAAAAAAAAI/AAAAAAAAAFA/kRTr5jdQrqI/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/18132262762975449123'}, 'displayTime': 'January 18, 2018 at 7:14 PM', 'deleteclass': 'item-control blog-admin pid-1655234023'}, {'id': '4840401713642396212', 'body': 'chrome://extensions Ok, let\x26#39;s try this again.  Since I have no idea what the heck you are all talking about; what am I supposed to do now.  I mean really-not all of us are computer or MIS geniuses. I went in and deleted the \x26quot;AdBot\x26quot; extension. It actually was not marked as enabled, but I dumped it anyway.  Then I ran Mbytes \x26amp; Windows Defender scans.  Is there anything else I have to do.  Also I did not get any notification from Google about problems!!!!!!  This came off a Mbyte post dated 1-7-18.', 'timestamp': '1516331766187', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1516331766187#c4840401713642396212', 'author': {'name': 'Rick Coe', 'avatarUrl': '//lh5.googleusercontent.com/-ZVxYUDWeWMg/AAAAAAAAAAI/AAAAAAAAAYU/ppog0lKUu1M/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/15749737049488289436'}, 'displayTime': 'January 18, 2018 at 7:16 PM', 'deleteclass': 'item-control blog-admin pid-1855132382'}, {'id': '3251403423436089673', 'body': 'When stating that \x26quot;eBPF\x26#39;s data arrays are less efficient than its function pointer arrays\x26quot;, is this in general, or specific to the pertaining attack vector?', 'timestamp': '1516497153571', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1516497153571#c3251403423436089673', 'author': {'name': 'zorinmiki', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/11357847549633100438'}, 'displayTime': 'January 20, 2018 at 5:12 PM', 'deleteclass': 'item-control blog-admin pid-376038802'}, {'id': '7894288835369785388', 'body': 'This is one interesting threat, knowledgeable people may want to review. To my untrained mind this appears to be eerilie similar to what spectre and meltdown contain as a PoC\x3cbr /\x3e\x3cbr /\x3ehttps://software.intel.com/en-us/forums/intel-moderncode-for-parallel-architectures/topic/305992', 'timestamp': '1516572969125', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1516572969125#c7894288835369785388', 'author': {'name': 'Saint Crusty', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/16775745880820642277'}, 'displayTime': 'January 21, 2018 at 2:16 PM', 'deleteclass': 'item-control blog-admin pid-1215135636'}, {'id': '4392830750172580212', 'body': 'Quick question. I\x26#39;ve read about Meltdown and Specter. And since they both kind of use cache side effects with access to previlieged memory, would a solution be for the processor to invalidate any cache line of data that was speculatively loaded but ended up not needed?', 'timestamp': '1516660370586', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1516660370586#c4392830750172580212', 'author': {'name': 'efortin', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/17342990294244659957'}, 'displayTime': 'January 22, 2018 at 2:32 PM', 'deleteclass': 'item-control blog-admin pid-550257729'}, {'id': '3398237596414186699', 'body': 'May I ask how to dump branch history buffer state?', 'timestamp': '1516872763911', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1516872763911#c3398237596414186699', 'author': {'name': 'John', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/02278656169794520248'}, 'displayTime': 'January 25, 2018 at 1:32 AM', 'deleteclass': 'item-control blog-admin pid-173166326'}, {'id': '2643378959495191805', 'body': 'Hopefully Intel is working on hardware solution of this flaw. Obvious solution is adding fully isolated device that performs scheduled encryption for all sensitive information, (that does not used for computation anyway), then decryption is done only when request is longer then access time of meltdown..   Such solution will help not only for Meltdown, but also for any attempt to get password without touching keyboard.  ', 'timestamp': '1517668353726', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1517668353726#c2643378959495191805', 'author': {'name': 'David', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/01117938740608925196'}, 'displayTime': 'February 3, 2018 at 6:32 AM', 'deleteclass': 'item-control blog-admin pid-215513349'}, {'id': '2932325015026238406', 'body': 'Still waiting for Intel microcode...', 'timestamp': '1517914273856', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1517914273856#c2932325015026238406', 'author': {'name': 'Hestia', 'avatarUrl': '//lh3.googleusercontent.com/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA\x3ds35', 'profileUrl': 'https://www.blogger.com/profile/09435526251866934641'}, 'displayTime': 'February 6, 2018 at 2:51 AM', 'deleteclass': 'item-control blog-admin pid-271376085'}, {'id': '1654288901347045133', 'body': 'Hi, in session Glossary, should the \x26quot;A processor can execute past a branch\x26quot; be \x26quot;A processor can execute a past branch\x26quot; ? ', 'timestamp': '1518430107473', 'permalink': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment\x3d1518430107473#c1654288901347045133', 'author': {'name': 'jason cheng', 'avatarUrl': '//lh4.googleusercontent.com/-2_RhP97xw8g/AAAAAAAAAAI/AAAAAAAAAoE/JFR8nbNt82A/s35-c/photo.jpg', 'profileUrl': 'https://www.blogger.com/profile/11850372820326490272'}, 'displayTime': 'February 12, 2018 at 2:08 AM', 'deleteclass': 'item-control blog-admin pid-2112514500'}];
      var msgs = {'loadMore': 'Load more...', 'loading': 'Loading...', 'loaded': 'No more!', 'addComment': 'Add comment', 'reply': 'Reply', 'delete': 'Delete'};
      var config = {'blogId': '4838136820032157985', 'postId': '6227737444967092885', 'feed': 'https://googleprojectzero.blogspot.com/feeds/6227737444967092885/comments/default', 'authorName': 'Ben', 'authorUrl': 'https://www.blogger.com/profile/15940768551906668205', 'baseUri': 'https://www.blogger.com', 'maxThreadDepth': 2};

// <![CDATA[
      var cursor = null;
      if (items && items.length > 0) {
        cursor = parseInt(items[items.length - 1].timestamp) + 1;
      }

      var bodyFromEntry = function(entry) {
        var text = (entry &&
                    ((entry.content && entry.content.$t) ||
                     (entry.summary && entry.summary.$t))) ||
            '';
        if (entry && entry.gd$extendedProperty) {
          for (var k in entry.gd$extendedProperty) {
            if (entry.gd$extendedProperty[k].name == 'blogger.contentRemoved') {
              return '<span class="deleted-comment">' + text + '</span>';
            }
          }
        }
        return text;
      }

      var parse = function(data) {
        cursor = null;
        var comments = [];
        if (data && data.feed && data.feed.entry) {
          for (var i = 0, entry; entry = data.feed.entry[i]; i++) {
            var comment = {};
            // comment ID, parsed out of the original id format
            var id = /blog-(\d+).post-(\d+)/.exec(entry.id.$t);
            comment.id = id ? id[2] : null;
            comment.body = bodyFromEntry(entry);
            comment.timestamp = Date.parse(entry.published.$t) + '';
            if (entry.author && entry.author.constructor === Array) {
              var auth = entry.author[0];
              if (auth) {
                comment.author = {
                  name: (auth.name ? auth.name.$t : undefined),
                  profileUrl: (auth.uri ? auth.uri.$t : undefined),
                  avatarUrl: (auth.gd$image ? auth.gd$image.src : undefined)
                };
              }
            }
            if (entry.link) {
              if (entry.link[2]) {
                comment.link = comment.permalink = entry.link[2].href;
              }
              if (entry.link[3]) {
                var pid = /.*comments\/default\/(\d+)\?.*/.exec(entry.link[3].href);
                if (pid && pid[1]) {
                  comment.parentId = pid[1];
                }
              }
            }
            comment.deleteclass = 'item-control blog-admin';
            if (entry.gd$extendedProperty) {
              for (var k in entry.gd$extendedProperty) {
                if (entry.gd$extendedProperty[k].name == 'blogger.itemClass') {
                  comment.deleteclass += ' ' + entry.gd$extendedProperty[k].value;
                } else if (entry.gd$extendedProperty[k].name == 'blogger.displayTime') {
                  comment.displayTime = entry.gd$extendedProperty[k].value;
                }
              }
            }
            comments.push(comment);
          }
        }
        return comments;
      };

      var paginator = function(callback) {
        if (hasMore()) {
          var url = config.feed + '?alt=json&v=2&orderby=published&reverse=false&max-results=50';
          if (cursor) {
            url += '&published-min=' + new Date(cursor).toISOString();
          }
          window.bloggercomments = function(data) {
            var parsed = parse(data);
            cursor = parsed.length < 50 ? null
                : parseInt(parsed[parsed.length - 1].timestamp) + 1
            callback(parsed);
            window.bloggercomments = null;
          }
          url += '&callback=bloggercomments';
          var script = document.createElement('script');
          script.type = 'text/javascript';
          script.src = url;
          document.getElementsByTagName('head')[0].appendChild(script);
        }
      };
      var hasMore = function() {
        return !!cursor;
      };
      var getMeta = function(key, comment) {
        if ('iswriter' == key) {
          var matches = !!comment.author
              && comment.author.name == config.authorName
              && comment.author.profileUrl == config.authorUrl;
          return matches ? 'true' : '';
        } else if ('deletelink' == key) {
          return config.baseUri + '/delete-comment.g?blogID='
               + config.blogId + '&postID=' + comment.id;
        } else if ('deleteclass' == key) {
          return comment.deleteclass;
        }
        return '';
      };

      var replybox = null;
      var replyUrlParts = null;
      var replyParent = undefined;

      var onReply = function(commentId, domId) {
        if (replybox == null) {
          // lazily cache replybox, and adjust to suit this style:
          replybox = document.getElementById('comment-editor');
          if (replybox != null) {
            replybox.height = '250px';
            replybox.style.display = 'block';
            replyUrlParts = replybox.src.split('#');
          }
        }
        if (replybox && (commentId !== replyParent)) {
          replybox.src = '';
          document.getElementById(domId).insertBefore(replybox, null);
          replybox.src = replyUrlParts[0]
              + (commentId ? '&parentID=' + commentId : '')
              + '#' + replyUrlParts[1];
          replyParent = commentId;
        }
      };

      var hash = (window.location.hash || '#').substring(1);
      var startThread, targetComment;
      if (/^comment-form_/.test(hash)) {
        startThread = hash.substring('comment-form_'.length);
      } else if (/^c[0-9]+$/.test(hash)) {
        targetComment = hash.substring(1);
      }

      // Configure commenting API:
      var configJso = {
        'maxDepth': config.maxThreadDepth
      };
      var provider = {
        'id': config.postId,
        'data': items,
        'loadNext': paginator,
        'hasMore': hasMore,
        'getMeta': getMeta,
        'onReply': onReply,
        'rendered': true,
        'initComment': targetComment,
        'initReplyThread': startThread,
        'config': configJso,
        'messages': msgs
      };

      var render = function() {
        if (window.goog && window.goog.comments) {
          var holder = document.getElementById('comment-holder');
          window.goog.comments.render(holder, provider);
        }
      };

      // render now, or queue to render when library loads:
      if (window.goog && window.goog.comments) {
        render();
      } else {
        window.goog = window.goog || {};
        window.goog.comments = window.goog.comments || {};
        window.goog.comments.loadQueue = window.goog.comments.loadQueue || [];
        window.goog.comments.loadQueue.push(render);
      }
    })();
// ]]>
  </script>
<div id="comment-holder">

<div id="bc_0_121C" kind="c"><div id="bc_0_121CT"><div id="bc_0_120T" class="comment-thread" kind="r" t="0" u="0"><ol id="bc_0_120TB"><li id="bc_0_11B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/photo.jpg"></div><div id="c7320179167879533204" class="comment-block"><div id="bc_0_11M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/01391704675814654904">Jamne Jansson</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515020248664#c7320179167879533204">January 3, 2018 at 2:57 PM</a></span></div><p id="bc_0_11MC" class="comment-content">So reading this: Both Intel and AMD have the "bug", but in real life only Intel are vulnerable.</p><span id="bc_0_11MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-2000217853"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=7320179167879533204">Delete</a></span></span></div><div id="bc_0_11BR" class="comment-replies"><span id="bc_0_11b+seedtl_D" kind="d"><div id="bc_0_0T" class="comment-thread inline-thread" kind="t" t="0" u="0"><span id="bc_0_0TT" class="thread-toggle thread-expanded" kind="g"><span id="bc_0_0TA" class="thread-arrow"></span><span id="bc_0_0TN" class="thread-count"><span id="bc_0_0TNT" style="display: none;"></span><span id="bc_0_0TNU" style="display: none;"></span><a href="javascript:;" target="_self">Replies</a><div id="bc_0_0TD" class="thread-dropContainer thread-expanded"><span class="thread-drop"></span></div></span></span><ol id="bc_0_0TC" class="thread-chrome thread-expanded"><div><li id="bc_0_0B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/photo(1).jpg"></div><div id="c6150327868575011561" class="comment-block"><div id="bc_0_0M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/12182391899777527943">Andy Glover</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515022432027#c6150327868575011561">January 3, 2018 at 3:33 PM</a></span></div><p id="bc_0_0MC" class="comment-content">It looks like there are two different bugs and Intel is vulnerable to the one that is easiest to trigger.</p><span id="bc_0_0MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-1340182275"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=6150327868575011561">Delete</a></span></span></div><div id="bc_0_0BR" class="comment-replies"></div><div id="bc_0_0B_box" class="comment-replybox-single"></div></li><li id="bc_0_1B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/photo.jpg"></div><div id="c3360087956790821251" class="comment-block"><div id="bc_0_1M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/01391704675814654904">Jamne Jansson</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515023033033#c3360087956790821251">January 3, 2018 at 3:43 PM</a></span></div><p id="bc_0_1MC" class="comment-content">Yes, and probably more bugs, but the Intel one is a bad one</p><span id="bc_0_1MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-2000217853"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=3360087956790821251">Delete</a></span></span></div><div id="bc_0_1BR" class="comment-replies"></div><div id="bc_0_1B_box" class="comment-replybox-single"></div></li><li id="bc_0_2B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/photo(2).jpg"></div><div id="c1241911917199757254" class="comment-block"><div id="bc_0_2M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/16920242518383596017">Ali J.</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515095375409#c1241911917199757254">January 4, 2018 at 11:49 AM</a></span></div><p id="bc_0_2MC" class="comment-content">Folks,<br>Sorry for the rookie question, but in order for any of the variant to be triggered, an "attacker" must first has either physical/remote access to the machine - correct? (in order to access the memory/root)<br><br>Scenario b:<br>Also, a similar approach may be utilized if a user has visited a malicious site and an attacker now has access to the browser-session and again other sessions running in parallel?</p><span id="bc_0_2MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-1456081860"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=1241911917199757254">Delete</a></span></span></div><div id="bc_0_2BR" class="comment-replies"></div><div id="bc_0_2B_box" class="comment-replybox-single"></div></li><li id="bc_0_3B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/photo(2).jpg"></div><div id="c3590647665898256016" class="comment-block"><div id="bc_0_3M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/16920242518383596017">Ali J.</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515095611586#c3590647665898256016">January 4, 2018 at 11:53 AM</a></span></div><p id="bc_0_3MC" class="comment-content">Folks,<br>Sorry for the rookie question, but in order for any of the Variants be implemented, the attacker would need either physical or remote access to the machine (with an intel/AMD/ARM chip) - correct?</p><span id="bc_0_3MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-1456081860"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=3590647665898256016">Delete</a></span></span></div><div id="bc_0_3BR" class="comment-replies"></div><div id="bc_0_3B_box" class="comment-replybox-single"></div></li><li id="bc_0_4B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/photo(3).jpg"></div><div id="c3961463360650947266" class="comment-block"><div id="bc_0_4M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/10845840475827162290">71Jay17</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515119874932#c3961463360650947266">January 4, 2018 at 6:37 PM</a></span></div><p id="bc_0_4MC" class="comment-content">Intel, AMD &amp; all ARM processors that use speculative execution are all vulnerable to at least one of the 3 variants of the vulnerability. Intel is just the worst impacted due to meltdown being unique to them.</p><span id="bc_0_4MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-1989363583"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=3961463360650947266">Delete</a></span></span></div><div id="bc_0_4BR" class="comment-replies"></div><div id="bc_0_4B_box" class="comment-replybox-single"></div></li><li id="bc_0_5B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/DSC02602.JPG"></div><div id="c5915496641177222865" class="comment-block"><div id="bc_0_5M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/12626915382891209217">Peaceful Blogger</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515165904735#c5915496641177222865">January 5, 2018 at 7:25 AM</a></span></div><p id="bc_0_5MC" class="comment-content">No a rookie question, it is a good question, while there is a lot of hype about the exploits, there does not appear to be a clear simple explanation of how an attacker would use these exploits.  I believe from what I read so far, this would have to be a targeted attack to gather the exploited information.  If anyone has any other information please update us all.</p><span id="bc_0_5MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-1361673886"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=5915496641177222865">Delete</a></span></span></div><div id="bc_0_5BR" class="comment-replies"></div><div id="bc_0_5B_box" class="comment-replybox-single"></div></li><li id="bc_0_6B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/photo(4).jpg"></div><div id="c1527003317722471563" class="comment-block"><div id="bc_0_6M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/15984225017685069008">Bill Jurasz</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515176382739#c1527003317722471563">January 5, 2018 at 10:19 AM</a></span></div><p id="bc_0_6MC" class="comment-content">Out of pure curiosity because I used to work on both chips, I wonder if PowerPC (and Power) chips and Oracle's abandoned SPARC processors are also effected?</p><span id="bc_0_6MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-745788240"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=1527003317722471563">Delete</a></span></span></div><div id="bc_0_6BR" class="comment-replies"></div><div id="bc_0_6B_box" class="comment-replybox-single"></div></li><li id="bc_0_7B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/19636_1246503016048_1633593755_596563_7222224_n.jpg"></div><div id="c6213326162011255256" class="comment-block"><div id="bc_0_7M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/00151062503533533562">Edoardo</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515235215978#c6213326162011255256">January 6, 2018 at 2:40 AM</a></span></div><p id="bc_0_7MC" class="comment-content">AFAIK this is not a remote exploitable bug. You have to be able to run userspace (unprivileged) code on the machine. On the bad side, it seems that from inside a VM (eg. in a cloud service) you can read others VMs' memory.<br><br>Anyway, all the hype mixing all processors together, mixing those 3 variants together, is just wrong. Only meltdown (the Intel-specific one, variant 3), can be used to *accurately* read memory. The other variants can only do a fair guess of the memory contents timing the cache access.</p><span id="bc_0_7MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-670718987"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=6213326162011255256">Delete</a></span></span></div><div id="bc_0_7BR" class="comment-replies"></div><div id="bc_0_7B_box" class="comment-replybox-single"></div></li><li id="bc_0_8B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c6416240483800354932" class="comment-block"><div id="bc_0_8M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/00193765948519092297">johnvoris</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515425629296#c6416240483800354932">January 8, 2018 at 7:33 AM</a></span></div><p id="bc_0_8MC" class="comment-content">Power chips are possibly affected.  IBM to issue fix on Jan 9<br>https://www.ibm.com/blogs/psirt/potential-impact-processors-power-family</p><span id="bc_0_8MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-435385631"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=6416240483800354932">Delete</a></span></span></div><div id="bc_0_8BR" class="comment-replies"></div><div id="bc_0_8B_box" class="comment-replybox-single"></div></li><li id="bc_0_9B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c2506283646101943145" class="comment-block"><div id="bc_0_9M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/17648728706457668379">Lorenz Lindemann</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515587490339#c2506283646101943145">January 10, 2018 at 4:31 AM</a></span></div><p id="bc_0_9MC" class="comment-content">Spectre could be used via the Browser (Firefox,Chrome, etc.) via a jvascript. In this scenario it would be possible for one tab to read the other tabs and things like the password you used for them. Thats why you should be aware that your Browser is up to date!<br>This is just a simplified explanation.</p><span id="bc_0_9MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-328430414"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=2506283646101943145">Delete</a></span></span></div><div id="bc_0_9BR" class="comment-replies"></div><div id="bc_0_9B_box" class="comment-replybox-single"></div></li><li id="bc_0_10B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/photo(5).jpg"></div><div id="c9217717268005109064" class="comment-block"><div id="bc_0_10M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/15584291730209133034">Sam Cyanide</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515698692437#c9217717268005109064">January 11, 2018 at 11:24 AM</a></span></div><p id="bc_0_10MC" class="comment-content">There is a PoC exploit of this in JavaScript - however I am not sure if it has been expanded on or exploited in any specific way. This means, though, that even visiting a webpage that is infected could gain the attacker access to your cache...</p><span id="bc_0_10MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-2056929376"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=9217717268005109064">Delete</a></span></span></div><div id="bc_0_10BR" class="comment-replies"></div><div id="bc_0_10B_box" class="comment-replybox-single"></div></li></div><div id="bc_0_0I" class="continue" kind="ci"><a href="javascript:;" target="_self">Reply</a></div></ol><div id="bc_0_0T_box" class="comment-replybox-thread"></div></div></span></div><div id="bc_0_11B_box" class="comment-replybox-single"></div></li><li id="bc_0_14B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/hat.jpg"></div><div id="c7053426628276274147" class="comment-block"><div id="bc_0_14M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/03083217667667590668">John</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515020320052#c7053426628276274147">January 3, 2018 at 2:58 PM</a></span></div><p id="bc_0_14MC" class="comment-content">Link to ARM security-update doesn't work as of 22:58 GMT on 3 January 2017</p><span id="bc_0_14MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1351088499"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=7053426628276274147">Delete</a></span></span></div><div id="bc_0_14BR" class="comment-replies"><span id="bc_0_14b+seedtm-D" kind="d"><div id="bc_0_12T" class="comment-thread inline-thread" kind="t" t="0" u="0"><span id="bc_0_12TT" class="thread-toggle thread-expanded" kind="g"><span id="bc_0_12TA" class="thread-arrow"></span><span id="bc_0_12TN" class="thread-count"><span id="bc_0_12TNT" style="display: none;"></span><span id="bc_0_12TNU" style="display: none;"></span><a href="javascript:;" target="_self">Replies</a><div id="bc_0_12TD" class="thread-dropContainer thread-expanded"><span class="thread-drop"></span></div></span></span><ol id="bc_0_12TC" class="thread-chrome thread-expanded"><div><li id="bc_0_12B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/DSCN0716.JPG"></div><div id="c7112527430055826355" class="comment-block"><div id="bc_0_12M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/17697908935203047147">JRivero_Work</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515196460267#c7112527430055826355">January 5, 2018 at 3:54 PM</a></span></div><p id="bc_0_12MC" class="comment-content">you meant 2018?</p><span id="bc_0_12MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-164170350"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=7112527430055826355">Delete</a></span></span></div><div id="bc_0_12BR" class="comment-replies"></div><div id="bc_0_12B_box" class="comment-replybox-single"></div></li><li id="bc_0_13B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c6271253976747161042" class="comment-block"><div id="bc_0_13M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/06332042359602211603">Bruce Yang</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515490961139#c6271253976747161042">January 9, 2018 at 1:42 AM</a></span></div><p id="bc_0_13MC" class="comment-content">Arm security-update is located at https://developer.arm.com/support/security-update</p><span id="bc_0_13MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-2133360416"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=6271253976747161042">Delete</a></span></span></div><div id="bc_0_13BR" class="comment-replies"></div><div id="bc_0_13B_box" class="comment-replybox-single"></div></li></div><div id="bc_0_12I" class="continue" kind="ci"><a href="javascript:;" target="_self">Reply</a></div></ol><div id="bc_0_12T_box" class="comment-replybox-thread"></div></div></span></div><div id="bc_0_14B_box" class="comment-replybox-single"></div></li><li id="bc_0_19B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c1801913178267003427" class="comment-block"><div id="bc_0_19M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/17260981663417323134">DooMMasteR</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515020793329#c1801913178267003427">January 3, 2018 at 3:06 PM</a></span></div><p id="bc_0_19MC" class="comment-content">So any words on more recent architectures?<br>AMD Zen and Intel Skylake and newer?</p><span id="bc_0_19MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1619808291"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=1801913178267003427">Delete</a></span></span></div><div id="bc_0_19BR" class="comment-replies"><span id="bc_0_19b+seedtmLD" kind="d"><div id="bc_0_15T" class="comment-thread inline-thread" kind="t" t="0" u="0"><span id="bc_0_15TT" class="thread-toggle thread-expanded" kind="g"><span id="bc_0_15TA" class="thread-arrow"></span><span id="bc_0_15TN" class="thread-count"><span id="bc_0_15TNT" style="display: none;"></span><span id="bc_0_15TNU" style="display: none;"></span><a href="javascript:;" target="_self">Replies</a><div id="bc_0_15TD" class="thread-dropContainer thread-expanded"><span class="thread-drop"></span></div></span></span><ol id="bc_0_15TC" class="thread-chrome thread-expanded"><div><li id="bc_0_15B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c7368798239603477851" class="comment-block"><div id="bc_0_15M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/03523240299024754363">Unknown</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515057457081#c7368798239603477851">January 4, 2018 at 1:17 AM</a></span></div><p id="bc_0_15MC" class="comment-content">skylake to</p><span id="bc_0_15MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-900526364"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=7368798239603477851">Delete</a></span></span></div><div id="bc_0_15BR" class="comment-replies"></div><div id="bc_0_15B_box" class="comment-replybox-single"></div></li><li id="bc_0_16B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c4732464982590111109" class="comment-block"><div id="bc_0_16M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/03523240299024754363">win dows</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515057593901#c4732464982590111109">January 4, 2018 at 1:19 AM</a></span></div><p id="bc_0_16MC" class="comment-content">skylake and newer to</p><span id="bc_0_16MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-900526364"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=4732464982590111109">Delete</a></span></span></div><div id="bc_0_16BR" class="comment-replies"></div><div id="bc_0_16B_box" class="comment-replybox-single"></div></li><li id="bc_0_17B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c6220113181117859327" class="comment-block"><div id="bc_0_17M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/17671063747952328513">publicarray</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515105811774#c6220113181117859327">January 4, 2018 at 2:43 PM</a></span></div><p id="bc_0_17MC" class="comment-content">Why not look at AMDs website? https://developer.arm.com/support/security-update</p><span id="bc_0_17MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-373089245"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=6220113181117859327">Delete</a></span></span></div><div id="bc_0_17BR" class="comment-replies"></div><div id="bc_0_17B_box" class="comment-replybox-single"></div></li><li id="bc_0_18B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/adamd-1b-profile.jpg"></div><div id="c4152918199645090594" class="comment-block"><div id="bc_0_18M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/11245940820150640952">Abe</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515262253913#c4152918199645090594">January 6, 2018 at 10:10 AM</a></span></div><p id="bc_0_18MC" class="comment-content">Good to see the definitive list of exploitable ARM processors... Mine isn't on the list but think I'll test it myself, just in case. </p><span id="bc_0_18MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-721616001"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=4152918199645090594">Delete</a></span></span></div><div id="bc_0_18BR" class="comment-replies"></div><div id="bc_0_18B_box" class="comment-replybox-single"></div></li></div><div id="bc_0_15I" class="continue" kind="ci"><a href="javascript:;" target="_self">Reply</a></div></ol><div id="bc_0_15T_box" class="comment-replybox-thread"></div></div></span></div><div id="bc_0_19B_box" class="comment-replybox-single"></div></li><li id="bc_0_20B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/photo(6).jpg"></div><div id="c6798580981063708240" class="comment-block"><div id="bc_0_20M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/12197467608127062719">Krzysztof Bryk</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515021299241#c6798580981063708240">January 3, 2018 at 3:14 PM</a></span></div><p id="bc_0_20MC" class="comment-content">oh.</p><span id="bc_0_20MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1675402947"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=6798580981063708240">Delete</a></span></span></div><div id="bc_0_20BR" class="comment-replies"></div><div id="bc_0_20B_box" class="comment-replybox-single"></div></li><li id="bc_0_25B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/newhope.jpg"></div><div id="c3918825633173428964" class="comment-block"><div id="bc_0_25M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/06596383987021017812">Artificial Wisdom</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515021584343#c3918825633173428964">January 3, 2018 at 3:19 PM</a></span></div><p id="bc_0_25MC" class="comment-content">So for AMD, this appears to only impact Linux and FreeBSD users using an "APU" who've manually turned on the BPF JIT. Considering I had no clue this thing existed until now, I'm going to guess this impacts all of 3 users.<br><br>https://www.kernel.org/doc/Documentation/networking/filter.txt</p><span id="bc_0_25MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-2105994189"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=3918825633173428964">Delete</a></span></span></div><div id="bc_0_25BR" class="comment-replies"><span id="bc_0_25b+seedtmDD" kind="d"><div id="bc_0_21T" class="comment-thread inline-thread" kind="t" t="0" u="0"><span id="bc_0_21TT" class="thread-toggle thread-expanded" kind="g"><span id="bc_0_21TA" class="thread-arrow"></span><span id="bc_0_21TN" class="thread-count"><span id="bc_0_21TNT" style="display: none;"></span><span id="bc_0_21TNU" style="display: none;"></span><a href="javascript:;" target="_self">Replies</a><div id="bc_0_21TD" class="thread-dropContainer thread-expanded"><span class="thread-drop"></span></div></span></span><ol id="bc_0_21TC" class="thread-chrome thread-expanded"><div><li id="bc_0_21B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/photo(7).jpg"></div><div id="c8452690805298033582" class="comment-block"><div id="bc_0_21M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/05364165160252633013">Equand</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515024025028#c8452690805298033582">January 3, 2018 at 4:00 PM</a></span></div><p id="bc_0_21MC" class="comment-content">FreeBSD is not impacted at all. At least for now.</p><span id="bc_0_21MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-1468700980"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=8452690805298033582">Delete</a></span></span></div><div id="bc_0_21BR" class="comment-replies"></div><div id="bc_0_21B_box" class="comment-replybox-single"></div></li><li id="bc_0_22B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/ARH.jpg"></div><div id="c6720752231412209557" class="comment-block"><div id="bc_0_22M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/11019963008669563400">Alireza Haghdoost</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515034734045#c6720752231412209557">January 3, 2018 at 6:58 PM</a></span></div><p id="bc_0_22MC" class="comment-content">Please elaborate more with technical details about your claim that freebsd is not impacted </p><span id="bc_0_22MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-1542024210"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=6720752231412209557">Delete</a></span></span></div><div id="bc_0_22BR" class="comment-replies"></div><div id="bc_0_22B_box" class="comment-replybox-single"></div></li><li id="bc_0_23B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c6047260701494662094" class="comment-block"><div id="bc_0_23M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/17671063747952328513">sebastian.alexander.schmidt</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515035418162#c6047260701494662094">January 3, 2018 at 7:10 PM</a></span></div><p id="bc_0_23MC" class="comment-content">Nope see: https://lists.freebsd.org/pipermail/freebsd-security/2018-January/009651.html</p><span id="bc_0_23MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-373089245"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=6047260701494662094">Delete</a></span></span></div><div id="bc_0_23BR" class="comment-replies"></div><div id="bc_0_23B_box" class="comment-replybox-single"></div></li><li id="bc_0_24B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/photo(8).jpg"></div><div id="c1415836744640630389" class="comment-block"><div id="bc_0_24M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/07900132592901750926">Chris Sprucefield</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515069970279#c1415836744640630389">January 4, 2018 at 4:46 AM</a></span></div><p id="bc_0_24MC" class="comment-content">"The FreeBSD Security Team recently learned of the details of these<br>issues that affect certain CPUs. Details could not be discussed<br>publicly, but mitigation work is in progress.<br><br>Work is ongoing to develop and commit these mitigations to the FreeBSD"<br><br>So, if FreeBSD is not impacted, why are they doing mitigation work and applying patches? <br>What you claim, doesn't seem to make any sense according to their statement? <br></p><span id="bc_0_24MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-1290045314"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=1415836744640630389">Delete</a></span></span></div><div id="bc_0_24BR" class="comment-replies"></div><div id="bc_0_24B_box" class="comment-replybox-single"></div></li></div><div id="bc_0_21I" class="continue" kind="ci"><a href="javascript:;" target="_self">Reply</a></div></ol><div id="bc_0_21T_box" class="comment-replybox-thread"></div></div></span></div><div id="bc_0_25B_box" class="comment-replybox-single"></div></li><li id="bc_0_26B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c138089837026034169" class="comment-block"><div id="bc_0_26M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/08146626034371688354">Michael J</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515023805393#c138089837026034169">January 3, 2018 at 3:56 PM</a></span></div><p id="bc_0_26MC" class="comment-content">Yeah find it strange why amd is being singled out, when they are least affected in this, and not at all affected for meltdown, which is what all the performance hitting patches are for.<br><br>(Not running amd cpus, but let’s be fair here)</p><span id="bc_0_26MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-137350061"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=138089837026034169">Delete</a></span></span></div><div id="bc_0_26BR" class="comment-replies"></div><div id="bc_0_26B_box" class="comment-replybox-single"></div></li><li id="bc_0_27B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c8572111276098465261" class="comment-block"><div id="bc_0_27M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/01161173717009806663">Acex222</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515023906130#c8572111276098465261">January 3, 2018 at 3:58 PM</a></span></div><p id="bc_0_27MC" class="comment-content">I see a lot of mentioning of Linux. Does OpenBSD handle the situation any better?</p><span id="bc_0_27MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-122658402"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=8572111276098465261">Delete</a></span></span></div><div id="bc_0_27BR" class="comment-replies"></div><div id="bc_0_27B_box" class="comment-replybox-single"></div></li><li id="bc_0_31B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/545218_aaafecb7.jpg"></div><div id="c5796706728859614654" class="comment-block"><div id="bc_0_31M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/13586568359146195305">Spacefish</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515030330865#c5796706728859614654">January 3, 2018 at 5:45 PM</a></span></div><p id="bc_0_31MC" class="comment-content">Would be nice to see some performance metrics out of the google datacenters with KPTI on/off..<br>IMHO this could be a big problem for Intel, as enterprise customers will demand compensation from them.</p><span id="bc_0_31MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-2133437392"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=5796706728859614654">Delete</a></span></span></div><div id="bc_0_31BR" class="comment-replies"><span id="bc_0_31b+seedtmPD" kind="d"><div id="bc_0_28T" class="comment-thread inline-thread" kind="t" t="0" u="0"><span id="bc_0_28TT" class="thread-toggle thread-expanded" kind="g"><span id="bc_0_28TA" class="thread-arrow"></span><span id="bc_0_28TN" class="thread-count"><span id="bc_0_28TNT" style="display: none;"></span><span id="bc_0_28TNU" style="display: none;"></span><a href="javascript:;" target="_self">Replies</a><div id="bc_0_28TD" class="thread-dropContainer thread-expanded"><span class="thread-drop"></span></div></span></span><ol id="bc_0_28TC" class="thread-chrome thread-expanded"><div><li id="bc_0_28B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c7428743444650004834" class="comment-block"><div id="bc_0_28M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/02514096425944070168">Hibiki Taisuna</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515059002804#c7428743444650004834">January 4, 2018 at 1:43 AM</a></span></div><p id="bc_0_28MC" class="comment-content">Even though it is not by Google, Phoronix did some performance testing with server and end user workload: https://www.phoronix.com/scan.php?page=article&amp;item=linux-kpti-kvm&amp;num=1</p><span id="bc_0_28MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-1772399751"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=7428743444650004834">Delete</a></span></span></div><div id="bc_0_28BR" class="comment-replies"></div><div id="bc_0_28B_box" class="comment-replybox-single"></div></li><li id="bc_0_29B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/photo(8).jpg"></div><div id="c5003941761442481900" class="comment-block"><div id="bc_0_29M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/07900132592901750926">Chris Sprucefield</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515070283565#c5003941761442481900">January 4, 2018 at 4:51 AM</a></span></div><p id="bc_0_29MC" class="comment-content">Never mind the future goodwill and trust impact on this one. <br>The Pentium calculus bug was pretty bad for them, but this makes everything else pale in comparison, and if the performance losses are as big as an average of 20%, then someone will demand quite some comp for that. <br><br>The spectre vulnerability seems to be more of a generic one, while bad, not as easy to actually do on a generic system where you don't know the current setup.<br><br>As for mitigating that one, it looks like you may have to make cache lines private to the process, rather than a shared general global space.</p><span id="bc_0_29MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-1290045314"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=5003941761442481900">Delete</a></span></span></div><div id="bc_0_29BR" class="comment-replies"></div><div id="bc_0_29B_box" class="comment-replybox-single"></div></li><li id="bc_0_30B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c511256723335818520" class="comment-block"><div id="bc_0_30M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/02716925755387178105">Nikolay</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515104631076#c511256723335818520">January 4, 2018 at 2:23 PM</a></span></div><p id="bc_0_30MC" class="comment-content">Info from Google for KPTI performance:<br><br>"On most of our workloads, including our cloud infrastructure, we see negligible impact on performance." <br><br>https://security.googleblog.com/2018/01/more-details-about-mitigations-for-cpu_4.html</p><span id="bc_0_30MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-74061795"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=511256723335818520">Delete</a></span></span></div><div id="bc_0_30BR" class="comment-replies"></div><div id="bc_0_30B_box" class="comment-replybox-single"></div></li></div><div id="bc_0_28I" class="continue" kind="ci"><a href="javascript:;" target="_self">Reply</a></div></ol><div id="bc_0_28T_box" class="comment-replybox-thread"></div></div></span></div><div id="bc_0_31B_box" class="comment-replybox-single"></div></li><li id="bc_0_33B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c3250872953343552729" class="comment-block"><div id="bc_0_33M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/13886296585847560301">Bruce</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515030388586#c3250872953343552729">January 3, 2018 at 5:46 PM</a></span></div><p id="bc_0_33MC" class="comment-content">I'm glad to see that Project Zero is willing to extend their 90-day deadline when the defect owners need extra time.</p><span id="bc_0_33MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-825317995"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=3250872953343552729">Delete</a></span></span></div><div id="bc_0_33BR" class="comment-replies"><span id="bc_0_33b+seedtmSD" kind="d"><div id="bc_0_32T" class="comment-thread inline-thread" kind="t" t="0" u="0"><span id="bc_0_32TT" class="thread-toggle thread-expanded" kind="g"><span id="bc_0_32TA" class="thread-arrow"></span><span id="bc_0_32TN" class="thread-count"><span id="bc_0_32TNT" style="display: none;"></span><span id="bc_0_32TNU" style="display: none;"></span><a href="javascript:;" target="_self">Replies</a><div id="bc_0_32TD" class="thread-dropContainer thread-expanded"><span class="thread-drop"></span></div></span></span><ol id="bc_0_32TC" class="thread-chrome thread-expanded"><div><li id="bc_0_32B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/photo(9).jpg"></div><div id="c6265843783786115850" class="comment-block"><div id="bc_0_32M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/07744590058377481669">Simon Waters</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515061339012#c6265843783786115850">January 4, 2018 at 2:22 AM</a></span></div><p id="bc_0_32MC" class="comment-content">They always said: "As always, we reserve the right to bring deadlines forwards or backwards based on extreme circumstances. "<br><br>I suspect three affected hardware vendors and nearly every OS vendors, it probably took them most of this time to notify everyone who needed to know.</p><span id="bc_0_32MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-845020604"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=6265843783786115850">Delete</a></span></span></div><div id="bc_0_32BR" class="comment-replies"></div><div id="bc_0_32B_box" class="comment-replybox-single"></div></li></div><div id="bc_0_32I" class="continue" kind="ci"><a href="javascript:;" target="_self">Reply</a></div></ol><div id="bc_0_32T_box" class="comment-replybox-thread"></div></div></span></div><div id="bc_0_33B_box" class="comment-replybox-single"></div></li><li id="bc_0_46B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c3702023949938729150" class="comment-block"><div id="bc_0_46M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/03935495190007473747">c4p0ne</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515034042369#c3702023949938729150">January 3, 2018 at 6:47 PM</a></span></div><p id="bc_0_46MC" class="comment-content">That AMD "is vulnerable" should NOT be believed for a single solitary nanosecond without empirical evidence of exploitation on AMD platforms. I could be wrong, but this WREAKS of Intel damage-control. That is to say, the "AMD is exploitable" line _may_ be an attempt to exploit human psychology in order to mitigate consumer-flight from Intel CPU's toward AMD's offering.... <br><br>Upon reading about the Intel bug and how AMD was not vulnerable (at first), the involuntary thought that immediately entered my own mind was "my next CPU is gonna be AMD. period." So what I'm saying is that in order to curb this rational impulse in consumers (given the severity of the bug), there MAY be a "push" to vilify AMD's chips to instill the feeling of "oh well, if they both have serious bugs, I may as well stay with what I'm using on my next purchase".</p><span id="bc_0_46MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1803158265"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=3702023949938729150">Delete</a></span></span></div><div id="bc_0_46BR" class="comment-replies"><span id="bc_0_46b+seedtmKD" kind="d"><div id="bc_0_34T" class="comment-thread inline-thread" kind="t" t="0" u="0"><span id="bc_0_34TT" class="thread-toggle thread-expanded" kind="g"><span id="bc_0_34TA" class="thread-arrow"></span><span id="bc_0_34TN" class="thread-count"><span id="bc_0_34TNT" style="display: none;"></span><span id="bc_0_34TNU" style="display: none;"></span><a href="javascript:;" target="_self">Replies</a><div id="bc_0_34TD" class="thread-dropContainer thread-expanded"><span class="thread-drop"></span></div></span></span><ol id="bc_0_34TC" class="thread-chrome thread-expanded"><div><li id="bc_0_34B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c4621809964577030989" class="comment-block"><div id="bc_0_34M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/09446608163075760165">Akaino</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515053248780#c4621809964577030989">January 4, 2018 at 12:07 AM</a></span></div><p id="bc_0_34MC" class="comment-content">Well, might be a valid assumption considering this: https://lkml.org/lkml/2017/12/27/2<br><br>More info in the comments over there: <br>https://news.ycombinator.com/item?id=16046636</p><span id="bc_0_34MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-1071630044"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=4621809964577030989">Delete</a></span></span></div><div id="bc_0_34BR" class="comment-replies"></div><div id="bc_0_34B_box" class="comment-replybox-single"></div></li><li id="bc_0_35B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c6924474143171565069" class="comment-block"><div id="bc_0_35M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/00204394471970362232">Denys Rtveliashvili</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515058806011#c6924474143171565069">January 4, 2018 at 1:40 AM</a></span></div><p id="bc_0_35MC" class="comment-content">"For a few Intel and AMD CPU models, we have exploits that work against real software."<br>What precisely is hard to comprehend in this sentence?</p><span id="bc_0_35MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-1337699363"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=6924474143171565069">Delete</a></span></span></div><div id="bc_0_35BR" class="comment-replies"></div><div id="bc_0_35B_box" class="comment-replybox-single"></div></li><li id="bc_0_36B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c6284377492295164961" class="comment-block"><div id="bc_0_36M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/02514096425944070168">Hibiki Taisuna</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515059126829#c6284377492295164961">January 4, 2018 at 1:45 AM</a></span></div><p id="bc_0_36MC" class="comment-content">I could exploit Spectre with the code example in the white paper on AMD.</p><span id="bc_0_36MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-1772399751"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=6284377492295164961">Delete</a></span></span></div><div id="bc_0_36BR" class="comment-replies"></div><div id="bc_0_36B_box" class="comment-replybox-single"></div></li><li id="bc_0_37B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c3160947669943313254" class="comment-block"><div id="bc_0_37M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/04319611595028970524">Unknown</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515078219668#c3160947669943313254">January 4, 2018 at 7:03 AM</a></span></div><p id="bc_0_37MC" class="comment-content">Everyone with a bit of tech background knows this. But I've seen a lot of business articles just copying Intel's 'all sides' argument.<br><br>I've never been an Intel fan, and how they handle this consolidates my view of them as a traditional 'evil' corp</p><span id="bc_0_37MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-707812780"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=3160947669943313254">Delete</a></span></span></div><div id="bc_0_37BR" class="comment-replies"></div><div id="bc_0_37B_box" class="comment-replybox-single"></div></li><li id="bc_0_38B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c7529941025260060615" class="comment-block"><div id="bc_0_38M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/02265485787642193724">fredex</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515079461024#c7529941025260060615">January 4, 2018 at 7:24 AM</a></span></div><p id="bc_0_38MC" class="comment-content">WREAKS ==&gt; REEKS<br>Two entirely different words, meaning to completely different things.</p><span id="bc_0_38MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-1448192863"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=7529941025260060615">Delete</a></span></span></div><div id="bc_0_38BR" class="comment-replies"></div><div id="bc_0_38B_box" class="comment-replybox-single"></div></li><li id="bc_0_39B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/photo(10).jpg"></div><div id="c2029551004604591823" class="comment-block"><div id="bc_0_39M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/14794907422663911605">Jeremy Corbello</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515090699932#c2029551004604591823">January 4, 2018 at 10:31 AM</a></span></div><p id="bc_0_39MC" class="comment-content">AMD themselves have reported that they are affected by 1 of the 3 vulnerabilities. <br>https://www.amd.com/en/corporate/speculative-execution</p><span id="bc_0_39MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-956758245"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=2029551004604591823">Delete</a></span></span></div><div id="bc_0_39BR" class="comment-replies"></div><div id="bc_0_39B_box" class="comment-replybox-single"></div></li><li id="bc_0_40B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c7893813268177997558" class="comment-block"><div id="bc_0_40M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/17784703847779922879">Unknown</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515090802872#c7893813268177997558">January 4, 2018 at 10:33 AM</a></span></div><p id="bc_0_40MC" class="comment-content">This couldn't have been said any better!</p><span id="bc_0_40MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-720995047"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=7893813268177997558">Delete</a></span></span></div><div id="bc_0_40BR" class="comment-replies"></div><div id="bc_0_40B_box" class="comment-replybox-single"></div></li><li id="bc_0_41B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c6221888973186274612" class="comment-block"><div id="bc_0_41M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/06432566211516609646">Peter</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515091156109#c6221888973186274612">January 4, 2018 at 10:39 AM</a></span></div><p id="bc_0_41MC" class="comment-content">"1. A PoC that demonstrates the basic principles behind variant 1 in userspace on the tested Intel Haswell Xeon CPU, the AMD FX CPU, the AMD PRO CPU and an ARM Cortex A57 [2]. This PoC only tests for the ability to read data inside mis-speculated execution within the same process, without crossing any privilege boundaries.<br><br>2. A PoC for variant 1 that, when running with normal user privileges under a modern Linux kernel with a distro-standard config, can perform arbitrary reads in a 4GiB range [3] in kernel virtual memory on the Intel Haswell Xeon CPU. If the kernel's BPF JIT is enabled (non-default configuration), it also works on the AMD PRO CPU. On the Intel Haswell Xeon CPU, kernel virtual memory can be read at a rate of around 2000 bytes per second after around 4 seconds of startup time. [4]"</p><span id="bc_0_41MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-1533064788"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=6221888973186274612">Delete</a></span></span></div><div id="bc_0_41BR" class="comment-replies"></div><div id="bc_0_41B_box" class="comment-replybox-single"></div></li><li id="bc_0_42B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/photo(3).jpg"></div><div id="c2085512598394721511" class="comment-block"><div id="bc_0_42M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/10845840475827162290">71Jay17</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515119683582#c2085512598394721511">January 4, 2018 at 6:34 PM</a></span></div><p id="bc_0_42MC" class="comment-content">It already exists.<br>https://spectreattack.com/spectre.pdf<br><br>Hardware 1.3 <br>"Hardware.We have empirically verified the vulnerability of several Intel processors to Spectre attacks,  including Ivy Bridge, Haswell and Skylake based processors. We  have  also  verified  the  attack’s  applicability to  AMD  Ryzen  CPUs. Finally,  we  have  also  successfully mounted Spectre attacks on several Samsung and Qualcomm processors (which use an ARM architecture)found in popular mobile phones."<br><br>They even use the word empirical.</p><span id="bc_0_42MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-1989363583"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=2085512598394721511">Delete</a></span></span></div><div id="bc_0_42BR" class="comment-replies"></div><div id="bc_0_42B_box" class="comment-replybox-single"></div></li><li id="bc_0_43B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/photo(11).jpg"></div><div id="c5198125571873172439" class="comment-block"><div id="bc_0_43M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/15919824353979973259">Clarence Smith</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515124775362#c5198125571873172439">January 4, 2018 at 7:59 PM</a></span></div><p id="bc_0_43MC" class="comment-content">My involuntary thought since I already have PCs I built on AMD is wondering if this vulnerability or the propose software OS update patch will even have any affect on my system.  The test AMD CPU used in this PoC is a lot newer than the AMD chips I use on my two desktop systems ie. AMD Opteron 185 and AMD Phenom II. <br><br>My other thought is how would the attacker get administrative permission to even execute code exploit.  Don't the current permissions in place still apply to when it comes to defending against any exploit.  Don't the ermission to read+execute need to happen first, and this blog post mentions nothing of any sort.  Who knows what these control testers were doing to try legitimately hack a PC. <br><br>With that in mind, the urgency for concern of this wans. </p><span id="bc_0_43MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-536865141"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=5198125571873172439">Delete</a></span></span></div><div id="bc_0_43BR" class="comment-replies"></div><div id="bc_0_43B_box" class="comment-replybox-single"></div></li><li id="bc_0_44B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c108692582115011333" class="comment-block"><div id="bc_0_44M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/04758119695379351518">Stephen Keen</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515253400344#c108692582115011333">January 6, 2018 at 7:43 AM</a></span></div><p id="bc_0_44MC" class="comment-content">"WREAKS ==&gt; REEKS<br>Two entirely different words, meaning to completely different things."<br><br>to ==&gt; two<br><br>If you're going to go around correcting others' spelling, then at least make sure your own passes muster, mkay?</p><span id="bc_0_44MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-1474371572"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=108692582115011333">Delete</a></span></span></div><div id="bc_0_44BR" class="comment-replies"></div><div id="bc_0_44B_box" class="comment-replybox-single"></div></li><li id="bc_0_45B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/photo(12).jpg"></div><div id="c5161319623650497743" class="comment-block"><div id="bc_0_45M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/15798210151450343469">BNP WJ</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515349239595#c5161319623650497743">January 7, 2018 at 10:20 AM</a></span></div><p id="bc_0_45MC" class="comment-content">Several AMD FX and at least one APU are affected.  And it is very easily exploited remotely.  I have no statistics except my machines.  Every Intel and AMD processor I have is attacked remotely almost every day.  Not sure if I get attacked more than the average person (it seems to me I should be a boring target to either criminal or state attackers) or if there is widespread (psychological) denial.  Many people who should be able to see and understand this stuff better than me still speak as if this is overblown.  <br><br>It's not.  It's real, it's far worse than the most paranoid security scenarios ever imagined, and if you aren't under constant attack then you either don't realize you are being attacked, or your turn hasn't come yet. <br><br>It certainly will; I am nobody and if I'm getting it this bad then I can only imagine that everyone is or will.  Perhaps it becomes harder to see with professional level training since professionals "know" even better than anyone that security disaster this bad "can't" happen.  But, unfortunately it has happened.  Every everything is darn near wide open and remotely exploitable.  <br><br>Still waiting for the running, screaming and hair on fire.  That is where we should be.  Time to disembark from our pleasure cruise on denial.</p><span id="bc_0_45MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-285885577"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=5161319623650497743">Delete</a></span></span></div><div id="bc_0_45BR" class="comment-replies"></div><div id="bc_0_45B_box" class="comment-replybox-single"></div></li></div><div id="bc_0_34I" class="continue" kind="ci"><a href="javascript:;" target="_self">Reply</a></div></ol><div id="bc_0_34T_box" class="comment-replybox-thread"></div></div></span></div><div id="bc_0_46B_box" class="comment-replybox-single"></div></li><li id="bc_0_47B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c2177968161024038054" class="comment-block"><div id="bc_0_47M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/05782220189881739573">Unknown</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515046769709#c2177968161024038054">January 3, 2018 at 10:19 PM</a></span></div><p id="bc_0_47MC" class="comment-content">That's horrible! What does this mean for ordinary users?</p><span id="bc_0_47MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-161566169"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=2177968161024038054">Delete</a></span></span></div><div id="bc_0_47BR" class="comment-replies"></div><div id="bc_0_47B_box" class="comment-replybox-single"></div></li><li id="bc_0_49B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c3922612046928760190" class="comment-block"><div id="bc_0_49M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/09395929012624525246">SeventhSon Sidorov</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515057659518#c3922612046928760190">January 4, 2018 at 1:20 AM</a></span></div><p id="bc_0_49MC" class="comment-content">I said to myself "my next CPU is gonna be AMD" after Intel Hyper-threading trick.</p><span id="bc_0_49MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1358838285"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=3922612046928760190">Delete</a></span></span></div><div id="bc_0_49BR" class="comment-replies"><span id="bc_0_49b+seedtm3D" kind="d"><div id="bc_0_48T" class="comment-thread inline-thread" kind="t" t="0" u="0"><span id="bc_0_48TT" class="thread-toggle thread-expanded" kind="g"><span id="bc_0_48TA" class="thread-arrow"></span><span id="bc_0_48TN" class="thread-count"><span id="bc_0_48TNT" style="display: none;"></span><span id="bc_0_48TNU" style="display: none;"></span><a href="javascript:;" target="_self">Replies</a><div id="bc_0_48TD" class="thread-dropContainer thread-expanded"><span class="thread-drop"></span></div></span></span><ol id="bc_0_48TC" class="thread-chrome thread-expanded"><div><li id="bc_0_48B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/photo(11).jpg"></div><div id="c4650227636202424871" class="comment-block"><div id="bc_0_48M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/15919824353979973259">Clarence Smith</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515124933429#c4650227636202424871">January 4, 2018 at 8:02 PM</a></span></div><p id="bc_0_48MC" class="comment-content">Two of my desktop computers are already AMD.  I'm thinking of adding VIA to the mix, if they still make desktop CPUs like I remember in the early 2000s.</p><span id="bc_0_48MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-536865141"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=4650227636202424871">Delete</a></span></span></div><div id="bc_0_48BR" class="comment-replies"></div><div id="bc_0_48B_box" class="comment-replybox-single"></div></li></div><div id="bc_0_48I" class="continue" kind="ci"><a href="javascript:;" target="_self">Reply</a></div></ol><div id="bc_0_48T_box" class="comment-replybox-thread"></div></div></span></div><div id="bc_0_49B_box" class="comment-replybox-single"></div></li><li id="bc_0_50B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/photo(13).jpg"></div><div id="c2838877153992131097" class="comment-block"><div id="bc_0_50M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/00395815280566122938">Colin Pitrat</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515060507204#c2838877153992131097">January 4, 2018 at 2:08 AM</a></span></div><p id="bc_0_50MC" class="comment-content">"this rational impulse" =&gt; this irrational impulse<br>We're talking about a single flaw. Deciding to switch from an anecdotical fact is not rational (without more data suggesting the alternative is better) !</p><span id="bc_0_50MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1625765668"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=2838877153992131097">Delete</a></span></span></div><div id="bc_0_50BR" class="comment-replies"></div><div id="bc_0_50B_box" class="comment-replybox-single"></div></li><li id="bc_0_51B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/desk.jpg"></div><div id="c8207466094648191610" class="comment-block"><div id="bc_0_51M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/05110042278054177075">Dan G</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515063560938#c8207466094648191610">January 4, 2018 at 2:59 AM</a></span></div><p id="bc_0_51MC" class="comment-content">From reading GPZ, Spectre, Meltdown and Fogh, it appears that the side-execution attacks are possible on all modern CPUs, but have only been successfully exploited on Intel chips, quite possibly because of the designs they use which make them the most performant. AMD and ARM are harder to exploit because they lack the hardware which in part gives Intel its performance edge.<br><br>Some of the attacks appear exploitable through JavaScript loadable through a webpage in Chrome. It's probably possible through Firefox, Edge, and Safari too. It could read out your passwords. That's pretty devastating.<br><br>Some also allow containerised software access to all the other containers on a physical host, including those on cloud infrastructure. Again, pretty devastating. Google say that have mitigated that threat on their infrastructure (I wonder how?); have others?<br><br>I note that the research exposing these attacks was in large part funded by the EU!</p><span id="bc_0_51MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-454150743"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=8207466094648191610">Delete</a></span></span></div><div id="bc_0_51BR" class="comment-replies"></div><div id="bc_0_51B_box" class="comment-replybox-single"></div></li><li id="bc_0_52B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c5904482337926457589" class="comment-block"><div id="bc_0_52M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/16626321724759680659">Sadies</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515067133779#c5904482337926457589">January 4, 2018 at 3:58 AM</a></span></div><p id="bc_0_52MC" class="comment-content">Well, I’m glad you understand it. I think I shall have to wait for the idiot’s patch!</p><span id="bc_0_52MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1710541185"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=5904482337926457589">Delete</a></span></span></div><div id="bc_0_52BR" class="comment-replies"></div><div id="bc_0_52B_box" class="comment-replybox-single"></div></li><li id="bc_0_53B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c1107761947744486687" class="comment-block"><div id="bc_0_53M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/11501625256059457499">Rowan Collins</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515073038571#c1107761947744486687">January 4, 2018 at 5:37 AM</a></span></div><p id="bc_0_53MC" class="comment-content">I think the general claim is that even if AMD is not vulnerable to the specific attacks identified so far, their architecture implements similar features that may well be subject to similar exploits in future. So swapping Intel CPUs for AMD ones *today* would indeed reduce your vulnerability, but switching to an AMD processor *next year* would not. On the one hand, the Intel-specific attack will have been mitigated in software in the meantime; and on the other, an AMD-specific attack may be discovered later.<br><br>The only reason to switch to AMD in the long term would be if they could demonstrate that their architecture design process is superior, such that exploits like this are significantly less likely. However, given the complexity of modern processors, it would be completely unsurprising if a new family of exploits was discovered that nobody knew to design against.</p><span id="bc_0_53MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-554412158"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=1107761947744486687">Delete</a></span></span></div><div id="bc_0_53BR" class="comment-replies"></div><div id="bc_0_53B_box" class="comment-replybox-single"></div></li><li id="bc_0_54B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/photo(14).jpg"></div><div id="c5714685950523587542" class="comment-block"><div id="bc_0_54M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/17516817556853122034">kpematopa e na sofia</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515073552569#c5714685950523587542">January 4, 2018 at 5:45 AM</a></span></div><p id="bc_0_54MC" class="comment-content">what about UEK? Is it affected?</p><span id="bc_0_54MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-695123664"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=5714685950523587542">Delete</a></span></span></div><div id="bc_0_54BR" class="comment-replies"></div><div id="bc_0_54B_box" class="comment-replybox-single"></div></li><li id="bc_0_56B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c6440907833255218864" class="comment-block"><div id="bc_0_56M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/14441065746676177611">sfw2008</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515074588314#c6440907833255218864">January 4, 2018 at 6:03 AM</a></span></div><p id="bc_0_56MC" class="comment-content">It's funny how Project Zero is researching Intel and AMD processors looking for vulnerabilities when this team still hasn't fixed the Android WiFi Direct vulnerability!  <br><br>Going on 3 years and still no fix!<br><br>https://threatpost.com/android-wi-fi-direct-vulnerability-details-disclosed/110650/<br><br>Project Zero team, maybe you should work on fixing internal bugs instead of those of other companies!</p><span id="bc_0_56MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1047262911"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=6440907833255218864">Delete</a></span></span></div><div id="bc_0_56BR" class="comment-replies"><span id="bc_0_56b+seedtnhD" kind="d"><div id="bc_0_55T" class="comment-thread inline-thread" kind="t" t="0" u="0"><span id="bc_0_55TT" class="thread-toggle thread-expanded" kind="g"><span id="bc_0_55TA" class="thread-arrow"></span><span id="bc_0_55TN" class="thread-count"><span id="bc_0_55TNT" style="display: none;"></span><span id="bc_0_55TNU" style="display: none;"></span><a href="javascript:;" target="_self">Replies</a><div id="bc_0_55TD" class="thread-dropContainer thread-expanded"><span class="thread-drop"></span></div></span></span><ol id="bc_0_55TC" class="thread-chrome thread-expanded"><div><li id="bc_0_55B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/photo(15).jpg"></div><div id="c62942650886674319" class="comment-block"><div id="bc_0_55M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/01993185823702529356">Yet Again</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515868666632#c62942650886674319">January 13, 2018 at 10:37 AM</a></span></div><p id="bc_0_55MC" class="comment-content">Your own source specifies that "Android 5.0.1 and 5.0.2 are not vulnerable, according to the advisory." i.e. all versions of Android still supported by google at the moment (Lollipop except 5.0.x, Marshmallow, Nougat and Oreo) aren't affected by the Wifi Direct vulnerability.</p><span id="bc_0_55MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-1490421540"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=62942650886674319">Delete</a></span></span></div><div id="bc_0_55BR" class="comment-replies"></div><div id="bc_0_55B_box" class="comment-replybox-single"></div></li></div><div id="bc_0_55I" class="continue" kind="ci"><a href="javascript:;" target="_self">Reply</a></div></ol><div id="bc_0_55T_box" class="comment-replybox-thread"></div></div></span></div><div id="bc_0_56B_box" class="comment-replybox-single"></div></li><li id="bc_0_57B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c5332354702675792868" class="comment-block"><div id="bc_0_57M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/07078172730540310601">nikolayo</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515075360713#c5332354702675792868">January 4, 2018 at 6:16 AM</a></span></div><p id="bc_0_57MC" class="comment-content">All these attacks appear to depend on access to the high resolution "timestamp counter" of the CPU. This makes me wonder what would be the negative impact of making the related instructions privileged. Philosophically speaking this sounds as a good idea because it isolates the logical model of computation from access to the real world time.</p><span id="bc_0_57MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-664025971"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=5332354702675792868">Delete</a></span></span></div><div id="bc_0_57BR" class="comment-replies"></div><div id="bc_0_57B_box" class="comment-replybox-single"></div></li><li id="bc_0_58B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c2183774660356855812" class="comment-block"><div id="bc_0_58M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/01875820203679277116">Marco</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515076485151#c2183774660356855812">January 4, 2018 at 6:34 AM</a></span></div><p id="bc_0_58MC" class="comment-content">Interesting, but not surprised. Since years I routinely deactivate all prefetching systems forcthe CPU in BIOS. At least on VM hosts. I would like to know if such a system is still vulnerable.<br><br>Why I did that? I observed severe performance hits with high virtualizazion ratios. I suspected pipeline trashing and or malallocation of fake HT cores. We had VMS getting scheduled on two fakes (HT cores). They performed bad, but also crippled the VM running on the two real cores.<br><br>Disabling HT resulted in 2x faster response times.<br><br>Disabling PREFETCH (IP and Data) resulted in another 3x faster response.<br><br>JIRA Kanban board (a large one)<br><br>Systems that exhibited performance issues where disk was suspected were recovering and ran smoothly ever after without touching any outside system. (MSExchange)<br><br>HPE has the hints to disable prefetch in their tuning guides for low latency systems.</p><span id="bc_0_58MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1502435259"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=2183774660356855812">Delete</a></span></span></div><div id="bc_0_58BR" class="comment-replies"></div><div id="bc_0_58B_box" class="comment-replybox-single"></div></li><li id="bc_0_59B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c8162275856452847779" class="comment-block"><div id="bc_0_59M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/08977098164422796580">adx</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515078564282#c8162275856452847779">January 4, 2018 at 7:09 AM</a></span></div><p id="bc_0_59MC" class="comment-content">I tried replicating something along the lines of PoC 1 (in BASIC of all things), but couldn't get it to read the memory speculatively on an i7-860 from what I could see (it does reliably detect the cache misses when it is in proper code flow). Coming here I see I might need to learn more about branch prediction, I barely know what I'm doing. But after seeing news of this earlier today and reading the papers I thought it sounds worryingly easy, so the fact I got this far starting from scratch in a little over 3 hours (and if it had speculatively executed the read, I would have detected it) is kind of scary.</p><span id="bc_0_59MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1014491555"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=8162275856452847779">Delete</a></span></span></div><div id="bc_0_59BR" class="comment-replies"></div><div id="bc_0_59B_box" class="comment-replybox-single"></div></li><li id="bc_0_61B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c8307820975979548028" class="comment-block"><div id="bc_0_61M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/07078172730540310601">nikolayo</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515078582053#c8307820975979548028">January 4, 2018 at 7:09 AM</a></span></div><p id="bc_0_61MC" class="comment-content"> Philosophically speaking the root cause for these "bugs" is : program access to fine grained real time information breaks the abstraction of sequential execution. So I wonder whether depriving user space programs of access to such information could solve or at least mitigate the problem. What if e.g. instructions for access to the CPU "timestamp counter" are made privileged and OS - supported timers have sufficiently low resolution?</p><span id="bc_0_61MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-664025971"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=8307820975979548028">Delete</a></span></span></div><div id="bc_0_61BR" class="comment-replies"><span id="bc_0_61b+seedtm4D" kind="d"><div id="bc_0_60T" class="comment-thread inline-thread" kind="t" t="0" u="0"><span id="bc_0_60TT" class="thread-toggle thread-expanded" kind="g"><span id="bc_0_60TA" class="thread-arrow"></span><span id="bc_0_60TN" class="thread-count"><span id="bc_0_60TNT" style="display: none;"></span><span id="bc_0_60TNU" style="display: none;"></span><a href="javascript:;" target="_self">Replies</a><div id="bc_0_60TD" class="thread-dropContainer thread-expanded"><span class="thread-drop"></span></div></span></span><ol id="bc_0_60TC" class="thread-chrome thread-expanded"><div><li id="bc_0_60B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c1780351237922037841" class="comment-block"><div id="bc_0_60M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/14289675575382598584">MK</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515128914623#c1780351237922037841">January 4, 2018 at 9:08 PM</a></span></div><p id="bc_0_60MC" class="comment-content">Unfortunately it would be a simple matter to repeat each test enough times that a coarse-grained clock would still show the difference, so such a change would only slow an attack down, not stop it.<br></p><span id="bc_0_60MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-28783640"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=1780351237922037841">Delete</a></span></span></div><div id="bc_0_60BR" class="comment-replies"></div><div id="bc_0_60B_box" class="comment-replybox-single"></div></li></div><div id="bc_0_60I" class="continue" kind="ci"><a href="javascript:;" target="_self">Reply</a></div></ol><div id="bc_0_60T_box" class="comment-replybox-thread"></div></div></span></div><div id="bc_0_61B_box" class="comment-replybox-single"></div></li><li id="bc_0_62B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/photo(16).jpg"></div><div id="c8056760102318684239" class="comment-block"><div id="bc_0_62M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/11930793690094140214">adventuretimeh 2</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515095026122#c8056760102318684239">January 4, 2018 at 11:43 AM</a></span></div><p id="bc_0_62MC" class="comment-content"><br>I have just received an update of the Windows KB4056892 patch but making a benchmark I noticed that the score is decreased and that is 4691 step in single-core at 4629 instead in multi-core I passed 12588 to 12483 and I have an intel-core i5 of 7th generation with NVIDIA GeForce GT 1030,</p><span id="bc_0_62MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1506945407"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=8056760102318684239">Delete</a></span></span></div><div id="bc_0_62BR" class="comment-replies"></div><div id="bc_0_62B_box" class="comment-replybox-single"></div></li><li id="bc_0_64B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c2879295379477186427" class="comment-block"><div id="bc_0_64M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/11279965544532010097">Unknown</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515095216381#c2879295379477186427">January 4, 2018 at 11:46 AM</a></span></div><p id="bc_0_64MC" class="comment-content">Is there a possibility of getting some dates put on the research articles from Daniel Gruss, Moritz Lipp, et al?<br><br>Seems a little odd that there aren't any dates on those papers other than the reference material. Wouldn't mind knowing when they published those papers.</p><span id="bc_0_64MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-496185878"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=2879295379477186427">Delete</a></span></span></div><div id="bc_0_64BR" class="comment-replies"><span id="bc_0_64b+seedtniD" kind="d"><div id="bc_0_63T" class="comment-thread inline-thread" kind="t" t="0" u="0"><span id="bc_0_63TT" class="thread-toggle thread-expanded" kind="g"><span id="bc_0_63TA" class="thread-arrow"></span><span id="bc_0_63TN" class="thread-count"><span id="bc_0_63TNT" style="display: none;"></span><span id="bc_0_63TNU" style="display: none;"></span><a href="javascript:;" target="_self">Replies</a><div id="bc_0_63TD" class="thread-dropContainer thread-expanded"><span class="thread-drop"></span></div></span></span><ol id="bc_0_63TC" class="thread-chrome thread-expanded"><div><li id="bc_0_63B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/photo(15).jpg"></div><div id="c6210824591003501536" class="comment-block"><div id="bc_0_63M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/01993185823702529356">Yet Again</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515869280765#c6210824591003501536">January 13, 2018 at 10:48 AM</a></span></div><p id="bc_0_63MC" class="comment-content">Ditto, the year and also where it was published (or technical paper if not in conference proceedings or journal), because even some of the co-authors cite  Kocher &amp; al. without any date or venue c.f. reference [19] in https://meltdownattack.com/meltdown.pdf</p><span id="bc_0_63MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-1490421540"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=6210824591003501536">Delete</a></span></span></div><div id="bc_0_63BR" class="comment-replies"></div><div id="bc_0_63B_box" class="comment-replybox-single"></div></li></div><div id="bc_0_63I" class="continue" kind="ci"><a href="javascript:;" target="_self">Reply</a></div></ol><div id="bc_0_63T_box" class="comment-replybox-thread"></div></div></span></div><div id="bc_0_64B_box" class="comment-replybox-single"></div></li><li id="bc_0_66B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/kenatsun97.gif"></div><div id="c7935716908800547615" class="comment-block"><div id="bc_0_66M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/07214879671853081697">Ken Zheng</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515095674956#c7935716908800547615">January 4, 2018 at 11:54 AM</a></span></div><p id="bc_0_66MC" class="comment-content">Intel should issue a "recall".</p><span id="bc_0_66MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-2052801987"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=7935716908800547615">Delete</a></span></span></div><div id="bc_0_66BR" class="comment-replies"><span id="bc_0_66b+seedtmsD" kind="d"><div id="bc_0_65T" class="comment-thread inline-thread" kind="t" t="0" u="0"><span id="bc_0_65TT" class="thread-toggle thread-expanded" kind="g"><span id="bc_0_65TA" class="thread-arrow"></span><span id="bc_0_65TN" class="thread-count"><span id="bc_0_65TNT" style="display: none;"></span><span id="bc_0_65TNU" style="display: none;"></span><a href="javascript:;" target="_self">Replies</a><div id="bc_0_65TD" class="thread-dropContainer thread-expanded"><span class="thread-drop"></span></div></span></span><ol id="bc_0_65TC" class="thread-chrome thread-expanded"><div><li id="bc_0_65B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c2558766068452496902" class="comment-block"><div id="bc_0_65M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/07283242419328574552">Unknown</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515107307257#c2558766068452496902">January 4, 2018 at 3:08 PM</a></span></div><p id="bc_0_65MC" class="comment-content">The problem is that the vulnerability has existed in their CPUs since the 90s. Effectively, every device running an intel cpu is compromised.<br>This will probably have a long tail end, as many older machines which will never or cannot be updated will remain exposed for decades.</p><span id="bc_0_65MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-1025473413"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=2558766068452496902">Delete</a></span></span></div><div id="bc_0_65BR" class="comment-replies"></div><div id="bc_0_65B_box" class="comment-replybox-single"></div></li></div><div id="bc_0_65I" class="continue" kind="ci"><a href="javascript:;" target="_self">Reply</a></div></ol><div id="bc_0_65T_box" class="comment-replybox-thread"></div></div></span></div><div id="bc_0_66B_box" class="comment-replybox-single"></div></li><li id="bc_0_67B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c4923121180493565950" class="comment-block"><div id="bc_0_67M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/07627329866749684881">Unknown</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515098069016#c4923121180493565950">January 4, 2018 at 12:34 PM</a></span></div><p id="bc_0_67MC" class="comment-content">Are you sure about the mapping from variant 1/2/3 to Meltdown/Spectre? Looking at the description of Meltdown on the Cyberus blog (http://blog.cyberus-technology.de/posts/2018-01-03-meltdown.html), it seems to correspond to variant 1 (and maybe 2, not sure) as described here (not variant 3).</p><span id="bc_0_67MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1159231711"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=4923121180493565950">Delete</a></span></span></div><div id="bc_0_67BR" class="comment-replies"></div><div id="bc_0_67B_box" class="comment-replybox-single"></div></li><li id="bc_0_68B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c6351900027641169862" class="comment-block"><div id="bc_0_68M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/15011836855669376603">Ken</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515103527055#c6351900027641169862">January 4, 2018 at 2:05 PM</a></span></div><p id="bc_0_68MC" class="comment-content">This is going to be interesting to see how this plays out in a month.  FDIV was bad, I was there but it was self inflicted by how Intel handled it.  But this seems like it has way more legal, political and customer relations pathways and the fact that it impacts way more products and it seems like it's not limited to just Intel.  As more and more people get their head around this type of attack methodology and apply it to more parts of the CPU and different CPUs, GPUs, etc more products will fall.  So right now, batten down the hatches, we are going for a ride...</p><span id="bc_0_68MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-740013729"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=6351900027641169862">Delete</a></span></span></div><div id="bc_0_68BR" class="comment-replies"></div><div id="bc_0_68B_box" class="comment-replybox-single"></div></li><li id="bc_0_69B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c2488198985945310456" class="comment-block"><div id="bc_0_69M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/06923837085602918625">David F.</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515107620674#c2488198985945310456">January 4, 2018 at 3:13 PM</a></span></div><p id="bc_0_69MC" class="comment-content">What does the timing code use?  rdtsc ? cpuid ?</p><span id="bc_0_69MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-799272630"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=2488198985945310456">Delete</a></span></span></div><div id="bc_0_69BR" class="comment-replies"></div><div id="bc_0_69B_box" class="comment-replybox-single"></div></li><li id="bc_0_71B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c5349933284480985986" class="comment-block"><div id="bc_0_71M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/06923837085602918625">David F.</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515107956956#c5349933284480985986">January 4, 2018 at 3:19 PM</a></span></div><p id="bc_0_71MC" class="comment-content">What is used for timing?  rdtsc with cpuid?  (authorize this one as it will notify me of updates).</p><span id="bc_0_71MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-799272630"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=5349933284480985986">Delete</a></span></span></div><div id="bc_0_71BR" class="comment-replies"><span id="bc_0_71b+seedtm5D" kind="d"><div id="bc_0_70T" class="comment-thread inline-thread" kind="t" t="0" u="0"><span id="bc_0_70TT" class="thread-toggle thread-expanded" kind="g"><span id="bc_0_70TA" class="thread-arrow"></span><span id="bc_0_70TN" class="thread-count"><span id="bc_0_70TNT" style="display: none;"></span><span id="bc_0_70TNU" style="display: none;"></span><a href="javascript:;" target="_self">Replies</a><div id="bc_0_70TD" class="thread-dropContainer thread-expanded"><span class="thread-drop"></span></div></span></span><ol id="bc_0_70TC" class="thread-chrome thread-expanded"><div><li id="bc_0_70B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c3412520428104682520" class="comment-block"><div id="bc_0_70M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/00032972068093102766">Christoph Hack</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515144826122#c3412520428104682520">January 5, 2018 at 1:33 AM</a></span></div><p id="bc_0_70MC" class="comment-content">Depends. The JavaScript version of the spectre attack uses a separate webworker that increases a value in a tight loop to simulate a good-enough clock. (access to rdtsc is restricted and Chrome already decreases the accuracy of performance.now())</p><span id="bc_0_70MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-2113079403"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=3412520428104682520">Delete</a></span></span></div><div id="bc_0_70BR" class="comment-replies"></div><div id="bc_0_70B_box" class="comment-replybox-single"></div></li></div><div id="bc_0_70I" class="continue" kind="ci"><a href="javascript:;" target="_self">Reply</a></div></ol><div id="bc_0_70T_box" class="comment-replybox-thread"></div></div></span></div><div id="bc_0_71B_box" class="comment-replybox-single"></div></li><li id="bc_0_72B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c6111288264547472575" class="comment-block"><div id="bc_0_72M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/09135953864733039772">Kold</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515119251750#c6111288264547472575">January 4, 2018 at 6:27 PM</a></span></div><p id="bc_0_72MC" class="comment-content">Passwords, SSNs, credit cards are nothing. Imagine getting the private key from banking institutions, government entities etc. Being able to decrpyt all data to and from these entities would be world changing. HTTPS would become pointless, and everything anyone does with the entity that was compromised would be readable. That is devastating.</p><span id="bc_0_72MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1860006626"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=6111288264547472575">Delete</a></span></span></div><div id="bc_0_72BR" class="comment-replies"></div><div id="bc_0_72B_box" class="comment-replybox-single"></div></li><li id="bc_0_73B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c65915222006915742" class="comment-block"><div id="bc_0_73M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/08977098164422796580">adx</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515119699058#c65915222006915742">January 4, 2018 at 6:34 PM</a></span></div><p id="bc_0_73MC" class="comment-content">I used rdtscp in my test above. I just tried on a C2D which didn't like that, 'prefixing' rdtsc with cpuid worked. Couldn't confirm speculative accesses on the C2D either (see my post above) but I think I'm just doing it wrong. I had modelled it on my understanding of Meltdown, but my test is more like Spectre because I'm abusing the branch predictor (incompetently).<br><br>Compare that to the statement in the Meltdown paper that they didn't get it working on AMD simply because it didn't - I'm not calling them incompetent but if they don't know why it didn't work and think it might work, then that's the last type of good news wanted by AMD (or ARM).<br><br>It really is a rather simple (and fundamental) issue, there has been a grey cloud hanging over speculative execution since it was conceived (imagine the horrors it could wreak on memory-mapped I/O), but now that engineering curio has become a Problem I can't really see a way out other than locking out all forms of timing from untrusted code, including the ability to run raw code at full speed. That is the inverse of where all these JIT VMs have taken us. It's sort of like the perfect storm. Complexity, speed, determinism.</p><span id="bc_0_73MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1014491555"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=65915222006915742">Delete</a></span></span></div><div id="bc_0_73BR" class="comment-replies"></div><div id="bc_0_73B_box" class="comment-replybox-single"></div></li><li id="bc_0_74B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/photo(17).jpg"></div><div id="c6104991461932130377" class="comment-block"><div id="bc_0_74M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/16542571270346691636">Belly Knots</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515122200103#c6104991461932130377">January 4, 2018 at 7:16 PM</a></span></div><p id="bc_0_74MC" class="comment-content">There are more ways than this to access kernel space. These cache buffer reads are Tre cool. But what of the sys call kernel internals that link kernel and userland? The kernels memory manager calls on Linux can also be called from userland using similar buffer techniques.</p><span id="bc_0_74MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-426620607"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=6104991461932130377">Delete</a></span></span></div><div id="bc_0_74BR" class="comment-replies"></div><div id="bc_0_74B_box" class="comment-replybox-single"></div></li><li id="bc_0_77B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/photo(18).jpg"></div><div id="c7907054412518878119" class="comment-block"><div id="bc_0_77M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/17655844911964509212">Sandeep Kumar Pyaraka</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515122416881#c7907054412518878119">January 4, 2018 at 7:20 PM</a></span></div><p id="bc_0_77MC" class="comment-content">Out of my curiosity are SPARC CPU, HP PA and IBM POWER architectures are also found vulnerable to this flaw? Because many Legacy Banks and very old organizations still rely on the hardware that runs IBM AIX, HP UNIX, and Oracle {Legacy SUN} Solaris infrastructure. There should always be a patch or method of prevention from the respective vendors.. and this is a never ending learning cycle.</p><span id="bc_0_77MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1576262237"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=7907054412518878119">Delete</a></span></span></div><div id="bc_0_77BR" class="comment-replies"><span id="bc_0_77b+seedtnAD" kind="d"><div id="bc_0_75T" class="comment-thread inline-thread" kind="t" t="0" u="0"><span id="bc_0_75TT" class="thread-toggle thread-expanded" kind="g"><span id="bc_0_75TA" class="thread-arrow"></span><span id="bc_0_75TN" class="thread-count"><span id="bc_0_75TNT" style="display: none;"></span><span id="bc_0_75TNU" style="display: none;"></span><a href="javascript:;" target="_self">Replies</a><div id="bc_0_75TD" class="thread-dropContainer thread-expanded"><span class="thread-drop"></span></div></span></span><ol id="bc_0_75TC" class="thread-chrome thread-expanded"><div><li id="bc_0_75B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c4089607114020839367" class="comment-block"><div id="bc_0_75M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/02841258206889517140">str</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515226297639#c4089607114020839367">January 6, 2018 at 12:11 AM</a></span></div><p id="bc_0_75MC" class="comment-content">if attacker will be able run to code on these system it can't help them anyway.</p><span id="bc_0_75MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-1255526261"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=4089607114020839367">Delete</a></span></span></div><div id="bc_0_75BR" class="comment-replies"></div><div id="bc_0_75B_box" class="comment-replybox-single"></div></li><li id="bc_0_76B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/photo(19).jpg"></div><div id="c364671465516541006" class="comment-block"><div id="bc_0_76M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/15509008655459723259">Xuanjun Si</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515252838838#c364671465516541006">January 6, 2018 at 7:33 AM</a></span></div><p id="bc_0_76MC" class="comment-content">https://www.ibm.com/blogs/psirt/potential-impact-processors-power-family/ </p><span id="bc_0_76MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-1812866546"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=364671465516541006">Delete</a></span></span></div><div id="bc_0_76BR" class="comment-replies"></div><div id="bc_0_76B_box" class="comment-replybox-single"></div></li></div><div id="bc_0_75I" class="continue" kind="ci"><a href="javascript:;" target="_self">Reply</a></div></ol><div id="bc_0_75T_box" class="comment-replybox-thread"></div></div></span></div><div id="bc_0_77B_box" class="comment-replybox-single"></div></li><li id="bc_0_78B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c1033424649309359369" class="comment-block"><div id="bc_0_78M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/18139932078636405349">андрей шемякин</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515123635008#c1033424649309359369">January 4, 2018 at 7:40 PM</a></span></div><p id="bc_0_78MC" class="comment-content">arm64.<br>how a53 no problem?<br>a53 a57 this armv8.</p><span id="bc_0_78MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-621843416"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=1033424649309359369">Delete</a></span></span></div><div id="bc_0_78BR" class="comment-replies"></div><div id="bc_0_78B_box" class="comment-replybox-single"></div></li><li id="bc_0_79B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c4754441366618484823" class="comment-block"><div id="bc_0_79M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/00415051552964835755">Vigar</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515147176303#c4754441366618484823">January 5, 2018 at 2:12 AM</a></span></div><p id="bc_0_79MC" class="comment-content">Well the browser developers begin to turn a little bit @ the timeing functions for js. A little help but this here will get into a full patch and reroll verions roulette.<br><br>Hard to detect error - good that it has been posted now.</p><span id="bc_0_79MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-570032854"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=4754441366618484823">Delete</a></span></span></div><div id="bc_0_79BR" class="comment-replies"></div><div id="bc_0_79B_box" class="comment-replybox-single"></div></li><li id="bc_0_80B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c1120784762805780592" class="comment-block"><div id="bc_0_80M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/10950533743426480312">Domain Junkie</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515166540879#c1120784762805780592">January 5, 2018 at 7:35 AM</a></span></div><p id="bc_0_80MC" class="comment-content">If this vulnerabilities are for hardware Intel Chips, for example we have patched the physical Host machine, hosting Virtual machines, is it still necessary to patch the VM's (using virtualized CPU) riding on the physical host that has been patched?</p><span id="bc_0_80MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1644921291"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=1120784762805780592">Delete</a></span></span></div><div id="bc_0_80BR" class="comment-replies"></div><div id="bc_0_80B_box" class="comment-replybox-single"></div></li><li id="bc_0_81B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c3399190143643690882" class="comment-block"><div id="bc_0_81M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/09801029434152890444">Eureka !!!!!</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515201737390#c3399190143643690882">January 5, 2018 at 5:22 PM</a></span></div><p id="bc_0_81MC" class="comment-content">Hi,<br>We are trying to evaluate the possibility of this attack on the below Middleware products:<br>1) IBM WebSphere Application Server<br>2) IBM WebSphere MQ<br>3) IBM Message Broker<br>4) Redhat JWS Tomcat<br>5) Redhat Directory Server<br>6) Oracle Directory Server<br>7) CA Siteminder<br>8) OpenAM ForgeRock<br>9) Oracle WebLogic<br>10) Other Oracle Products like ORMB, OID etc.<br><br>Does this vulnerability affects any of these products?</p><span id="bc_0_81MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-646159601"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=3399190143643690882">Delete</a></span></span></div><div id="bc_0_81BR" class="comment-replies"></div><div id="bc_0_81B_box" class="comment-replybox-single"></div></li><li id="bc_0_82B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c960636250519657242" class="comment-block"><div id="bc_0_82M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/12192702207978448664">Jatin</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515253355606#c960636250519657242">January 6, 2018 at 7:42 AM</a></span></div><p id="bc_0_82MC" class="comment-content">Control point integrity which moves the code pointers (indirect call pointers and return addresses over stack) to a safe shadow memory having a "RO" permissions should be helpful in combating such attacks. Are any PoC done over Intel's SGX extension.</p><span id="bc_0_82MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-516503568"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=960636250519657242">Delete</a></span></span></div><div id="bc_0_82BR" class="comment-replies"></div><div id="bc_0_82B_box" class="comment-replybox-single"></div></li><li id="bc_0_83B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c1123512873996910336" class="comment-block"><div id="bc_0_83M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/05715833273393977399">Zipcode technology</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515261144194#c1123512873996910336">January 6, 2018 at 9:52 AM</a></span></div><p id="bc_0_83MC" class="comment-content">I came up with a solution but it does not involve retpoline, you must think of the problem from a physics point of view, security is binary its either secure or its not, let me give an example of 1 and 0<br><br>The processor is handling 1 to 0 for each bit in question weather it is writing or reading comes after the fact.<br><br>My current solution 7th Jan 18<br><br>T = (phase doubler) divided by 1<br><br>With this equation we can take a step forward in processing logic by adding double phase to the 1 and 0 calculation of a processor<br><br>With phase i have added checkphase similar to checksum on a binary level<br><br>But this can be easily added as kernal to all processors<br><br>This give us a new variable = T<br><br>T equals the phase of the 1 or the 0 <br><br>But it does so twice to check and allocate processing by splitting and checking and comparing the digits in a bit twice </p><span id="bc_0_83MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1278991185"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=1123512873996910336">Delete</a></span></span></div><div id="bc_0_83BR" class="comment-replies"></div><div id="bc_0_83B_box" class="comment-replybox-single"></div></li><li id="bc_0_84B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c6192122787125588344" class="comment-block"><div id="bc_0_84M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/01561216421115521655">ImperialDev</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515278267325#c6192122787125588344">January 6, 2018 at 2:37 PM</a></span></div><p id="bc_0_84MC" class="comment-content">Excellent article, very detailed. <br><br>I've also read an article published on LWN on the same topic but that article caused me some confusion. They provide a similar code sample for demonstrating the boundary check exploit which contained the following lines of code.<br><br>    if (offset &lt; array1-&gt;length) {<br>        unsigned char value = array1-&gt;data[offset];<br>       unsigned long index = ((value&amp;1)*0x100)+0x200;<br>       if (index &lt; array2-&gt;length) // length is &lt; 0x300<br>            unsigned char value2 = array2-&gt;data[index];<br>     }<br><br>However what I don't understand about this code is, if the LSB of value evaluates to 1 then index is 0x300, but the comment states the length of array2 is &lt; 0x300 which would mean the if statement wouldn't evaluate to true. Now am I correct in assuming that the inner if statement would also trigger speculative execution and the boundary check bypassed again or was this most likely a mistake by the author?<br> </p><span id="bc_0_84MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-14773401"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=6192122787125588344">Delete</a></span></span></div><div id="bc_0_84BR" class="comment-replies"></div><div id="bc_0_84B_box" class="comment-replybox-single"></div></li><li id="bc_0_85B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c3119090522474521630" class="comment-block"><div id="bc_0_85M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/09176102356738042104">Blogger</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515317316262#c3119090522474521630">January 7, 2018 at 1:28 AM</a></span></div><p id="bc_0_85MC" class="comment-content"> struct array {<br> unsigned long length;<br> unsigned char data[];<br>};<br>struct array *arr1 = ...;<br>unsigned long untrusted_offset_from_caller = ...;<br>if (untrusted_offset_from_caller &lt; arr1-&gt;length) {<br> unsigned char value = arr1-&gt;data[untrusted_offset_from_caller];<br> ...<br>}<br>However, in the following code sample, there's an issue. If arr1-&gt;length, arr2-&gt;data[0x200] and arr2-&gt;data[0x300] are not cached, but all other accessed data is, and the branch conditions are predicted as true, the processor can do the following speculatively before arr1-&gt;length has been loaded and the execution is re-steered:<br><br>    load value = arr1-&gt;data[untrusted_offset_from_caller]<br>    start a load from a data-dependent offset in arr2-&gt;data, loading the corresponding cache line into the L1 cache<br><br><br>struct array {<br> unsigned long length;<br> unsigned char data[];<br>};<br>struct array *arr1 = ...; /* small array */<br>struct array *arr2 = ...; /* array of size 0x400 */<br>/* &gt;0x400 (OUT OF BOUNDS!) */<br>unsigned long untrusted_offset_from_caller = ...;<br>if (untrusted_offset_from_caller &lt; arr1-&gt;length) {<br> unsigned char value = arr1-&gt;data[untrusted_offset_from_caller];<br> unsigned long index2 = ((value&amp;1)*0x100)+0x200;<br> if (index2 &lt; arr2-&gt;length) {<br>   unsigned char value2 = arr2-&gt;data[index2];<br> }<br>}<br><br>In order to compile the code, is it possible to fill the dots ...? In this way we can verify your discovery. </p><span id="bc_0_85MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1264730033"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=3119090522474521630">Delete</a></span></span></div><div id="bc_0_85BR" class="comment-replies"></div><div id="bc_0_85B_box" class="comment-replybox-single"></div></li><li id="bc_0_86B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c5791083419745167196" class="comment-block"><div id="bc_0_86M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/15696036599680035229">SFLin</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515332845414#c5791083419745167196">January 7, 2018 at 5:47 AM</a></span></div><p id="bc_0_86MC" class="comment-content">It should be clearly mention that an specurative load in user mode does not load the corresponding cache line of kernel data into the L1 cache.<br><br>This results in <br>"To be able to actually use this behavior for an attack, an attacker needs to be able to cause the execution of such a vulnerable code pattern in the targeted context with an out-of-bounds index.  For this, the vulnerable code pattern must either be present in existing code, or there must be an interpreter or JIT engine that can be used to generate the vulnerable code pattern."<br>as described.<br><br>I don't understand why the Variant 1 works on "Intel Haswell Xeon CPU, eBPF JIT is off (default state)", which is the most ("the only" for me) important on this report.  It is not proved in this report, if I understand correctly.<br></p><span id="bc_0_86MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-163238614"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=5791083419745167196">Delete</a></span></span></div><div id="bc_0_86BR" class="comment-replies"></div><div id="bc_0_86B_box" class="comment-replybox-single"></div></li><li id="bc_0_89B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c2710975700671160396" class="comment-block"><div id="bc_0_89M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/06351425016912798444">Yuri Kreinin</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515344571413#c2710975700671160396">January 7, 2018 at 9:02 AM</a></span></div><p id="bc_0_89MC" class="comment-content">Great article and great job!!!<br>However, I do not get how these discovered undocumented features are related to "security vulnerability". There are hundreds or thousands of methods for stealing information from hard-drive, screen, communication channels and memory. But all these security issues have one unambiguous source. The evil program was installed and run on your computer without your permission and authorization. Doesn't matter how it harms your system after that. Destroys your disk, copies your files or have the unauthorized access to other process memory or processor's cache. The security vulnerability is the fact that this program could be started on your computer without your permission. If it happens - there are hundreds of methods to steal your information or harm your computer, and these methods are way more simple and reliable than trying to read other process memory.<br>I hope that I miss something and you can help me to figure my mistake out, because 30+ years experience in computer programming and software architecture is challenged by "the storm in the glass of water" caused by the discovery of "security vulnerability" of the chip (???). I wouldn't have any problem if the issue has been classified as "undocumented feature" or bug. It still had to be fixed and you still have done great job and deserves all credits.<br>But it is hard for me to accept the discovered issue under the tag of "security". I hope you may help me to fix a gap in my understanding.</p><span id="bc_0_89MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1395416549"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=2710975700671160396">Delete</a></span></span></div><div id="bc_0_89BR" class="comment-replies"><span id="bc_0_89b+seedtnOD" kind="d"><div id="bc_0_87T" class="comment-thread inline-thread" kind="t" t="0" u="0"><span id="bc_0_87TT" class="thread-toggle thread-expanded" kind="g"><span id="bc_0_87TA" class="thread-arrow"></span><span id="bc_0_87TN" class="thread-count"><span id="bc_0_87TNT" style="display: none;"></span><span id="bc_0_87TNU" style="display: none;"></span><a href="javascript:;" target="_self">Replies</a><div id="bc_0_87TD" class="thread-dropContainer thread-expanded"><span class="thread-drop"></span></div></span></span><ol id="bc_0_87TC" class="thread-chrome thread-expanded"><div><li id="bc_0_87B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c6899524236866531916" class="comment-block"><div id="bc_0_87M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/00621306780575849955">J</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515395531775#c6899524236866531916">January 7, 2018 at 11:12 PM</a></span></div><p id="bc_0_87MC" class="comment-content">Imagine you being a cloud provider, renting VMs. Now one of your customers happily read your hypervisor memory. Is that accepatble to you?</p><span id="bc_0_87MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-254348355"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=6899524236866531916">Delete</a></span></span></div><div id="bc_0_87BR" class="comment-replies"></div><div id="bc_0_87B_box" class="comment-replybox-single"></div></li><li id="bc_0_88B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c7982600671302167723" class="comment-block"><div id="bc_0_88M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/06351425016912798444">Yuri Kreinin</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515444063299#c7982600671302167723">January 8, 2018 at 12:41 PM</a></span></div><p id="bc_0_88MC" class="comment-content">1. It explains how the harmful program can be access on your machine without your permission. Thank you.<br>2. However, your example doesn't apply to the majority of personal computers<br>3. Suppose VM has read access to hypervisor memory. What "useful" information can it steal from there? How does it finds and extracts sensitive information from the huge amount of data?<br>4. It still sounds for me as a problem of OS / software and not hardware.</p><span id="bc_0_88MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-1395416549"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=7982600671302167723">Delete</a></span></span></div><div id="bc_0_88BR" class="comment-replies"></div><div id="bc_0_88B_box" class="comment-replybox-single"></div></li></div><div id="bc_0_87I" class="continue" kind="ci"><a href="javascript:;" target="_self">Reply</a></div></ol><div id="bc_0_87T_box" class="comment-replybox-thread"></div></div></span></div><div id="bc_0_89B_box" class="comment-replybox-single"></div></li><li id="bc_0_90B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/TopHatProductions115_absent.png"></div><div id="c7195026662307698634" class="comment-block"><div id="bc_0_90M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/17338522180858247013">TopHatProductions115</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515367040929#c7195026662307698634">January 7, 2018 at 3:17 PM</a></span></div><p id="bc_0_90MC" class="comment-content">1) Are older AMD (pre-2015) APUs vulnerable to all variations of this exploit?<br>2) Have there been vulnerability tests released for all tree variants (for consumers to check in with)?<br>3) What should I do about my Intel Xeon X5472 workstation?</p><span id="bc_0_90MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1747280572"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=7195026662307698634">Delete</a></span></span></div><div id="bc_0_90BR" class="comment-replies"></div><div id="bc_0_90B_box" class="comment-replybox-single"></div></li><li id="bc_0_91B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c1853016284404002188" class="comment-block"><div id="bc_0_91M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/01405255076932880465">Somsri Varanuyuth</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515377834210#c1853016284404002188">January 7, 2018 at 6:17 PM</a></span></div><p id="bc_0_91MC" class="comment-content">AMD claims that Variant Two- Branch Target Injection and Variant Three- Rogue Data Cache Load has a near zero to zero risk on AMD processors. Microsoft also confirmed Xbox One, in which AMD CPU and GPU is used, has no impacted by Meltdown and Spectre<br><br>https://stevivor.com/news/xbox-one-mitigates-recent-chip-related-security-vulnerabilities/ <br><br>Here only shows Variant one- bounds check bypass with  AMD FX and PRO processor.  What about the newer AMD  Ryzen and   EPYC processor? <br></p><span id="bc_0_91MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-990806103"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=1853016284404002188">Delete</a></span></span></div><div id="bc_0_91BR" class="comment-replies"></div><div id="bc_0_91B_box" class="comment-replybox-single"></div></li><li id="bc_0_92B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/_"></div><div id="c9132678378008452252" class="comment-block"><div id="bc_0_92M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/16158693680439830382">BOMBOVA</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515414454006#c9132678378008452252">January 8, 2018 at 4:27 AM</a></span></div><p id="bc_0_92MC" class="comment-content">good alert Google Team,    important,    imo, this has gotten amplified in the last six months.   i can understand , how a browser session,    captured,   could reveal the private key,     </p><span id="bc_0_92MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-566991074"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=9132678378008452252">Delete</a></span></span></div><div id="bc_0_92BR" class="comment-replies"></div><div id="bc_0_92B_box" class="comment-replybox-single"></div></li><li id="bc_0_93B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c7042177740312844800" class="comment-block"><div id="bc_0_93M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/16124750110629546625">rpr</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515418200071#c7042177740312844800">January 8, 2018 at 5:30 AM</a></span></div><p id="bc_0_93MC" class="comment-content">I hope the guys that discovered this will eventually produce some testing applications so that we can test if our systems are really not vulnerable any more after applying all recommended patches. I mean the tests which really try to exploit the vulnerabilities.<br><br>Moreover, as nobody knows if the vulnerabilities have been exploited in the wild, would it be wise that we change passwords, private keys and other secret parts of our credentials once our systems are patched?</p><span id="bc_0_93MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-825836278"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=7042177740312844800">Delete</a></span></span></div><div id="bc_0_93BR" class="comment-replies"></div><div id="bc_0_93B_box" class="comment-replybox-single"></div></li><li id="bc_0_94B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/myself.jpg"></div><div id="c5241457376972049555" class="comment-block"><div id="bc_0_94M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/04101473047938934148">Sid</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515425445680#c5241457376972049555">January 8, 2018 at 7:30 AM</a></span></div><p id="bc_0_94MC" class="comment-content">from what I understand, both exploits are possible only with hyperthreading on. Is that so? </p><span id="bc_0_94MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1718266561"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=5241457376972049555">Delete</a></span></span></div><div id="bc_0_94BR" class="comment-replies"></div><div id="bc_0_94B_box" class="comment-replybox-single"></div></li><li id="bc_0_95B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c5718461585215012697" class="comment-block"><div id="bc_0_95M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/16726201594909890454">Unknown</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515436801823#c5718461585215012697">January 8, 2018 at 10:40 AM</a></span></div><p id="bc_0_95MC" class="comment-content">ASUS Advisory if you want to add this to links ;)<br>https://www.asus.com/News/V5urzYAT6myCC1o2?_ga=2.82328660.371051983.1515436172-668502183.1503859416</p><span id="bc_0_95MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-893527526"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=5718461585215012697">Delete</a></span></span></div><div id="bc_0_95BR" class="comment-replies"></div><div id="bc_0_95B_box" class="comment-replybox-single"></div></li><li id="bc_0_96B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c429886688456074264" class="comment-block"><div id="bc_0_96M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/06586334509553334314">Unknown</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515476363607#c429886688456074264">January 8, 2018 at 9:39 PM</a></span></div><p id="bc_0_96MC" class="comment-content">On x86, it is possible to shutdown speculation following an indirect jump with the UD2 instruction. This is described in the Intel® 64 and IA-32 Architectures Optimization Reference Manual:<br><br>Assembly/Compiler Coding Rule 14. (M impact, L generality) When indirect branches are present, try to put the most likely target of an indirect branch immediately following the indirect branch. Alternatively, if indirect branches are common but they cannot be predicted by branch prediction hardware, then follow the indirect branch with a UD2 instruction, which will stop the processor from decoding down the fall-through path.<br></p><span id="bc_0_96MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1832084563"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=429886688456074264">Delete</a></span></span></div><div id="bc_0_96BR" class="comment-replies"></div><div id="bc_0_96B_box" class="comment-replybox-single"></div></li><li id="bc_0_98B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/rajat.jpg"></div><div id="c4201222968294253829" class="comment-block"><div id="bc_0_98M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/04613556748100133165">Rajat Insan</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515493209576#c4201222968294253829">January 9, 2018 at 2:20 AM</a></span></div><p id="bc_0_98MC" class="comment-content">Does December 2017 security updates covers protection from these 2 vulnerabilities?</p><span id="bc_0_98MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-631206786"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=4201222968294253829">Delete</a></span></span></div><div id="bc_0_98BR" class="comment-replies"><span id="bc_0_98b+seedtnYD" kind="d"><div id="bc_0_97T" class="comment-thread inline-thread" kind="t" t="0" u="0"><span id="bc_0_97TT" class="thread-toggle thread-expanded" kind="g"><span id="bc_0_97TA" class="thread-arrow"></span><span id="bc_0_97TN" class="thread-count"><span id="bc_0_97TNT" style="display: none;"></span><span id="bc_0_97TNU" style="display: none;"></span><a href="javascript:;" target="_self">Replies</a><div id="bc_0_97TD" class="thread-dropContainer thread-expanded"><span class="thread-drop"></span></div></span></span><ol id="bc_0_97TC" class="thread-chrome thread-expanded"><div><li id="bc_0_97B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c220218180810361156" class="comment-block"><div id="bc_0_97M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/16124750110629546625">rpr</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515504472397#c220218180810361156">January 9, 2018 at 5:27 AM</a></span></div><p id="bc_0_97MC" class="comment-content">Rajat, I suggest reading the following guidelines for Windows Server OS and for clients OS:<br>https://support.microsoft.com/en-us/help/4072698/<br>https://support.microsoft.com/en-hk/help/4073119/<br>I'd say that all the updates recommended on those pages were issued in January 2018.<br><br>The same applies to Linux distributions listed at the end of https://meltdownattack.com</p><span id="bc_0_97MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-825836278"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=220218180810361156">Delete</a></span></span></div><div id="bc_0_97BR" class="comment-replies"></div><div id="bc_0_97B_box" class="comment-replybox-single"></div></li></div><div id="bc_0_97I" class="continue" kind="ci"><a href="javascript:;" target="_self">Reply</a></div></ol><div id="bc_0_97T_box" class="comment-replybox-thread"></div></div></span></div><div id="bc_0_98B_box" class="comment-replybox-single"></div></li><li id="bc_0_99B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c3345607423953893514" class="comment-block"><div id="bc_0_99M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/07206118933952322548">Adam Furtenbach</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515594718978#c3345607423953893514">January 10, 2018 at 6:31 AM</a></span></div><p id="bc_0_99MC" class="comment-content">Assume you are running a virtual machine on a cloud provider, the cloud provider is also hosting other customers on the same physical hardware.<br>Your virtual machine is patched, then another customer decides to run a custom Linux VM with rogue code, hence he can exploit meltdown to read your vm's memory?<br><br>The meltdown fix prevents you from exploiting others, not others from exploiting you, correct?</p><span id="bc_0_99MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1701719785"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=3345607423953893514">Delete</a></span></span></div><div id="bc_0_99BR" class="comment-replies"></div><div id="bc_0_99B_box" class="comment-replybox-single"></div></li><li id="bc_0_104B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c6575043431867188392" class="comment-block"><div id="bc_0_104M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/06351425016912798444">Yuri Kreinin</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515624033731#c6575043431867188392">January 10, 2018 at 2:40 PM</a></span></div><p id="bc_0_104MC" class="comment-content">I have posted a number of comments that question how this "security breach" can steal the sensitive information. Only the first two comments were published, but the rest just disappeared (or were blocked for some reason).<br>I repeat my very simple question - suppose I have read-access to all the memory of all other processes. How can intruder utilize this option in order to discover passwords, usernames etc? Ok, he might be able to find some photos, perhaps. But what about the more sensitive and encrypted information.<br>I suggested a very simple test: suppose, I put the attacker program on my computer - is it able to find the entire text message inside another unknown running process, if I provide some key-words? Could it be done, if I encrypt the message?</p><span id="bc_0_104MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1395416549"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=6575043431867188392">Delete</a></span></span></div><div id="bc_0_104BR" class="comment-replies"><span id="bc_0_104b+seedtncD" kind="d"><div id="bc_0_100T" class="comment-thread inline-thread" kind="t" t="0" u="0"><span id="bc_0_100TT" class="thread-toggle thread-expanded" kind="g"><span id="bc_0_100TA" class="thread-arrow"></span><span id="bc_0_100TN" class="thread-count"><span id="bc_0_100TNT" style="display: none;"></span><span id="bc_0_100TNU" style="display: none;"></span><a href="javascript:;" target="_self">Replies</a><div id="bc_0_100TD" class="thread-dropContainer thread-expanded"><span class="thread-drop"></span></div></span></span><ol id="bc_0_100TC" class="thread-chrome thread-expanded"><div><li id="bc_0_100B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c2766645272235480814" class="comment-block"><div id="bc_0_100M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/08977098164422796580">adx</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515633926918#c2766645272235480814">January 10, 2018 at 5:25 PM</a></span></div><p id="bc_0_100MC" class="comment-content">Your suggested test is exactly what it can do. Imagine opening up a debugger on the computer capable of reading anything in RAM. Passwords, usernames, what is open, the content of a document being worked on, the data being shuttled back and forth with a client of a server, keys in use, the lot. The bigger the system, the more there is to look through. Photos, ironically probably not (if they are on disk and not in use). Encrypted information no not without a key or password, but usually the point of something being in memory is that it is being worked on, in other words it is decrypted. Not always, but the security model relies on protected memory being unreadable, encryption is usually only used on files on the disk in case they are accidentally disclosed. That's why this "flaw" is so bad - it can read information that is not expected to be encrypted. It's hard to think of a worse-case scenario. Fortunately the patches seem to be practical and the players in the discovery have managed it well and were probably able to prevent mass exploitation at a scale we have never seen before.</p><span id="bc_0_100MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-1014491555"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=2766645272235480814">Delete</a></span></span></div><div id="bc_0_100BR" class="comment-replies"></div><div id="bc_0_100B_box" class="comment-replybox-single"></div></li><li id="bc_0_101B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c1403705798707490788" class="comment-block"><div id="bc_0_101M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/06351425016912798444">Yuri Kreinin</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515729249394#c1403705798707490788">January 11, 2018 at 7:54 PM</a></span></div><p id="bc_0_101MC" class="comment-content">Could you explain, how would you be able to discover sensitive information (passwords, usernames etc) inside the memory dump of tens of gigabytes without knowing the exact layout?<br>And what does this memory dump worth when it is created with a speed of 2K byte per second?<br>I suggested a very simple test, which is much easier than stealing of sensitive information and I suggested this test because I doubt that it could be done.<br>You remind the debugger - that's a very good point. You can write a debugger-like application, which attaches to the process of interest and retrieves the information, if it knows how to do it with this particular process. No need to use "cache-lines" and other tricks. The most computers are vulnerable to this. Isn't it? </p><span id="bc_0_101MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-1395416549"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=1403705798707490788">Delete</a></span></span></div><div id="bc_0_101BR" class="comment-replies"></div><div id="bc_0_101B_box" class="comment-replybox-single"></div></li><li id="bc_0_102B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/photo(15).jpg"></div><div id="c1355434673930403380" class="comment-block"><div id="bc_0_102M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/01993185823702529356">Yet Again</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515871077942#c1355434673930403380">January 13, 2018 at 11:17 AM</a></span></div><p id="bc_0_102MC" class="comment-content">Yuri, the fact that sensitive data is hidden in a lot of noise (tens of GB of data dump) is a classic machine learning problem. If a team is determined to use the flaw, (1) experts in computer security would access/grab the data dump, then (2) experts in data-mining/ machine learning would then separate the data from the "noise".<br>The best analogy that comes to mind: suppose we find out that everyone's home has a flaw, where the key to their house is buried somewhere in the garden. Since the flaw affects almost anyone, the probability of any one person getting robbed is extremely low, but if your house is known to contain tons of gold, then it's worth mining your entire garden with metal detectors just to find the key. And entire groups might start deploying an army of miners with metal detectors just to gather as many keys as possible "just in case" (ex: Gov agencies, misc nefarious groups).<br>Keep in mind that the data's not encrypted, so it's just a matter of finding recurring patterns. One extremely simplified example: parse the data-dump to get all websites, and look for recurring bank websites, then get the data you input immediately afterwards (yes, I'm over-simplifying a LOT but it's just probabilistic algorithms crunching a lot of data) .... eventually, one'll obtain your online banking password.  Same for paypal and what not. <br>PS: my field isn't computer security, but rather data mining so to me it's the "easy part" of the problem, though I'd need an accomplice to get the data-dump. </p><span id="bc_0_102MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-1490421540"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=1355434673930403380">Delete</a></span></span></div><div id="bc_0_102BR" class="comment-replies"></div><div id="bc_0_102B_box" class="comment-replybox-single"></div></li><li id="bc_0_103B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c6741595981781493101" class="comment-block"><div id="bc_0_103M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/08977098164422796580">adx</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515921601742#c6741595981781493101">January 14, 2018 at 1:20 AM</a></span></div><p id="bc_0_103MC" class="comment-content">What you say about the debugger does apply if you're running everything as Administrator or root (or on a C64). But in a secured computer, no ordinary user can attach a debugger to a privileged process, that is locked out and is the whole point of brick-wall like memory protection. It doesn't rely on security through obscurity or hoping things are hard to find, but hardware designed to make it absolutely (completely and utterly) impossible for a normal level user to get past. Computers have had this memory protection hardware for decades.<br><br>I'm not saying extracting the root password would be trivial, but first off in a server with 10s of GB of RAM you can pretty much guarantee it is all being used for something. Reading any of it is almost certain to disclose sensitive data. It might be some random php in a file cache, but it is still data that someone trusts is behind the security wall. The Meltdown dumps were produced at 500KB/s, which is plenty fast enough to find something juicy or dump all RAM in less than a day. I mentioned the debugger because it's interactive - you're sitting there perusing stuff interactively, watching how it changes when you do something, like say attempting to log in over SSH. Even 2KB/s would be enough for that. The mechanics of the attack also means you get a massive hardware assist and can effectively search a lot faster for certain things. If you're logged into some random web host they tell you exactly what kernel is running with what patches, and one of the papers on this attack discusses what structures might be vulnerable even with mitigations like address space randomisation. Without memory protection, there is basically no security at all against locally running code.</p><span id="bc_0_103MN" class="comment-actions secondary-text" kind="m"><span class="item-control blog-admin pid-1014491555"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=6741595981781493101">Delete</a></span></span></div><div id="bc_0_103BR" class="comment-replies"></div><div id="bc_0_103B_box" class="comment-replybox-single"></div></li></div><div id="bc_0_100I" class="continue" kind="ci"><a href="javascript:;" target="_self">Reply</a></div></ol><div id="bc_0_100T_box" class="comment-replybox-thread"></div></div></span></div><div id="bc_0_104B_box" class="comment-replybox-single"></div></li><li id="bc_0_105B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c1897331547409398219" class="comment-block"><div id="bc_0_105M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/05889212960761838838">Unknown</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515709054545#c1897331547409398219">January 11, 2018 at 2:17 PM</a></span></div><p id="bc_0_105MC" class="comment-content">Can someone at Project Zero explain why the FreeBSD Security Team was notified so much later than their counterparts supporting other systems? I am honestly very disappointed in Google's delay in this regard.</p><span id="bc_0_105MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-389076539"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=1897331547409398219">Delete</a></span></span></div><div id="bc_0_105BR" class="comment-replies"></div><div id="bc_0_105B_box" class="comment-replybox-single"></div></li><li id="bc_0_106B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c487498929959072361" class="comment-block"><div id="bc_0_106M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/16775745880820642277">Saint Crusty</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1515800381067#c487498929959072361">January 12, 2018 at 3:39 PM</a></span></div><p id="bc_0_106MC" class="comment-content">You know what would be great, if all google pages showed a date published and a data updated. Some for almost any of the vendor pages. Please, it is 2018 we use dates and time. Thanks.</p><span id="bc_0_106MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1215135636"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=487498929959072361">Delete</a></span></span></div><div id="bc_0_106BR" class="comment-replies"></div><div id="bc_0_106B_box" class="comment-replybox-single"></div></li><li id="bc_0_107B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/photo(20).jpg"></div><div id="c6907526937829018537" class="comment-block"><div id="bc_0_107M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/07557330351988823220">吴光韬</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1516242336738#c6907526937829018537">January 17, 2018 at 6:25 PM</a></span></div><p id="bc_0_107MC" class="comment-content">as a new one, just mark it</p><span id="bc_0_107MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1929181896"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=6907526937829018537">Delete</a></span></span></div><div id="bc_0_107BR" class="comment-replies"></div><div id="bc_0_107B_box" class="comment-replybox-single"></div></li><li id="bc_0_108B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c1687940820028404905" class="comment-block"><div id="bc_0_108M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/00038765374445105388">Unknown</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1516319039852#c1687940820028404905">January 18, 2018 at 3:43 PM</a></span></div><p id="bc_0_108MC" class="comment-content">If I use a fingerprint recognition system, can I prevent hacking? Would not it be possible to hack through the program by changing all passwords to fingerprint? Instead, it is based on the assumption that the fingerprint recognition system is based on external USB hardware.</p><span id="bc_0_108MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1517526033"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=1687940820028404905">Delete</a></span></span></div><div id="bc_0_108BR" class="comment-replies"></div><div id="bc_0_108B_box" class="comment-replybox-single"></div></li><li id="bc_0_109B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c3656594530100660739" class="comment-block"><div id="bc_0_109M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/00038765374445105388">원동주</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1516319173439#c3656594530100660739">January 18, 2018 at 3:46 PM</a></span></div><p id="bc_0_109MC" class="comment-content">If I use a fingerprint recognition system, can I prevent hacking? Would not it be possible to hack through the program by changing all passwords to fingerprint? Instead, it is based on the assumption that the fingerprint recognition system is based on external USB hardware.</p><span id="bc_0_109MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1517526033"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=3656594530100660739">Delete</a></span></span></div><div id="bc_0_109BR" class="comment-replies"></div><div id="bc_0_109B_box" class="comment-replybox-single"></div></li><li id="bc_0_110B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/photo(21).jpg"></div><div id="c6807439105513856891" class="comment-block"><div id="bc_0_110M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/15749737049488289436">Rick Coe</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1516331406700#c6807439105513856891">January 18, 2018 at 7:10 PM</a></span></div><p id="bc_0_110MC" class="comment-content">So, what are those of us that have NO IDEA what the hell you are talking about, supposed to do?  Seriously!!! We are all not computer or mis specialists.  I deleted the "AdBot" extension and ran a Mbytes scan.  Do I have to do anything else?</p><span id="bc_0_110MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1855132382"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=6807439105513856891">Delete</a></span></span></div><div id="bc_0_110BR" class="comment-replies"></div><div id="bc_0_110B_box" class="comment-replybox-single"></div></li><li id="bc_0_111B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/photo(22).jpg"></div><div id="c337690053541848846" class="comment-block"><div id="bc_0_111M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/18132262762975449123">Jimin Cai</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1516331677764#c337690053541848846">January 18, 2018 at 7:14 PM</a></span></div><p id="bc_0_111MC" class="comment-content">Great work and great article.</p><span id="bc_0_111MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1655234023"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=337690053541848846">Delete</a></span></span></div><div id="bc_0_111BR" class="comment-replies"></div><div id="bc_0_111B_box" class="comment-replybox-single"></div></li><li id="bc_0_112B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/photo(21).jpg"></div><div id="c4840401713642396212" class="comment-block"><div id="bc_0_112M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/15749737049488289436">Rick Coe</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1516331766187#c4840401713642396212">January 18, 2018 at 7:16 PM</a></span></div><p id="bc_0_112MC" class="comment-content">chrome://extensions Ok, let's try this again.  Since I have no idea what the heck you are all talking about; what am I supposed to do now.  I mean really-not all of us are computer or MIS geniuses. I went in and deleted the "AdBot" extension. It actually was not marked as enabled, but I dumped it anyway.  Then I ran Mbytes &amp; Windows Defender scans.  Is there anything else I have to do.  Also I did not get any notification from Google about problems!!!!!!  This came off a Mbyte post dated 1-7-18.</p><span id="bc_0_112MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1855132382"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=4840401713642396212">Delete</a></span></span></div><div id="bc_0_112BR" class="comment-replies"></div><div id="bc_0_112B_box" class="comment-replybox-single"></div></li><li id="bc_0_113B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c3251403423436089673" class="comment-block"><div id="bc_0_113M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/11357847549633100438">zorinmiki</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1516497153571#c3251403423436089673">January 20, 2018 at 5:12 PM</a></span></div><p id="bc_0_113MC" class="comment-content">When stating that "eBPF's data arrays are less efficient than its function pointer arrays", is this in general, or specific to the pertaining attack vector?</p><span id="bc_0_113MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-376038802"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=3251403423436089673">Delete</a></span></span></div><div id="bc_0_113BR" class="comment-replies"></div><div id="bc_0_113B_box" class="comment-replybox-single"></div></li><li id="bc_0_114B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c7894288835369785388" class="comment-block"><div id="bc_0_114M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/16775745880820642277">Saint Crusty</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1516572969125#c7894288835369785388">January 21, 2018 at 2:16 PM</a></span></div><p id="bc_0_114MC" class="comment-content">This is one interesting threat, knowledgeable people may want to review. To my untrained mind this appears to be eerilie similar to what spectre and meltdown contain as a PoC<br><br>https://software.intel.com/en-us/forums/intel-moderncode-for-parallel-architectures/topic/305992</p><span id="bc_0_114MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-1215135636"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=7894288835369785388">Delete</a></span></span></div><div id="bc_0_114BR" class="comment-replies"></div><div id="bc_0_114B_box" class="comment-replybox-single"></div></li><li id="bc_0_115B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c4392830750172580212" class="comment-block"><div id="bc_0_115M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/17342990294244659957">efortin</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1516660370586#c4392830750172580212">January 22, 2018 at 2:32 PM</a></span></div><p id="bc_0_115MC" class="comment-content">Quick question. I've read about Meltdown and Specter. And since they both kind of use cache side effects with access to previlieged memory, would a solution be for the processor to invalidate any cache line of data that was speculatively loaded but ended up not needed?</p><span id="bc_0_115MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-550257729"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=4392830750172580212">Delete</a></span></span></div><div id="bc_0_115BR" class="comment-replies"></div><div id="bc_0_115B_box" class="comment-replybox-single"></div></li><li id="bc_0_116B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c3398237596414186699" class="comment-block"><div id="bc_0_116M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/02278656169794520248">John</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1516872763911#c3398237596414186699">January 25, 2018 at 1:32 AM</a></span></div><p id="bc_0_116MC" class="comment-content">May I ask how to dump branch history buffer state?</p><span id="bc_0_116MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-173166326"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=3398237596414186699">Delete</a></span></span></div><div id="bc_0_116BR" class="comment-replies"></div><div id="bc_0_116B_box" class="comment-replybox-single"></div></li><li id="bc_0_117B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c2643378959495191805" class="comment-block"><div id="bc_0_117M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/01117938740608925196">David</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1517668353726#c2643378959495191805">February 3, 2018 at 6:32 AM</a></span></div><p id="bc_0_117MC" class="comment-content">Hopefully Intel is working on hardware solution of this flaw. Obvious solution is adding fully isolated device that performs scheduled encryption for all sensitive information, (that does not used for computation anyway), then decryption is done only when request is longer then access time of meltdown..   Such solution will help not only for Meltdown, but also for any attempt to get password without touching keyboard.  </p><span id="bc_0_117MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-215513349"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=2643378959495191805">Delete</a></span></span></div><div id="bc_0_117BR" class="comment-replies"></div><div id="bc_0_117B_box" class="comment-replybox-single"></div></li><li id="bc_0_118B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/zFdxGE77vvD2w5xHy6jkVuElKv-U9_9qLkRYK8OnbDeJPtjSZ82UPq5w6hJ-SA=s35"></div><div id="c2932325015026238406" class="comment-block"><div id="bc_0_118M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/09435526251866934641">Hestia</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1517914273856#c2932325015026238406">February 6, 2018 at 2:51 AM</a></span></div><p id="bc_0_118MC" class="comment-content">Still waiting for Intel microcode...</p><span id="bc_0_118MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-271376085"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=2932325015026238406">Delete</a></span></span></div><div id="bc_0_118BR" class="comment-replies"></div><div id="bc_0_118B_box" class="comment-replybox-single"></div></li><li id="bc_0_119B" class="comment" kind="b"><div class="avatar-image-container"><img src="./Project Zero_ Reading privileged memory with a side-channel_files/photo(23).jpg"></div><div id="c1654288901347045133" class="comment-block"><div id="bc_0_119M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/11850372820326490272">jason cheng</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html?showComment=1518430107473#c1654288901347045133">February 12, 2018 at 2:08 AM</a></span></div><p id="bc_0_119MC" class="comment-content">Hi, in session Glossary, should the "A processor can execute past a branch" be "A processor can execute a past branch" ? </p><span id="bc_0_119MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Reply</a><span class="item-control blog-admin pid-2112514500"><a o="d" target="_self" href="https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&amp;postID=1654288901347045133">Delete</a></span></span></div><div id="bc_0_119BR" class="comment-replies"></div><div id="bc_0_119B_box" class="comment-replybox-single"></div></li></ol><div id="bc_0_120I" class="continue" kind="ci" style="display: none;"><a href="javascript:;" target="_self">Add comment</a></div><div id="bc_0_120T_box" class="comment-replybox-thread"><iframe allowtransparency="true" class="blogger-iframe-colorize blogger-comment-from-post" frameborder="0" height="192px" id="comment-editor" name="comment-editor" src="./Project Zero_ Reading privileged memory with a side-channel_files/comment-iframe.html" width="100%" style="display: block;" data-resized="true"></iframe></div><div id="bc_0_120L" class="loadmore loaded" kind="rb"><a href="javascript:;" target="_self">Load more...</a></div></div></div></div></div>
</div>
<p class="comment-footer">
</p><div class="comment-form">
<a name="comment-form"></a>
<p>
</p>
<a href="https://www.blogger.com/comment-iframe.g?blogID=4838136820032157985&amp;postID=6227737444967092885&amp;blogspotRpcToken=67887" id="comment-editor-src"></a>

<script src="./Project Zero_ Reading privileged memory with a side-channel_files/2244480862-comment_from_post_iframe.js" type="text/javascript"></script>
<script type="text/javascript">
      BLOG_CMT_createIframe('https://www.blogger.com/rpc_relay.html');
    </script>
</div>
<p></p>
<div id="backlinks-container">
<div id="Blog1_backlinks-container">
</div>
</div>
</div>
</div>

        </div></div>
      
</div>
<div class="blog-pager" id="blog-pager">
<span id="blog-pager-older-link">
<a class="blog-pager-older-link" href="https://googleprojectzero.blogspot.ca/2017/12/apacolypse-now-exploiting-windows-10-in_18.html" id="Blog1_blog-pager-older-link" title="Older Post">Older Post</a>
</span>
<a class="home-link" href="https://googleprojectzero.blogspot.ca/">Home</a>
</div>
<div class="clear"></div>
<div class="post-feeds">
<div class="feed-links">
Subscribe to:
<a class="feed-link" href="https://googleprojectzero.blogspot.com/feeds/6227737444967092885/comments/default" target="_blank" type="application/atom+xml">Post Comments (Atom)</a>
</div>
</div>
<script type="text/javascript">
    window.___gcfg = { 'lang': 'en' };
  </script>
</div></div>
</div>
</div>
<div class="column-left-outer">
<div class="column-left-inner">
<aside>
</aside>
</div>
</div>
<div class="column-right-outer">
<div class="column-right-inner">
<aside>
<div class="sidebar section" id="sidebar-right-1"><div class="widget BlogSearch" data-version="1" id="BlogSearch1">
<h2 class="title">Search This Blog</h2>
<div class="widget-content">
<div id="BlogSearch1_form">
<form action="https://googleprojectzero.blogspot.ca/search" class="gsc-search-box" target="_top">
<table cellpadding="0" cellspacing="0" class="gsc-search-box">
<tbody>
<tr>
<td class="gsc-input">
<input autocomplete="off" class="gsc-input" name="q" size="10" title="search" type="text" value="">
</td>
<td class="gsc-search-button">
<input class="gsc-search-button" title="search" type="submit" value="Search">
</td>
</tr>
</tbody>
</table>
</form>
</div>
</div>
<div class="clear"></div>
<span class="widget-item-control">
<span class="item-control blog-admin">
<a class="quickedit" href="https://www.blogger.com/rearrange?blogID=4838136820032157985&amp;widgetType=BlogSearch&amp;widgetId=BlogSearch1&amp;action=editWidget&amp;sectionId=sidebar-right-1" onclick="return _WidgetManager._PopupConfig(document.getElementById(&quot;BlogSearch1&quot;));" target="configBlogSearch1" title="Edit">
<img alt="" height="18" src="./Project Zero_ Reading privileged memory with a side-channel_files/icon18_wrench_allbkg.png" width="18">
</a>
</span>
</span>
<div class="clear"></div>
</div>
<div class="widget BlogArchive" data-version="1" id="BlogArchive1">
<h2>Archives</h2>
<div class="widget-content">
<div id="ArchiveList">
<div id="BlogArchive1_ArchiveList">
<ul class="hierarchy">
<li class="archivedate expanded">
<a class="toggle" href="javascript:void(0)">
<span class="zippy toggle-open">

        ▼&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2018/">
2018
</a>
<span class="post-count" dir="ltr">(1)</span>
<ul class="hierarchy">
<li class="archivedate expanded">
<a class="toggle" href="javascript:void(0)">
<span class="zippy toggle-open">

        ▼&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2018/01/">
January
</a>
<span class="post-count" dir="ltr">(1)</span>
<ul class="posts">
<li><a href="https://googleprojectzero.blogspot.ca/2018/01/reading-privileged-memory-with-side.html">Reading privileged memory with a side-channel</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2017/">
2017
</a>
<span class="post-count" dir="ltr">(19)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2017/12/">
December
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2017/10/">
October
</a>
<span class="post-count" dir="ltr">(3)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2017/09/">
September
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2017/08/">
August
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2017/07/">
July
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2017/05/">
May
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2017/04/">
April
</a>
<span class="post-count" dir="ltr">(6)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2017/03/">
March
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2017/02/">
February
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2016/">
2016
</a>
<span class="post-count" dir="ltr">(17)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2016/12/">
December
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2016/11/">
November
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2016/10/">
October
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2016/09/">
September
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2016/08/">
August
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2016/07/">
July
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2016/06/">
June
</a>
<span class="post-count" dir="ltr">(3)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2016/03/">
March
</a>
<span class="post-count" dir="ltr">(3)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2016/02/">
February
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2016/01/">
January
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2015/">
2015
</a>
<span class="post-count" dir="ltr">(33)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2015/12/">
December
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2015/11/">
November
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2015/10/">
October
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2015/09/">
September
</a>
<span class="post-count" dir="ltr">(4)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2015/08/">
August
</a>
<span class="post-count" dir="ltr">(6)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2015/07/">
July
</a>
<span class="post-count" dir="ltr">(5)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2015/06/">
June
</a>
<span class="post-count" dir="ltr">(4)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2015/05/">
May
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2015/04/">
April
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2015/03/">
March
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2015/02/">
February
</a>
<span class="post-count" dir="ltr">(3)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2015/01/">
January
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2014/">
2014
</a>
<span class="post-count" dir="ltr">(11)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2014/12/">
December
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2014/11/">
November
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2014/10/">
October
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2014/09/">
September
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2014/08/">
August
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://googleprojectzero.blogspot.ca/2014/07/">
July
</a>
<span class="post-count" dir="ltr">(3)</span>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="clear"></div>
<span class="widget-item-control">
<span class="item-control blog-admin">
<a class="quickedit" href="https://www.blogger.com/rearrange?blogID=4838136820032157985&amp;widgetType=BlogArchive&amp;widgetId=BlogArchive1&amp;action=editWidget&amp;sectionId=sidebar-right-1" onclick="return _WidgetManager._PopupConfig(document.getElementById(&quot;BlogArchive1&quot;));" target="configBlogArchive1" title="Edit">
<img alt="" height="18" src="./Project Zero_ Reading privileged memory with a side-channel_files/icon18_wrench_allbkg.png" width="18">
</a>
</span>
</span>
<div class="clear"></div>
</div>
</div></div>
<table border="0" cellpadding="0" cellspacing="0" class="section-columns columns-2">
<tbody>
<tr>
<td class="first columns-cell">
<div class="sidebar no-items section" id="sidebar-right-2-1"></div>
</td>
<td class="columns-cell">
<div class="sidebar no-items section" id="sidebar-right-2-2"></div>
</td>
</tr>
</tbody>
</table>
<div class="sidebar no-items section" id="sidebar-right-3"></div>
</aside>
</div>
</div>
</div>
<div style="clear: both"></div>
<!-- columns -->
</div>
<!-- main -->
</div>
</div>
<div class="main-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<footer>
<div class="footer-outer">
<div class="footer-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left footer-fauxborder-left">
<div class="fauxborder-right footer-fauxborder-right"></div>
<div class="region-inner footer-inner">
<div class="foot no-items section" id="footer-1"></div>
<table border="0" cellpadding="0" cellspacing="0" class="section-columns columns-2">
<tbody>
<tr>
<td class="first columns-cell">
<div class="foot no-items section" id="footer-2-1"></div>
</td>
<td class="columns-cell">
<div class="foot no-items section" id="footer-2-2"></div>
</td>
</tr>
</tbody>
</table>
<!-- outside of the include in order to lock Attribution widget -->
<div class="foot section" id="footer-3" name="Footer"><div class="widget Attribution" data-version="1" id="Attribution1">
<div class="widget-content" style="text-align: center;">
Simple theme. Powered by <a href="https://www.blogger.com/" target="_blank">Blogger</a>.
</div>
<div class="clear"></div>
<span class="widget-item-control">
<span class="item-control blog-admin">
<a class="quickedit" href="https://www.blogger.com/rearrange?blogID=4838136820032157985&amp;widgetType=Attribution&amp;widgetId=Attribution1&amp;action=editWidget&amp;sectionId=footer-3" onclick="return _WidgetManager._PopupConfig(document.getElementById(&quot;Attribution1&quot;));" target="configAttribution1" title="Edit">
<img alt="" height="18" src="./Project Zero_ Reading privileged memory with a side-channel_files/icon18_wrench_allbkg.png" width="18">
</a>
</span>
</span>
<div class="clear"></div>
</div></div>
</div>
</div>
<div class="footer-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</footer>
<!-- content -->
</div>
</div>
<div class="content-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</div>
<script type="text/javascript">
    window.setTimeout(function() {
        document.body.className = document.body.className.replace('loading', '');
      }, 10);
  </script>
<script src="./Project Zero_ Reading privileged memory with a side-channel_files/plusone.js" type="text/javascript" gapi_processed="true"></script>

<script type="text/javascript" src="./Project Zero_ Reading privileged memory with a side-channel_files/3953819307-widgets.js"></script>
<script type="text/javascript">
window['__wavt'] = 'AOuZoY4xoN-u1gJYsRLJLuWpmuAR1Jj1_Q:1518467937843';_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d4838136820032157985','//googleprojectzero.blogspot.ca/2018/01/reading-privileged-memory-with-side.html','4838136820032157985');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '4838136820032157985', 'title': 'Project Zero', 'url': 'https://googleprojectzero.blogspot.ca/2018/01/reading-privileged-memory-with-side.html', 'canonicalUrl': 'https://googleprojectzero.blogspot.com/2018/01/reading-privileged-memory-with-side.html', 'homepageUrl': 'https://googleprojectzero.blogspot.ca/', 'searchUrl': 'https://googleprojectzero.blogspot.ca/search', 'canonicalHomepageUrl': 'https://googleprojectzero.blogspot.com/', 'blogspotFaviconUrl': 'https://googleprojectzero.blogspot.ca/favicon.ico', 'bloggerUrl': 'https://www.blogger.com', 'hasCustomDomain': false, 'httpsEnabled': true, 'enabledCommentProfileImages': true, 'gPlusViewType': 'FILTERED_POSTMOD', 'adultContent': false, 'analyticsAccountNumber': '', 'encoding': 'UTF-8', 'locale': 'en', 'localeUnderscoreDelimited': 'en', 'languageDirection': 'ltr', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'feedLinks': '\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Project Zero - Atom\x22 href\x3d\x22https://googleprojectzero.blogspot.com/feeds/posts/default\x22 /\x3e\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/rss+xml\x22 title\x3d\x22Project Zero - RSS\x22 href\x3d\x22https://googleprojectzero.blogspot.com/feeds/posts/default?alt\x3drss\x22 /\x3e\n\x3clink rel\x3d\x22service.post\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Project Zero - Atom\x22 href\x3d\x22https://www.blogger.com/feeds/4838136820032157985/posts/default\x22 /\x3e\n\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Project Zero - Atom\x22 href\x3d\x22https://googleprojectzero.blogspot.com/feeds/6227737444967092885/comments/default\x22 /\x3e\n', 'meTag': '', 'openIdOpTag': '', 'adsenseHostId': 'ca-host-pub-1556223355139109', 'adsenseHasAds': false, 'ieCssRetrofitLinks': '\x3c!--[if IE]\x3e\x3cscript type\x3d\x22text/javascript\x22 src\x3d\x22https://www.blogger.com/static/v1/jsbin/3061962209-ieretrofit.js\x22\x3e\x3c/script\x3e\n\x3c![endif]--\x3e', 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/896e81c6c7aa8c0d', 'plusOneApiSrc': 'https://apis.google.com/js/plusone.js', 'sharing': {'platforms': [{'name': 'Get link', 'key': 'link', 'shareMessage': 'Get link', 'target': ''}, {'name': 'Facebook', 'key': 'facebook', 'shareMessage': 'Share to Facebook', 'target': 'facebook'}, {'name': 'BlogThis!', 'key': 'blogThis', 'shareMessage': 'BlogThis!', 'target': 'blog'}, {'name': 'Twitter', 'key': 'twitter', 'shareMessage': 'Share to Twitter', 'target': 'twitter'}, {'name': 'Pinterest', 'key': 'pinterest', 'shareMessage': 'Share to Pinterest', 'target': 'pinterest'}, {'name': 'Google+', 'key': 'googlePlus', 'shareMessage': 'Share to Google+', 'target': 'googleplus'}, {'name': 'Email', 'key': 'email', 'shareMessage': 'Email', 'target': 'email'}], 'googlePlusShareButtonWidth': 300, 'googlePlusBootstrap': '\x3cscript type\x3d\x22text/javascript\x22\x3ewindow.___gcfg \x3d {\x27lang\x27: \x27en\x27};\x3c/script\x3e'}, 'hasCustomJumpLinkMessage': false, 'jumpLinkMessage': 'Read more', 'pageType': 'item', 'postId': '6227737444967092885', 'postImageThumbnailUrl': 'https://3.bp.blogspot.com/-64YRnkgMujY/Wk064WtrSRI/AAAAAAAACPg/O4ZxlUiWerACL61P490xrVMWSmHTwQflQCEwYBhgL/s72-c/image3.png', 'postImageUrl': 'https://3.bp.blogspot.com/-64YRnkgMujY/Wk064WtrSRI/AAAAAAAACPg/O4ZxlUiWerACL61P490xrVMWSmHTwQflQCEwYBhgL/s640/image3.png', 'pageName': 'Reading privileged memory with a side-channel', 'pageTitle': 'Project Zero: Reading privileged memory with a side-channel'}}, {'name': 'features', 'data': {'lazy_images': 'false', 'unsupported_browser_message': 'false', 'sharing_get_link_dialog': 'true', 'sharing_native': 'false'}}, {'name': 'messages', 'data': {'edit': 'Edit', 'linkCopiedToClipboard': 'Link copied to clipboard!', 'ok': 'Ok', 'postLink': 'Post Link'}}, {'name': 'template', 'data': {'name': 'Simple', 'localizedName': 'Simple', 'isResponsive': false, 'isAlternateRendering': false, 'isCustom': false, 'variant': 'simplysimple', 'variantId': 'simplysimple'}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '?view\x3dclassic'}, 'flipcard': {'name': 'flipcard', 'url': '?view\x3dflipcard'}, 'magazine': {'name': 'magazine', 'url': '?view\x3dmagazine'}, 'mosaic': {'name': 'mosaic', 'url': '?view\x3dmosaic'}, 'sidebar': {'name': 'sidebar', 'url': '?view\x3dsidebar'}, 'snapshot': {'name': 'snapshot', 'url': '?view\x3dsnapshot'}, 'timeslide': {'name': 'timeslide', 'url': '?view\x3dtimeslide'}, 'isMobile': false, 'title': 'Reading privileged memory with a side-channel', 'description': ' Posted by Jann Horn, Project Zero     We have discovered that CPU data cache timing can be abused to efficiently leak information out of mi...', 'featuredImage': 'https://3.bp.blogspot.com/-64YRnkgMujY/Wk064WtrSRI/AAAAAAAACPg/O4ZxlUiWerACL61P490xrVMWSmHTwQflQCEwYBhgL/s640/image3.png', 'url': 'https://googleprojectzero.blogspot.ca/2018/01/reading-privileged-memory-with-side.html', 'type': 'item', 'isSingleItem': true, 'isMultipleItems': false, 'isError': false, 'isPage': false, 'isPost': true, 'isHomepage': false, 'isArchive': false, 'isLabelSearch': false, 'postId': 6227737444967092885}}]);
_WidgetManager._RegisterWidget('_NavbarView', new _WidgetInfo('Navbar1', 'navbar', null, document.getElementById('Navbar1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', null, document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', null, document.getElementById('Blog1'), {'cmtInteractionsEnabled': false, 'useNgc': false, 'lightboxEnabled': true, 'lightboxModuleUrl': 'https://www.blogger.com/static/v1/jsbin/2190162212-lbx.js', 'lightboxCssUrl': 'https://www.blogger.com/static/v1/v-css/368954415-lightbox_bundle.css'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogSearchView', new _WidgetInfo('BlogSearch1', 'sidebar-right-1', null, document.getElementById('BlogSearch1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogArchiveView', new _WidgetInfo('BlogArchive1', 'sidebar-right-1', null, document.getElementById('BlogArchive1'), {'languageDirection': 'ltr', 'loadingMessage': 'Loading\x26hellip;'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_AttributionView', new _WidgetInfo('Attribution1', 'footer-3', null, document.getElementById('Attribution1'), {}, 'displayModeFull'));
</script>

<iframe name="oauth2relay810908149" id="oauth2relay810908149" src="./Project Zero_ Reading privileged memory with a side-channel_files/postmessageRelay.html" tabindex="-1" aria-hidden="true" style="width: 1px; height: 1px; position: absolute; top: -100px;"></iframe><link type="text/css" rel="stylesheet" href="./Project Zero_ Reading privileged memory with a side-channel_files/368954415-lightbox_bundle.css"><script type="text/javascript" src="./Project Zero_ Reading privileged memory with a side-channel_files/2190162212-lbx.js"></script></body></html>